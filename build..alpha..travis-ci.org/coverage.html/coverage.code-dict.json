{"/home/travis/build/npmtest/node-npmtest-officegen-2/test.js":"/* istanbul instrument in package npmtest_officegen_2 */\n/*jslint\n    bitwise: true,\n    browser: true,\n    maxerr: 8,\n    maxlen: 96,\n    node: true,\n    nomen: true,\n    regexp: true,\n    stupid: true\n*/\n(function () {\n    'use strict';\n    var local;\n\n\n\n    // run shared js-env code - init-before\n    (function () {\n        // init local\n        local = {};\n        // init modeJs\n        local.modeJs = (function () {\n            try {\n                return typeof navigator.userAgent === 'string' &&\n                    typeof document.querySelector('body') === 'object' &&\n                    typeof XMLHttpRequest.prototype.open === 'function' &&\n                    'browser';\n            } catch (errorCaughtBrowser) {\n                return module.exports &&\n                    typeof process.versions.node === 'string' &&\n                    typeof require('http').createServer === 'function' &&\n                    'node';\n            }\n        }());\n        // init global\n        local.global = local.modeJs === 'browser'\n            ? window\n            : global;\n        switch (local.modeJs) {\n        // re-init local from window.local\n        case 'browser':\n            local = local.global.utility2.objectSetDefault(\n                local.global.utility2_rollup || local.global.local,\n                local.global.utility2\n            );\n            break;\n        // re-init local from example.js\n        case 'node':\n            local = (local.global.utility2_rollup || require('utility2'))\n                .requireReadme();\n            break;\n        }\n        // export local\n        local.global.local = local;\n    }());\n\n\n\n    // run shared js-env code - function\n    (function () {\n        return;\n    }());\n    switch (local.modeJs) {\n\n\n\n    // run browser js-env code - function\n    case 'browser':\n        break;\n\n\n\n    // run node js-env code - function\n    case 'node':\n        break;\n    }\n\n\n\n    // run shared js-env code - init-after\n    (function () {\n        return;\n    }());\n    switch (local.modeJs) {\n\n\n\n    // run browser js-env code - init-after\n    case 'browser':\n        local.testCase_browser_nullCase = local.testCase_browser_nullCase || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test browsers's null-case handling-behavior-behavior\n         */\n            onError(null, options);\n        };\n\n        // run tests\n        local.nop(local.modeTest &&\n            document.querySelector('#testRunButton1') &&\n            document.querySelector('#testRunButton1').click());\n        break;\n\n\n\n    // run node js-env code - init-after\n    /* istanbul ignore next */\n    case 'node':\n        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildApidoc's default handling-behavior-behavior\n         */\n            options = { modulePathList: module.paths };\n            local.buildApidoc(options, onError);\n        };\n\n        local.testCase_buildApp_default = local.testCase_buildApp_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildApp's default handling-behavior-behavior\n         */\n            local.testCase_buildReadme_default(options, local.onErrorThrow);\n            local.testCase_buildLib_default(options, local.onErrorThrow);\n            local.testCase_buildTest_default(options, local.onErrorThrow);\n            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);\n            options = [];\n            local.buildApp(options, onError);\n        };\n\n        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||\n            function (options, onError) {\n            /*\n             * this function will test buildCustomOrg's default handling-behavior\n             */\n                options = {};\n                local.buildCustomOrg(options, onError);\n            };\n\n        local.testCase_buildLib_default = local.testCase_buildLib_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildLib's default handling-behavior\n         */\n            options = {};\n            local.buildLib(options, onError);\n        };\n\n        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildReadme's default handling-behavior-behavior\n         */\n            options = {};\n            local.buildReadme(options, onError);\n        };\n\n        local.testCase_buildTest_default = local.testCase_buildTest_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildTest's default handling-behavior\n         */\n            options = {};\n            local.buildTest(options, onError);\n        };\n\n        local.testCase_webpage_default = local.testCase_webpage_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test webpage's default handling-behavior\n         */\n            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };\n            local.browserTest(options, onError);\n        };\n\n        // run test-server\n        local.testRunServer(local);\n        break;\n    }\n}());\n","/home/travis/build/npmtest/node-npmtest-officegen-2/lib.npmtest_officegen_2.js":"/* istanbul instrument in package npmtest_officegen_2 */\n/*jslint\n    bitwise: true,\n    browser: true,\n    maxerr: 8,\n    maxlen: 96,\n    node: true,\n    nomen: true,\n    regexp: true,\n    stupid: true\n*/\n(function () {\n    'use strict';\n    var local;\n\n\n\n    // run shared js-env code - init-before\n    (function () {\n        // init local\n        local = {};\n        // init modeJs\n        local.modeJs = (function () {\n            try {\n                return typeof navigator.userAgent === 'string' &&\n                    typeof document.querySelector('body') === 'object' &&\n                    typeof XMLHttpRequest.prototype.open === 'function' &&\n                    'browser';\n            } catch (errorCaughtBrowser) {\n                return module.exports &&\n                    typeof process.versions.node === 'string' &&\n                    typeof require('http').createServer === 'function' &&\n                    'node';\n            }\n        }());\n        // init global\n        local.global = local.modeJs === 'browser'\n            ? window\n            : global;\n        // init utility2_rollup\n        local = local.global.utility2_rollup || local;\n        // init lib\n        local.local = local.npmtest_officegen_2 = local;\n        // init exports\n        if (local.modeJs === 'browser') {\n            local.global.utility2_npmtest_officegen_2 = local;\n        } else {\n            module.exports = local;\n            module.exports.__dirname = __dirname;\n            module.exports.module = module;\n        }\n    }());\n}());\n","/home/travis/build/npmtest/node-npmtest-officegen-2/example.js":"/*\nexample.js\n\nquickstart example\n\ninstruction\n    1. save this script as example.js\n    2. run the shell command:\n        $ npm install npmtest-officegen-2 && PORT=8081 node example.js\n    3. play with the browser-demo on http://127.0.0.1:8081\n*/\n\n\n\n/* istanbul instrument in package npmtest_officegen_2 */\n/*jslint\n    bitwise: true,\n    browser: true,\n    maxerr: 8,\n    maxlen: 96,\n    node: true,\n    nomen: true,\n    regexp: true,\n    stupid: true\n*/\n(function () {\n    'use strict';\n    var local;\n\n\n\n    // run shared js-env code - init-before\n    (function () {\n        // init local\n        local = {};\n        // init modeJs\n        local.modeJs = (function () {\n            try {\n                return typeof navigator.userAgent === 'string' &&\n                    typeof document.querySelector('body') === 'object' &&\n                    typeof XMLHttpRequest.prototype.open === 'function' &&\n                    'browser';\n            } catch (errorCaughtBrowser) {\n                return module.exports &&\n                    typeof process.versions.node === 'string' &&\n                    typeof require('http').createServer === 'function' &&\n                    'node';\n            }\n        }());\n        // init global\n        local.global = local.modeJs === 'browser'\n            ? window\n            : global;\n        // init utility2_rollup\n        local = local.global.utility2_rollup || (local.modeJs === 'browser'\n            ? local.global.utility2_npmtest_officegen_2\n            : global.utility2_moduleExports);\n        // export local\n        local.global.local = local;\n    }());\n    switch (local.modeJs) {\n\n\n\n    // init-after\n    // run browser js-env code - init-after\n    /* istanbul ignore next */\n    case 'browser':\n        local.testRunBrowser = function (event) {\n            if (!event || (event &&\n                    event.currentTarget &&\n                    event.currentTarget.className &&\n                    event.currentTarget.className.includes &&\n                    event.currentTarget.className.includes('onreset'))) {\n                // reset output\n                Array.from(\n                    document.querySelectorAll('body > .resettable')\n                ).forEach(function (element) {\n                    switch (element.tagName) {\n                    case 'INPUT':\n                    case 'TEXTAREA':\n                        element.value = '';\n                        break;\n                    default:\n                        element.textContent = '';\n                    }\n                });\n            }\n            switch (event && event.currentTarget && event.currentTarget.id) {\n            case 'testRunButton1':\n                // show tests\n                if (document.querySelector('#testReportDiv1').style.display === 'none') {\n                    document.querySelector('#testReportDiv1').style.display = 'block';\n                    document.querySelector('#testRunButton1').textContent =\n                        'hide internal test';\n                    local.modeTest = true;\n                    local.testRunDefault(local);\n                // hide tests\n                } else {\n                    document.querySelector('#testReportDiv1').style.display = 'none';\n                    document.querySelector('#testRunButton1').textContent = 'run internal test';\n                }\n                break;\n            // custom-case\n            default:\n                break;\n            }\n            if (document.querySelector('#inputTextareaEval1') && (!event || (event &&\n                    event.currentTarget &&\n                    event.currentTarget.className &&\n                    event.currentTarget.className.includes &&\n                    event.currentTarget.className.includes('oneval')))) {\n                // try to eval input-code\n                try {\n                    /*jslint evil: true*/\n                    eval(document.querySelector('#inputTextareaEval1').value);\n                } catch (errorCaught) {\n                    console.error(errorCaught);\n                }\n            }\n        };\n        // log stderr and stdout to #outputTextareaStdout1\n        ['error', 'log'].forEach(function (key) {\n            console[key + '_original'] = console[key];\n            console[key] = function () {\n                var element;\n                console[key + '_original'].apply(console, arguments);\n                element = document.querySelector('#outputTextareaStdout1');\n                if (!element) {\n                    return;\n                }\n                // append text to #outputTextareaStdout1\n                element.value += Array.from(arguments).map(function (arg) {\n                    return typeof arg === 'string'\n                        ? arg\n                        : JSON.stringify(arg, null, 4);\n                }).join(' ') + '\\n';\n                // scroll textarea to bottom\n                element.scrollTop = element.scrollHeight;\n            };\n        });\n        // init event-handling\n        ['change', 'click', 'keyup'].forEach(function (event) {\n            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {\n                element.addEventListener(event, local.testRunBrowser);\n            });\n        });\n        // run tests\n        local.testRunBrowser();\n        break;\n\n\n\n    // run node js-env code - init-after\n    /* istanbul ignore next */\n    case 'node':\n        // export local\n        module.exports = local;\n        // require modules\n        local.fs = require('fs');\n        local.http = require('http');\n        local.url = require('url');\n        // init assets\n        local.assetsDict = local.assetsDict || {};\n        /* jslint-ignore-begin */\n        local.assetsDict['/assets.index.template.html'] = '\\\n<!doctype html>\\n\\\n<html lang=\"en\">\\n\\\n<head>\\n\\\n<meta charset=\"UTF-8\">\\n\\\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\\n\\\n<title>{{env.npm_package_name}} (v{{env.npm_package_version}})</title>\\n\\\n<style>\\n\\\n/*csslint\\n\\\n    box-sizing: false,\\n\\\n    universal-selector: false\\n\\\n*/\\n\\\n* {\\n\\\n    box-sizing: border-box;\\n\\\n}\\n\\\nbody {\\n\\\n    background: #dde;\\n\\\n    font-family: Arial, Helvetica, sans-serif;\\n\\\n    margin: 2rem;\\n\\\n}\\n\\\nbody > * {\\n\\\n    margin-bottom: 1rem;\\n\\\n}\\n\\\n.utility2FooterDiv {\\n\\\n    margin-top: 20px;\\n\\\n    text-align: center;\\n\\\n}\\n\\\n</style>\\n\\\n<style>\\n\\\n/*csslint\\n\\\n*/\\n\\\ntextarea {\\n\\\n    font-family: monospace;\\n\\\n    height: 10rem;\\n\\\n    width: 100%;\\n\\\n}\\n\\\ntextarea[readonly] {\\n\\\n    background: #ddd;\\n\\\n}\\n\\\n</style>\\n\\\n</head>\\n\\\n<body>\\n\\\n<!-- utility2-comment\\n\\\n<div id=\"ajaxProgressDiv1\" style=\"background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;\"></div>\\n\\\nutility2-comment -->\\n\\\n<h1>\\n\\\n<!-- utility2-comment\\n\\\n    <a\\n\\\n        {{#if env.npm_package_homepage}}\\n\\\n        href=\"{{env.npm_package_homepage}}\"\\n\\\n        {{/if env.npm_package_homepage}}\\n\\\n        target=\"_blank\"\\n\\\n    >\\n\\\nutility2-comment -->\\n\\\n        {{env.npm_package_name}} (v{{env.npm_package_version}})\\n\\\n<!-- utility2-comment\\n\\\n    </a>\\n\\\nutility2-comment -->\\n\\\n</h1>\\n\\\n<h3>{{env.npm_package_description}}</h3>\\n\\\n<!-- utility2-comment\\n\\\n<h4><a download href=\"assets.app.js\">download standalone app</a></h4>\\n\\\n<button class=\"onclick onreset\" id=\"testRunButton1\">run internal test</button><br>\\n\\\n<div id=\"testReportDiv1\" style=\"display: none;\"></div>\\n\\\nutility2-comment -->\\n\\\n\\n\\\n\\n\\\n\\n\\\n<label>stderr and stdout</label>\\n\\\n<textarea class=\"resettable\" id=\"outputTextareaStdout1\" readonly></textarea>\\n\\\n<!-- utility2-comment\\n\\\n{{#if isRollup}}\\n\\\n<script src=\"assets.app.js\"></script>\\n\\\n{{#unless isRollup}}\\n\\\nutility2-comment -->\\n\\\n<script src=\"assets.utility2.rollup.js\"></script>\\n\\\n<script src=\"jsonp.utility2._stateInit?callback=window.utility2._stateInit\"></script>\\n\\\n<script src=\"assets.npmtest_officegen_2.rollup.js\"></script>\\n\\\n<script src=\"assets.example.js\"></script>\\n\\\n<script src=\"assets.test.js\"></script>\\n\\\n<!-- utility2-comment\\n\\\n{{/if isRollup}}\\n\\\nutility2-comment -->\\n\\\n<div class=\"utility2FooterDiv\">\\n\\\n    [ this app was created with\\n\\\n    <a href=\"https://github.com/kaizhu256/node-utility2\" target=\"_blank\">utility2</a>\\n\\\n    ]\\n\\\n</div>\\n\\\n</body>\\n\\\n</html>\\n\\\n';\n        /* jslint-ignore-end */\n        if (local.templateRender) {\n            local.assetsDict['/'] = local.templateRender(\n                local.assetsDict['/assets.index.template.html'],\n                {\n                    env: local.objectSetDefault(local.env, {\n                        npm_package_description: 'the greatest app in the world!',\n                        npm_package_name: 'my-app',\n                        npm_package_nameAlias: 'my_app',\n                        npm_package_version: '0.0.1'\n                    })\n                }\n            );\n        } else {\n            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']\n                .replace((/\\{\\{env\\.(\\w+?)\\}\\}/g), function (match0, match1) {\n                    // jslint-hack\n                    String(match0);\n                    switch (match1) {\n                    case 'npm_package_description':\n                        return 'the greatest app in the world!';\n                    case 'npm_package_name':\n                        return 'my-app';\n                    case 'npm_package_nameAlias':\n                        return 'my_app';\n                    case 'npm_package_version':\n                        return '0.0.1';\n                    }\n                });\n        }\n        // run the cli\n        if (local.global.utility2_rollup || module !== require.main) {\n            break;\n        }\n        local.assetsDict['/assets.example.js'] =\n            local.assetsDict['/assets.example.js'] ||\n            local.fs.readFileSync(__filename, 'utf8');\n        // bug-workaround - long $npm_package_buildCustomOrg\n        /* jslint-ignore-begin */\n        local.assetsDict['/assets.npmtest_officegen_2.rollup.js'] =\n            local.assetsDict['/assets.npmtest_officegen_2.rollup.js'] ||\n            local.fs.readFileSync(\n                local.npmtest_officegen_2.__dirname + '/lib.npmtest_officegen_2.js',\n                'utf8'\n            ).replace((/^#!/), '//');\n        /* jslint-ignore-end */\n        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';\n        // if $npm_config_timeout_exit exists,\n        // then exit this process after $npm_config_timeout_exit ms\n        if (Number(process.env.npm_config_timeout_exit)) {\n            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));\n        }\n        // start server\n        if (local.global.utility2_serverHttp1) {\n            break;\n        }\n        process.env.PORT = process.env.PORT || '8081';\n        console.error('server starting on port ' + process.env.PORT);\n        local.http.createServer(function (request, response) {\n            request.urlParsed = local.url.parse(request.url);\n            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {\n                response.end(local.assetsDict[request.urlParsed.pathname]);\n                return;\n            }\n            response.statusCode = 404;\n            response.end();\n        }).listen(process.env.PORT);\n        break;\n    }\n}());\n","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/lib/index.js":"//\r\n// officegen - generating Office documents\r\n//\r\n// Please refer to README.md for this module's documentations.\r\n//\r\n// NOTE:\r\n// - Before changing this code please refer to the hacking the code section on README.md.\r\n//\r\n// Copyright (c) 2013 Ziv Barber;\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files (the\r\n// 'Software'), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\r\n// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\r\n// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\n\r\nvar baseobj = module.exports = require(\"./basicgen.js\");\r\n\r\nrequire(\"./genpptx.js\"); // Register the PPTX/PPSX support plugin.\r\nrequire(\"./genxlsx.js\"); // Register the XLSX support plugin.\r\nrequire(\"./gendocx.js\"); // Register the DOCX support plugin.\r\n\r\nvar officegen_info = require('../package.json');\r\n\r\nbaseobj.version = officegen_info.version;\r\n\r\n","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/lib/basicgen.js":"//\r\n// officegen: basic common code\r\n//\r\n// Please refer to README.md for this module's documentations.\r\n//\r\n// NOTE:\r\n// - Before changing this code please refer to the hacking the code section on README.md.\r\n//\r\n// Copyright (c) 2013 Ziv Barber;\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files (the\r\n// 'Software'), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\r\n// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\r\n// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\n\r\nrequire(\"setimmediate\"); // To be compatible with all versions of node.js\r\n\r\nvar sys = require('sys');\r\nvar events = require('events');\r\n\r\nvar Transform = require('stream').Transform || require('readable-stream/transform');\r\n\r\n// Used by generate:\r\nvar archiver = require('archiver');\r\nvar fs = require('fs');\r\nvar PassThrough = require('stream').PassThrough || require('readable-stream/passthrough');\r\n\r\n// Globals:\r\n\r\nvar int_officegen_globals = {}; // Our internal globals.\r\n\r\nint_officegen_globals.settings = {};\r\nint_officegen_globals.types = {};\r\nint_officegen_globals.docPrototypes = {};\r\nint_officegen_globals.resParserTypes = {};\r\n\r\n///\r\n/// @brief The constructor of the office generator object.\r\n///\r\n/// This constructor function is been called by makegen().\r\n///\r\n/// @b The @b Options:\r\n///\r\n/// The configuration options effecting the operation of the officegen object. Some of them can be only been \r\n/// declared on the 'options' object passed to the constructor object and the rest can be configured by either \r\n/// a property with the same name or by special function.\r\n///\r\n/// @b List @b Of @b Options:\r\n///\r\n/// - 'type' - the type of generator to create. Possible options: either 'pptx', 'docx' or 'xlsx'.\r\n/// - 'creator' - the name of the document's author. The default is 'officegen'.\r\n/// - 'onend' - callback that been fired after finishing to create the zip stream.\r\n/// - 'onerr' - callback that been fired on error.\r\n///\r\n/// @param[in] options List of configuration options (see in the description of this function).\r\n///\r\nofficegen = function ( options ) {\r\n\tif ( false === ( this instanceof officegen )) {\r\n\t\treturn new officegen ( options );\r\n\t} // Endif.\r\n\r\n\tevents.EventEmitter.call ( this );\r\n\t// Transform.call ( this, { objectMode : true } );\r\n\r\n\t// Internal events for plugins - NOT for the user:\r\n\t// event 'beforeGen'\r\n\t// event 'afterGen'\r\n\t// event 'clearDoc'\r\n\r\n\tvar genobj = this;    // Can be accessed by all the functions been declared inside the officegen object.\r\n\tvar gen_private = {}; // For all the private data that we don't want the user of officegen to access it.\r\n\r\n\tgen_private.plugs = {}; // API for plugins.\r\n\tgen_private.features = {}; // Features been configured by the type selector and you can't change them.\r\n\tgen_private.features.type = {};\r\n\tgen_private.features.outputType = 'zip';\r\n\t// gen_private.features.page_name\r\n\r\n\tgen_private.pages = []; // Information about all the pages to create.\r\n\tgen_private.resources = []; // List of all the resources to create inside the zip.\r\n\r\n\tgen_private.type = {};\r\n\r\n\t///\r\n\t/// @brief Combine the given options and the default values.\r\n\t///\r\n\t/// This function creating the real options object.\r\n\t///\r\n\t/// @param[in] options The options to configure.\r\n\t///\r\n\tfunction setOptions ( object, source ) {\r\n\t\tobject = object || {};\r\n\r\n\t\tvar objectTypes = {\r\n\t\t\t'boolean': false,\r\n\t\t\t'function': true,\r\n\t\t\t'object': true,\r\n\t\t\t'number': false,\r\n\t\t\t'string': false,\r\n\t\t\t'undefined': false\r\n\t\t};\r\n\r\n\t\tfunction isObject (value) {\r\n\t\t\treturn !!(value && objectTypes[typeof value]);\r\n\t\t};\r\n\r\n\t\tfunction keys (object) {\r\n\t\t\tif (!isObject(object)) {\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\r\n\t\t\treturn Object.keys(object);\r\n\t\t};\r\n\r\n\t\tvar index;\r\n\t\tvar iterable = object;\r\n\t\tvar result = iterable;\r\n\r\n\t\tvar args = arguments;\r\n\t\tvar argsIndex = 0;\r\n\t\tvar argsLength = args.length;\r\n\r\n\t\twhile (++argsIndex < argsLength) {\r\n\t\t\titerable = args[argsIndex];\r\n\r\n\t\t\tif (iterable && objectTypes[typeof iterable]) {\r\n\t\t\t\tvar ownIndex = -1;\r\n\t\t\t\tvar ownProps = objectTypes[typeof iterable] && keys(iterable);\r\n\t\t\t\tvar length = ownProps ? ownProps.length : 0;\r\n\r\n\t\t\t\twhile (++ownIndex < length) {\r\n\t\t\t\t\tindex = ownProps[ownIndex];\r\n\r\n\t\t\t\t\tif (typeof result[index] === 'undefined' || result[index] == null) {\r\n\t\t\t\t\t\tresult[index] = iterable[index];\r\n\r\n\t\t\t\t\t} else if (isObject(result[index]) && isObject(iterable[index])) {\r\n\t\t\t\t\t\tresult[index] = setOptions(result[index], iterable[index]);\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // End of while loop.\r\n\t\t\t} // Endif.\r\n\t\t} // End of while loop.\r\n\r\n\t\treturn result;\r\n\t};\r\n\r\n\t///\r\n\t/// @brief Configure this object to generate the given type of document.\r\n\t///\r\n\t/// This function configuring the generator to create the given type of document.\r\n\t///\r\n\t/// @param[in] new_type The type of document to create.\r\n\t///\r\n\tfunction setGeneratorType ( new_type ) {\r\n\t\tgen_private.length = 0;\r\n\t\tvar is_ok = false;\r\n\r\n\t\tif ( new_type ) {\r\n\t\t\tfor ( var cur_type in int_officegen_globals.types ) {\r\n\t\t\t\tif ( (cur_type == new_type) && int_officegen_globals.types[cur_type] && int_officegen_globals.types[cur_type].createFunc ) {\r\n\t\t\t\t\tint_officegen_globals.types[cur_type].createFunc ( genobj, new_type, genobj.options, gen_private, int_officegen_globals.types[cur_type] );\r\n\t\t\t\t\tis_ok = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // End of for loop.\r\n\r\n\t\t\tif ( !is_ok ) {\r\n\t\t\t\t// console.error ( '\\nFATAL ERROR: Either unknown or unsupported file type - %s\\n', options.type );\r\n\t\t\t\tgenobj.emit ( 'error', 'FATAL ERROR: Invalid file type.' );\r\n\t\t\t} // Endif.\r\n\t\t} // Endif.\r\n\t};\r\n\r\n\t///\r\n\t/// @brief Add a resource to the list of resources to place inside the output zip file.\r\n\t///\r\n\t/// This method adding a resource to the list of resources to place inside the output document ZIP.\r\n\t///\r\n\t/// @param[in] resource_name The name of the resource (path).\r\n\t/// @param[in] type_of_res The type of this resource: either 'file' or 'buffer'.\r\n\t/// @param[in] res_data Optional data to use when creating this resource.\r\n\t/// @param[in] res_cb Callback to generate this resource (for 'buffer' mode only).\r\n\t/// @param[in] is_always Is true if this resource is perment for all the zip of this document type.\r\n\t/// @param[in] removed_after_used Is true if we need to delete this file after used.\r\n  ///           Added by @author vtloc @date 2014Jan10\r\n  ///\r\n\tgen_private.plugs.intAddAnyResourceToParse = function ( resource_name, type_of_res, res_data, res_cb, is_always, removed_after_used ) {\r\n\t\tvar newRes = {};\r\n\r\n\t\tnewRes.name = resource_name;\r\n\t\tnewRes.type = type_of_res;\r\n\t\tnewRes.data = res_data;\r\n\t\tnewRes.callback = res_cb;\r\n\t\tnewRes.is_perment = is_always;\r\n    \r\n    // delete the temporatory resources after used\r\n    // @author vtloc\r\n    // @date 2014Jan10\r\n    if( removed_after_used )\r\n      newRes.removed_after_used = removed_after_used;\r\n    else\r\n      newRes.removed_after_used = false;\r\n\r\n\t\tgen_private.resources.push ( newRes );\r\n\t};\r\n\r\n\t// Any additional plugin API must be placed here:\r\n\tgen_private.plugs.type = {};\r\n\r\n\t// Public API:\r\n\r\n\t///\r\n\t/// @brief Generating the output document stream.\r\n\t///\r\n\t/// The user of officegen must call this method after filling all the information about what to put inside \r\n\t/// the generated document. This method is creating the output document directly into the given stream object.\r\n\t///\r\n\t/// The options parameters properties:\r\n\t///\r\n\t/// 'finalize' - callback to be called after finishing to generate the document.\r\n\t/// 'error' - callback to be called on error.\r\n\t///\r\n\t/// @param[in] output_stream The stream to receive the generated document.\r\n\t/// @param[in] options Way to pass callbacks.\r\n\t///\r\n\tthis.generate = function ( output_stream, options ) {\r\n\t\tif ( typeof options == 'object' ) {\r\n\t\t\tif ( options.finalize ) {\r\n\t\t\t\tgenobj.on ( 'finalize', options.finalize );\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( options.error ) {\r\n\t\t\t\tgenobj.on ( 'error', options.error );\r\n\t\t\t} // Endif.\r\n\t\t} // Endif.\r\n\r\n\t\tif ( gen_private.features.page_name ) {\r\n\t\t\tif ( gen_private.pages.length == 0 ) {\r\n\t\t\t\tgenobj.emit ( 'error', 'ERROR: No ' + gen_private.features.page_name + ' been found inside your document.' );\r\n\t\t\t} // Endif.\r\n\t\t} // Endif.\r\n\r\n\t\t// Allow the type generator to prepare everything:\r\n\t\tgenobj.emit ( 'beforeGen', gen_private );\r\n\r\n\t\tvar archive = archiver( gen_private.features.outputType == 'zip' ? 'zip' : 'tar' );\r\n\r\n\t\t///\r\n\t\t/// @brief Error handler.\r\n\t\t///\r\n\t\t/// This is our error handler method for creating archive.\r\n\t\t///\r\n\t\t/// @param[in] err The error string.\r\n\t\t///\r\n\t\tfunction onArchiveError ( err ) {\r\n\t\t\tgenobj.emit ( 'error', err );\r\n\t\t}\r\n\r\n\t\tarchive.on ( 'error', onArchiveError );\r\n\r\n\t\tif ( gen_private.features.outputType == 'gzip' ) {\r\n\t\t\tvar zlib = require('zlib');\r\n\t\t\tvar gzipper = zlib.createGzip ();\r\n\r\n\t\t\tarchive.pipe ( gzipper ).pipe ( output_stream );\r\n\r\n\t\t} else {\r\n\t\t\tarchive.pipe ( output_stream );\r\n\t\t} // Endif.\r\n\r\n\t\t///\r\n\t\t/// @brief Add the next resource into the zip stream.\r\n\t\t///\r\n\t\t/// This function adding the next resource into the zip stream.\r\n\t\t///\r\n\t\tfunction generateNextResource ( cur_index )\r\n\t\t{\r\n\t\t\tvar resStream;\r\n\r\n\t\t\tif ( cur_index < gen_private.resources.length ) {\r\n\t\t\t\tif ( typeof gen_private.resources[cur_index] != 'undefined' ) {\r\n\t\t\t\t\tswitch ( gen_private.resources[cur_index].type ) {\r\n\t\t\t\t\t\t// Generate the resource text data by calling to provided function:\r\n\t\t\t\t\t\tcase 'buffer':\r\n\t\t\t\t\t\t\tresStream = gen_private.resources[cur_index].callback ( gen_private.resources[cur_index].data );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// Just copy the file as is:\r\n\t\t\t\t\t\tcase 'file':\r\n\t\t\t\t\t\t\tresStream = fs.createReadStream ( gen_private.resources[cur_index].data || gen_private.resources[cur_index].name );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// Just use this stream:\r\n\t\t\t\t\t\tcase 'stream':\r\n\t\t\t\t\t\t\tresStream = gen_private.resources[cur_index].data;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// Officegen object:\r\n\t\t\t\t\t\tcase 'officegen':\r\n\t\t\t\t\t\t\tresStream = new PassThrough ();\r\n\t\t\t\t\t\t\tgen_private.resources[cur_index].data.generate ( resStream );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// Custom parser:\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tfor ( var cur_parserType in int_officegen_globals.resParserTypes ) {\r\n\t\t\t\t\t\t\t\tif ( (cur_parserType == gen_private.resources[cur_index].type) && int_officegen_globals.resParserTypes[cur_parserType] && int_officegen_globals.resParserTypes[cur_parserType].parserFunc ) {\r\n\t\t\t\t\t\t\t\t\tresStream = int_officegen_globals.resParserTypes[cur_parserType].parserFunc (\r\n\t\t\t\t\t\t\t\t\t\tgenobj,\r\n\t\t\t\t\t\t\t\t\t\tgen_private.resources[cur_index].name,\r\n\t\t\t\t\t\t\t\t\t\tgen_private.resources[cur_index].callback, // Can be used as the template source for template engines.\r\n\t\t\t\t\t\t\t\t\t\tgen_private.resources[cur_index].data,     // The data for the template engine.\r\n\t\t\t\t\t\t\t\t\t\tint_officegen_globals.resParserTypes[cur_parserType].extra_data\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t\t\t} // End of for loop.\r\n\t\t\t\t\t} // End of switch.\r\n\r\n\t\t\t\t\tif ( typeof resStream != 'undefined' ) {\r\n\t\t\t\t\t\tif ( int_officegen_globals.settings.verbose ) {\r\n\t\t\t\t\t\t\tconsole.log ( 'Adding \"' + gen_private.resources[cur_index].name + '\" (' + gen_private.resources[cur_index].type + ')...' );\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tarchive.append ( resStream, { name: gen_private.resources[cur_index].name }, function () {\r\n\t\t\t\t\t\t\tif( gen_private.resources[cur_index].removed_after_used )\r\n\t\t\t\t\t\t\t  {\r\n\t\t\t\t\t\t\t\t// delete the temporatory resources after used\r\n\t\t\t\t\t\t\t\t// @author vtloc\r\n\t\t\t\t\t\t\t\t// @date 2014Jan10\r\n\t\t\t\t\t\t\t\tvar fileName = gen_private.resources[cur_index].data || gen_private.resources[cur_index].name;\r\n\t\t\t\t\t\t\t\tfs.unlinkSync( fileName );\r\n\t\t\t\t\t\t\t  }\r\n\t\t\t\t\t\t\tsetImmediate ( function() { generateNextResource ( cur_index + 1 ); });\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsetImmediate ( function() { generateNextResource ( cur_index + 1 ); });\r\n\t\t\t\t\t} // Endif.\r\n\r\n          \r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Removed resource - just ignore it:\r\n\t\t\t\t\tsetImmediate ( function() { generateNextResource ( cur_index + 1 ); });\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// No more resources to add - close the archive:\r\n\t\t\t\tarchive.finalize ( function ( err, written ) {\r\n\t\t\t\t\t// Event to the type generator:\r\n\t\t\t\t\tgenobj.emit ( 'afterGen', gen_private, err, written );\r\n\r\n\t\t\t\t\tif ( err ) {\r\n\t\t\t\t\t\tonArchiveError ( err );\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tgenobj.emit ( 'finalize', written );\r\n          \r\n\t\t\t\t});\r\n\t\t\t} // Endif.\r\n\t\t};\r\n\r\n\t\t// Start the process of generating the output zip stream:\r\n\t\tgenerateNextResource ( 0 );\r\n\t};\r\n\r\n\t///\r\n\t/// @brief Reuse this object for a new document of the same type.\r\n\t///\r\n\t/// Call this method if you want to start generating a new document of the same type using this object.\r\n\t///\r\n\tthis.startNewDoc = function () {\r\n\t\tvar kill = [];\r\n\r\n\t\tfor ( var i = 0; i < gen_private.resources.length; i++ ) {\r\n\t\t\tif ( !gen_private.resources[i].is_perment ) kill.push ( i );\r\n\t\t} // End of for loop.\r\n\r\n\t\tfor ( var i = 0; i < kill.length; i++ ) gen_private.resources.splice ( kill[i] - i, 1 );\r\n\r\n\t\tgen_private.pages.length = 0;\r\n\r\n\t\tgenobj.emit ( 'clearDoc', gen_private );\r\n\t};\r\n\r\n\t// Public API - plugin API:\r\n\r\n\t///\r\n\t/// @brief Register a new resource to add into the generated ZIP stream.\r\n\t///\r\n\t/// Using this method the user can add extra custom resources into the generated ZIP stream.\r\n\t///\r\n\t/// @param[in] resource_name The name of the resource (path).\r\n\t/// @param[in] type_of_res The type of this resource: either 'file' or 'buffer'.\r\n\t/// @param[in] res_data Optional data to use when creating this resource.\r\n\t/// @param[in] res_cb Callback to generate this resource (for 'buffer' mode only).\r\n\t///\r\n\tthis.addResourceToParse = function ( resource_name, type_of_res, res_data, res_cb ) {\r\n\t\t// We don't want the user to add perment resources to the list of resources:\r\n\t\tgen_private.plugs.intAddAnyResourceToParse ( resource_name, type_of_res, res_data, res_cb, false );\r\n\t};\r\n\r\n\tif ( typeof options == 'string' ) {\r\n\t\toptions = { 'type': options };\r\n\t} // Endif.\r\n\r\n\t// See the officegen descriptions for the rules of the options:\r\n\tgenobj.options = setOptions ( options, { 'type': 'unknown' } );\r\n\r\n\tif ( genobj.options && genobj.options.onerr ) {\r\n\t\tgenobj.on ( 'error', genobj.options.onerr );\r\n\t} // Endif.\r\n\r\n\tif ( genobj.options && genobj.options.onend ) {\r\n\t\tgenobj.on ( 'finalize', genobj.options.onend );\r\n\t} // Endif.\r\n\t\r\n\t// Configure this object depending on the user's selected type:\r\n\tif ( genobj.options.type ) {\r\n\t\tsetGeneratorType ( genobj.options.type );\r\n\t} // Endif.\r\n};\r\n\r\nsys.inherits ( officegen, events.EventEmitter );\r\n// sys.inherits ( officegen, Transform );\r\n\r\n// officegen.prototype._transform = function (chunk, encoding, callback) {\r\n\t// BMK_TODO:\r\n// \tcallback ();\r\n// }\r\n\r\n///\r\n/// @brief Create a new officegen object.\r\n///\r\n/// This method creating a new officegen based object.\r\n///\r\n/// @b Example:\r\n///\r\n/// @code\r\n/// @endcode\r\n///\r\nfunction makegen ( options ) {\r\n\treturn new officegen ( options );\r\n};\r\n\r\n///\r\n/// @brief Change the verbose state of officegen.\r\n///\r\n/// This is a global settings effecting all the officegen objects in your application. You should \r\n/// use it only for debugging.\r\n///\r\n/// @param[in] new_state Either true or false.\r\n///\r\nfunction setVerboseMode ( new_state ) {\r\n\tint_officegen_globals.settings.verbose = new_state;\r\n};\r\n\r\n///\r\n/// @brief Register a new type of document that we can generate.\r\n///\r\n/// This method registering a new type of document that we can generate. You can extend officegen to support any \r\n/// type of document that based on resources files inside ZIP stream.\r\n///\r\n/// @param[in] typeName The type of the document file.\r\n/// @param[in] createFunc The function to use to create this type of file.\r\n/// @param[in] schema_data Information needed by Schema-API to generate this kind of document.\r\n/// @param[in] docType Document type.\r\n/// @param[in] displayName The display name of this type.\r\n///\r\nfunction registerDocType ( typeName, createFunc, schema_data, docType, displayName ) {\r\n\tint_officegen_globals.types[typeName] = {};\r\n\tint_officegen_globals.types[typeName].createFunc = createFunc;\r\n\tint_officegen_globals.types[typeName].schema_data = schema_data;\r\n\tint_officegen_globals.types[typeName].type = docType;\r\n\tint_officegen_globals.types[typeName].display = displayName;\r\n};\r\n\r\n///\r\n/// @brief Register a document prototype object.\r\n///\r\n/// This method registering a prototype document object. You can place all the common code needed by a group of document \r\n/// types in a single prototype object.\r\n///\r\n/// @param[in] typeName The name of the prototype object.\r\n/// @param[in] baseObj The prototype object.\r\n/// @param[in] displayName The display name of this type.\r\n///\r\nfunction registerPrototype ( typeName, baseObj, displayName ) {\r\n\tint_officegen_globals.docPrototypes[typeName] = {};\r\n\tint_officegen_globals.docPrototypes[typeName].baseObj = baseObj;\r\n\tint_officegen_globals.docPrototypes[typeName].display = displayName;\r\n};\r\n\r\n///\r\n/// @brief Get a document prototype object by name.\r\n///\r\n/// This method get a prototype object.\r\n///\r\n/// @param[in] typeName The name of the prototype object.\r\n/// @return The name of the prototype object.\r\n///\r\nfunction getPrototypeByName ( typeName ) {\r\n\treturn int_officegen_globals.docPrototypes[typeName];\r\n};\r\n\r\n///\r\n/// @brief Register a new resource parser.\r\n///\r\n/// This method registering a new resource parser. One use of this feature is in case that you are developing a new \r\n/// type of document and you want to extand officegen to use some kind of template engine as jade, ejs, haml* or CoffeeKup. \r\n/// In this case you can use a template engine to generate one or more of the resources inside the output archive. \r\n/// Another use of this method is to replace an existing plugin with different implementation.\r\n///\r\n/// @param[in] typeName The type of the parser plugin.\r\n/// @param[in] parserFunc The resource generating function.\r\n/// @param[in] extra_data Optional additional data that may be required by the parser function.\r\n/// @param[in] displayName The display name of this type.\r\n///\r\nfunction registerParserType ( typeName, parserFunc, extra_data, displayName ) {\r\n\tint_officegen_globals.resParserTypes[typeName] = {};\r\n\tint_officegen_globals.resParserTypes[typeName].parserFunc = parserFunc;\r\n\tint_officegen_globals.resParserTypes[typeName].extra_data = extra_data;\r\n\tint_officegen_globals.resParserTypes[typeName].display = displayName;\r\n};\r\n\r\nvar ogen = module.exports = makegen;\r\n\r\nogen.makegen = makegen; // To support old versions.\r\nogen.setVerboseMode = setVerboseMode;\r\nogen.plugins = {};\r\nogen.plugins.registerDocType = registerDocType;\r\nogen.plugins.registerPrototype = registerPrototype;\r\nogen.plugins.getPrototypeByName = getPrototypeByName;\r\nogen.plugins.registerParserType = registerParserType;\r\nogen.schema = int_officegen_globals.types;\r\n\r\nogen.docType = { \"TEXT\" : 1, \"SPREADSHEET\" : 2, \"PRESENTATION\" : 3 };\r\n\r\n","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/lib/genpptx.js":"//\r\n// officegen: All the code to generate PPTX/PPTS files.\r\n//\r\n// Please refer to README.md for this module's documentations.\r\n//\r\n// NOTE:\r\n// - Before changing this code please refer to the hacking the code section on README.md.\r\n//\r\n// Copyright (c) 2013 Ziv Barber;\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files (the\r\n// 'Software'), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\r\n// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\r\n// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\nvar baseobj = require(\"./basicgen.js\");\r\nvar officeChart = require(\"./genofficechart.js\");\r\nvar msdoc = require(\"./msofficegen.js\");\r\nvar pptxShapes = require(\"./pptxshapes.js\");\r\n\r\nvar path = require('path');\r\n\r\nvar fast_image_size = require('fast-image-size');\r\n\r\nvar excelbuilder = require('./msexcel-builder.js');\r\n\r\nif ( !String.prototype.encodeHTML ) {\r\n\tString.prototype.encodeHTML = function () {\r\n\t\treturn this.replace(/&/g, '&amp;')\r\n\t\t\t.replace(/</g, '&lt;')\r\n\t\t\t.replace(/>/g, '&gt;')\r\n\t\t\t.replace(/\"/g, '&quot;');\r\n\t};\r\n}\r\n\r\nvar GLOBAL_CHART_COUNT = 0;\r\n\r\n///\r\n/// @brief Extend officegen object with PPTX/PPSX support.\r\n///\r\n/// This method extending the given officegen object to create PPTX/PPSX document.\r\n///\r\n/// @param[in] genobj The object to extend.\r\n/// @param[in] new_type The type of object to create.\r\n/// @param[in] options The object's options.\r\n/// @param[in] gen_private Access to the internals of this object.\r\n/// @param[in] type_info Additional information about this type.\r\n///\r\nfunction makePptx ( genobj, new_type, options, gen_private, type_info ) {\r\n\t///\r\n\t/// @brief Convert shape name to shape information.\r\n\t///\r\n\t/// This method convert the shape information reseived from the user to the real shape information object.\r\n\t///\r\n\t/// @param[in] shapeName Either the name of the shape or the shape information.\r\n\t/// @return Information about this shape.\r\n\t///\r\n\tfunction getShapeInfo ( shapeName ) {\r\n\t\tif ( !shapeName ) {\r\n\t\t\treturn pptxShapes.RECTANGLE;\r\n\t\t} // Endif.\r\n\r\n\t\tif ( (typeof shapeName == 'object') && shapeName.name && shapeName.displayName && shapeName.avLst ) {\r\n\t\t\treturn shapeName;\r\n\t\t} // Endif.\r\n\r\n\t\tif ( pptxShapes[shapeName] ) {\r\n\t\t\treturn pptxShapes[shapeName];\r\n\t\t} // Endif.\r\n\r\n\t\tfor ( var shapeIntName in pptxShapes ) {\r\n\t\t\tif ( pptxShapes[shapeIntName].name == shapeName ) {\r\n\t\t\t\treturn pptxShapes[shapeIntName];\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( pptxShapes[shapeIntName].displayName == shapeName ) {\r\n\t\t\t\treturn pptxShapes[shapeIntName];\r\n\t\t\t} // Endif.\r\n\t\t} // End of for loop.\r\n\r\n\t\treturn pptxShapes.RECTANGLE;\r\n\t}\r\n\r\n\tgenobj.shapes = pptxShapes;\r\n\r\n\t///\r\n\t/// @brief Create the 'presProps.xml' resource.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxPresProps ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + \r\n\t\t\r\n'<p:presentationPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">\\\r\n\t<p:extLst>\\\r\n\t\t<p:ext uri=\"{E76CE94A-603C-4142-B9EB-6D1370010A27}\">\\\r\n\t\t\t<p14:discardImageEditData xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"0\"/>\\\r\n\t\t</p:ext>\\\r\n\t\t<p:ext uri=\"{D31A062A-798A-4329-ABDD-BBA856620510}\">\\\r\n\t\t\t<p14:defaultImageDpi xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"220\"/>\\\r\n\t\t</p:ext>\\\r\n\t\t<p:ext uri=\"{FD5EFAAD-0ECE-453E-9831-46B23BE46B34}\">\\\r\n\t\t\t<p15:chartTrackingRefBased xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\" val=\"1\"/>\\\r\n\t\t</p:ext>\\\r\n\t</p:extLst>\\\r\n</p:presentationPr>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the 'tableStyles.xml' resource.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxStyles ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<a:tblStyleLst xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" def=\"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}\"/>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the 'viewProps.xml' resource.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxViewProps ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<p:viewPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:normalViewPr><p:restoredLeft sz=\"15620\"/><p:restoredTop sz=\"94660\"/></p:normalViewPr><p:slideViewPr><p:cSldViewPr><p:cViewPr varScale=\"1\"><p:scale><a:sx n=\"64\" d=\"100\"/><a:sy n=\"64\" d=\"100\"/></p:scale><p:origin x=\"-1392\" y=\"-96\"/></p:cViewPr><p:guideLst><p:guide orient=\"horz\" pos=\"2160\"/><p:guide pos=\"2880\"/></p:guideLst></p:cSldViewPr></p:slideViewPr><p:notesTextViewPr><p:cViewPr><p:scale><a:sx n=\"100\" d=\"100\"/><a:sy n=\"100\" d=\"100\"/></p:scale><p:origin x=\"0\" y=\"0\"/></p:cViewPr></p:notesTextViewPr><p:gridSpacing cx=\"78028800\" cy=\"78028800\"/></p:viewPr>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the 'slideLayout1.xml' resource.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxLayout ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<p:sldLayout xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" type=\"title\" preserve=\"1\"><p:cSld name=\"Title Slide\"><p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id=\"2\" name=\"Title 1\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ctrTitle\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"685800\" y=\"2130425\"/><a:ext cx=\"7772400\" cy=\"1470025\"/></a:xfrm></p:spPr><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"3\" name=\"Subtitle 2\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"subTitle\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"1371600\" y=\"3886200\"/><a:ext cx=\"6400800\" cy=\"1752600\"/></a:xfrm></p:spPr><p:txBody><a:bodyPr/><a:lstStyle><a:lvl1pPr marL=\"0\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"457200\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"914400\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1371600\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"1828800\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2286000\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2743200\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3200400\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3657600\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle><a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master subtitle style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"4\" name=\"Date Placeholder 3\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"dt\" sz=\"half\" idx=\"10\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:fld id=\"{F8166F1F-CE9B-4651-A6AA-CD717754106B}\" type=\"datetimeFigureOut\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>6/13/2013</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"5\" name=\"Footer Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"11\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"6\" name=\"Slide Number Placeholder 5\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"12\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:fld id=\"{F7021451-1387-4CA6-816F-3879F97B5CBC}\" type=\"slidenum\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>�#�</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp></p:spTree></p:cSld><p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr></p:sldLayout>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the main presentation resource.\r\n\t///\r\n\t/// This resource is the main resource of any PowerPoint document.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxPresentation ( data ) {\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<p:presentation xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" saveSubsetFonts=\"1\"><p:sldMasterIdLst><p:sldMasterId id=\"2147483648\" r:id=\"rId1\"/></p:sldMasterIdLst><p:sldIdLst>';\r\n\r\n\t\tfor ( var i = 0, total_size = gen_private.pages.length; i < total_size; i++ ) {\r\n\t\t\toutString += '<p:sldId id=\"' + (i + 256) + '\" r:id=\"rId' + (i + 2) + '\"/>';\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '</p:sldIdLst><p:sldSz cx=\"9144000\" cy=\"6858000\" type=\"screen4x3\"/><p:notesSz cx=\"6858000\" cy=\"9144000\"/><p:defaultTextStyle><a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>';\r\n\r\n\t\tvar curPos = 0;\r\n\t\tfor ( var i = 1; i < 10; i++ )\r\n\t\t{\r\n\t\t\toutString += '<a:lvl' + i + 'pPr marL=\"' + curPos + '\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl' + i + 'pPr>';\r\n\t\t\tcurPos += 457200;\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '</p:defaultTextStyle>';\r\n\t\t\r\n\t\toutString += '<p:extLst>\\\r\n\t\t<p:ext uri=\"{EFAFB233-063F-42B5-8137-9DF3F51BA10A}\">\\\r\n\t\t\t<p15:sldGuideLst xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\"/>\\\r\n\t\t</p:ext>\\\r\n\t</p:extLst></p:presentation>';\r\n\t\t\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the slides masters resource.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxSlideMasters ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<p:sldMaster xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:cSld><p:bg><p:bgRef idx=\"1001\"><a:schemeClr val=\"bg1\"/></p:bgRef></p:bg><p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id=\"2\" name=\"Title Placeholder 1\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"title\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"274638\"/><a:ext cx=\"8229600\" cy=\"1143000\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"><a:normAutofit/></a:bodyPr><a:lstStyle/><a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"3\" name=\"Text Placeholder 2\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"body\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"1600200\"/><a:ext cx=\"8229600\" cy=\"4525963\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\"><a:normAutofit/></a:bodyPr><a:lstStyle/><a:p><a:pPr lvl=\"0\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl=\"1\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl=\"2\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl=\"3\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl=\"4\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Fifth level</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"4\" name=\"Date Placeholder 3\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"dt\" sz=\"half\" idx=\"2\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"6356350\"/><a:ext cx=\"2133600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"l\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\"{F8166F1F-CE9B-4651-A6AA-CD717754106B}\" type=\"datetimeFigureOut\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>6/13/2013</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"5\" name=\"Footer Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"3\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"3124200\" y=\"6356350\"/><a:ext cx=\"2895600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"ctr\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"6\" name=\"Slide Number Placeholder 5\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"4\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"6553200\" y=\"6356350\"/><a:ext cx=\"2133600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"r\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\"{F7021451-1387-4CA6-816F-3879F97B5CBC}\" type=\"slidenum\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>�#�</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp></p:spTree></p:cSld><p:clrMap bg1=\"lt1\" tx1=\"dk1\" bg2=\"lt2\" tx2=\"dk2\" accent1=\"accent1\" accent2=\"accent2\" accent3=\"accent3\" accent4=\"accent4\" accent5=\"accent5\" accent6=\"accent6\" hlink=\"hlink\" folHlink=\"folHlink\"/><p:sldLayoutIdLst><p:sldLayoutId id=\"2147483649\" r:id=\"rId1\"/></p:sldLayoutIdLst><p:txStyles><p:titleStyle><a:lvl1pPr algn=\"ctr\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"0\"/></a:spcBef><a:buNone/><a:defRPr sz=\"4400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mj-lt\"/><a:ea typeface=\"+mj-ea\"/><a:cs typeface=\"+mj-cs\"/></a:defRPr></a:lvl1pPr></p:titleStyle><p:bodyStyle><a:lvl1pPr marL=\"342900\" indent=\"-342900\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"3200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"742950\" indent=\"-285750\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"1143000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1600200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"2057400\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2514600\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2971800\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3429000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3886200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr></p:bodyStyle><p:otherStyle><a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr><a:lvl1pPr marL=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"457200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"914400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1371600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"1828800\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2286000\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2743200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3200400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3657600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr></p:otherStyle></p:txStyles></p:sldMaster>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Generate the XML code to describe colors.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] color_info Foreground color information.\r\n\t/// @param[in] back_info Background color information.\r\n\t///\r\n\tfunction cMakePptxColorSelection ( color_info, back_info )\r\n\t{\r\n\t\tvar outText = '';\r\n\t\tvar colorVal;\r\n\t\tvar fillType = 'solid';\r\n\t\tvar internalElements = '';\r\n\r\n\t\tif ( back_info ) {\r\n\t\t\toutText += '<p:bg><p:bgPr>';\r\n\r\n\t\t\toutText += cMakePptxColorSelection ( back_info, false );\r\n\r\n\t\t\toutText += '<a:effectLst/>';\r\n\t\t\t// BMK_TODO: (add support for effects)\r\n\t\t\t\r\n\t\t\toutText += '</p:bgPr></p:bg>';\r\n\t\t} // Endif.\r\n\r\n\t\tif ( color_info ) {\r\n\t\t\tif ( typeof color_info == 'string' ) {\r\n\t\t\t\tcolorVal = color_info;\r\n\r\n\t\t\t} else {\r\n\t\t\t\tif ( color_info.type ) {\r\n\t\t\t\t\tfillType = color_info.type;\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( color_info.color ) {\r\n\t\t\t\t\tcolorVal = color_info.color;\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( color_info.alpha ) {\r\n\t\t\t\t\tinternalElements += '<a:alpha val=\"' + (100 - color_info.alpha) + '000\"/>';\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tswitch ( fillType )\r\n\t\t\t{\r\n\t\t\t\tcase 'solid':\r\n\t\t\t\t\toutText += '<a:solidFill><a:srgbClr val=\"' + colorVal + '\">' + internalElements + '</a:srgbClr></a:solidFill>';\r\n\t\t\t\t\tbreak;\r\n\t\t\t} // End of switch.\r\n\t\t} // Endif.\r\n\r\n\t\treturn outText;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] text_info Information how to display the text.\r\n\t/// @param[in] slide_obj The object of this slider.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cMakePptxOutTextData ( text_info, slide_obj ) {\r\n\t\tvar out_obj = {};\r\n\r\n\t\tout_obj.font_size = '';\r\n\t\tout_obj.bold = '';\r\n\t\tout_obj.underline = '';\r\n\t\tout_obj.rpr_info = '';\r\n\r\n\t\tif ( typeof text_info == 'object' )\r\n\t\t{\r\n\t\t\tif ( text_info.bold ) {\r\n\t\t\t\tout_obj.bold = ' b=\"1\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( text_info.underline ) {\r\n\t\t\t\tout_obj.underline = ' u=\"sng\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( text_info.font_size ) {\r\n\t\t\t\tout_obj.font_size = ' sz=\"' + text_info.font_size + '00\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( text_info.color ) {\r\n\t\t\t\tout_obj.rpr_info += cMakePptxColorSelection ( text_info.color );\r\n\r\n\t\t\t} else if ( slide_obj && slide_obj.color )\r\n\t\t\t{\r\n\t\t\t\tout_obj.rpr_info += cMakePptxColorSelection ( slide_obj.color );\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( text_info.font_face ) {\r\n\t\t\t\tout_obj.rpr_info += '<a:latin typeface=\"' + text_info.font_face + '\" pitchFamily=\"34\" charset=\"0\"/><a:cs typeface=\"' + text_info.font_face + '\" pitchFamily=\"34\" charset=\"0\"/>';\r\n\t\t\t} // Endif.\r\n\r\n\t\t} else {\r\n\t\t\tif ( slide_obj && slide_obj.color )\r\n\t\t\t{\r\n\t\t\t\tout_obj.rpr_info += cMakePptxColorSelection ( slide_obj.color );\r\n\t\t\t} // Endif.\r\n\t\t} // Endif.\r\n\r\n\t\tif ( out_obj.rpr_info != '' )\r\n\t\t\tout_obj.rpr_info += '</a:rPr>';\r\n\r\n\t\treturn out_obj;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] text_info Information how to display the text.\r\n\t/// @param[in] text_string The text string.\r\n\t/// @param[in] slide_obj The object of this slider.\r\n\t/// @return The PPTX code.\r\n\t///\r\n\tfunction cMakePptxOutTextCommand ( text_info, text_string, slide_obj ) {\r\n\t\tvar area_opt_data = cMakePptxOutTextData ( text_info, slide_obj );\r\n\t\tvar outData = '<a:r><a:rPr lang=\"en-US\"' + area_opt_data.font_size + area_opt_data.bold + area_opt_data.underline + ' dirty=\"0\" smtClean=\"0\"' + (area_opt_data.rpr_info != '' ? ('>' + area_opt_data.rpr_info) : '/>') + '<a:t>';\r\n\r\n\t\t// Automatic support for newline - split it into multi-p:\r\n\t\tvar parsedText = text_string.split ( \"\\n\" );\r\n\t\tif ( parsedText.length > 1 ) {\r\n\t\t\tvar outTextData = '';\r\n\t\t\tfor ( var i = 0, total_size_i = parsedText.length; i < total_size_i; i++ ) {\r\n\t\t\t\toutTextData += outData + parsedText[i].encodeHTML ();\r\n\r\n\t\t\t\tif ( (i + 1) < total_size_i ) {\r\n\t\t\t\t\toutTextData += '</a:t></a:r></a:p><a:p>';\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // End of for loop.\r\n\r\n\t\t\toutData = outTextData;\r\n\r\n\t\t} else {\r\n\t\t\toutData += text_string.encodeHTML ();\r\n\t\t} // Endif.\r\n\r\n\t\tvar outBreakP = '';\r\n\t\tif ( text_info.breakLine ) {\r\n\t\t\toutBreakP += '</a:p><a:p>';\r\n\t\t} // Endif.\r\n\t\t\r\n\t\treturn outData + '</a:t></a:r>' + outBreakP;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] in_data_val Input value as passed by the user.\r\n\t/// @param[in] max_value Maximum value allowed.\r\n\t/// @param[in] def_value Default value.\r\n\t/// @param[in] auto_val ???.\r\n\t/// @param[in] mul_val ???.\r\n\t/// @return ???.\r\n\t///\r\n\tfunction parseSmartNumber ( in_data_val, max_value, def_value, auto_val, mul_val ) {\t\r\n\t\tif ( typeof in_data_val == 'undefined' ) {\r\n\t\t\treturn (typeof def_value == 'number') ? def_value : 0;\r\n\t\t} // Endif.\r\n\r\n\t\tif ( in_data_val == '' ) {\r\n\t\t\tin_data_val = 0;\r\n\t\t} // Endif.\r\n\t\t\r\n\t\tif ( typeof in_data_val == 'string' && !isNaN ( in_data_val ) ) {\r\n\t\t\tin_data_val = parseInt ( in_data_val, 10 );\r\n\t\t} // Endif.\r\n\t\r\n\t\tvar realNum = mul_val ? in_data_val * mul_val : in_data_val;\r\n\r\n\t\tif ( typeof in_data_val == 'string' ) {\r\n\t\t\tif ( in_data_val.indexOf ( '%' ) != -1 ) {\r\n\t\t\t\tvar realMax = (typeof max_value == 'number') ? max_value : 0;\r\n\t\t\t\tif ( realMax <= 0 ) return 0;\r\n\r\n\t\t\t\tvar realVal = parseInt ( in_data_val, 10 );\r\n\t\t\t\treturn (realMax / 100) * realVal;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( in_data_val.indexOf ( '#' ) != -1 ) {\r\n\t\t\t\tvar realVal = parseInt ( in_data_val, 10 );\r\n\t\t\t\treturn realMax;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tvar realAuto = (typeof auto_val == 'number') ? auto_val : 0;\r\n\r\n\t\t\tif ( in_data_val == '*' ) {\r\n\t\t\t\treturn realAuto;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( in_data_val == 'c' ) {\r\n\t\t\t\treturn realAuto / 2;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\treturn (typeof def_value == 'number') ? def_value : 0;\r\n\t\t} // Endif.\r\n\t\r\n\t\tif ( typeof in_data_val == 'number' ) {\r\n\t\t\treturn realNum;\r\n\t\t} // Endif.\r\n\r\n\t\treturn (typeof def_value == 'number') ? def_value : 0;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the XML code of a single effect.\r\n\t///\r\n\t/// This method creating the effect XML code for a single object.\r\n\t///\r\n\t/// @param[in] effectData Effect data.\r\n\t/// @param[in] effectName The name of the effect.\r\n\t///\r\n\tfunction cbGenerateEffects ( effectData, effectName ) {\r\n\t\tvar outData = '<a:' + effectName + ' ';\r\n\t\tvar color = effectData.color || 'black';\r\n\t\tvar alphaPer = 60;\r\n\t\tvar algnData = '';\r\n\t\tvar blurRad = 50800;\r\n\t\tvar dist = 38100;\r\n\t\tvar dir = 13500000;\r\n\r\n\t\tif ( typeof effectData.transparency == 'number' ) {\r\n\t\t\talphaPer = effectData.transparency;\r\n\t\t} // Endif.\r\n\r\n\t\tif ( (alphaPer > 100) || (alphaPer < 0) )\r\n\t\t\talphaPer = 60;\r\n\r\n\t\talphaPer = (100 - alphaPer) * 1000;\r\n\r\n\t\tif ( effectData.align ) {\r\n\t\t\tif ( effectData.align.top )\r\n\t\t\t\talgnData += 't';\r\n\r\n\t\t\tif ( effectData.align.bottom )\r\n\t\t\t\talgnData += 'b';\r\n\r\n\t\t\tif ( effectData.align.left )\r\n\t\t\t\talgnData += 'l';\r\n\r\n\t\t\tif ( effectData.align.right )\r\n\t\t\t\talgnData += 'r';\r\n\t\t} // Endif.\r\n\r\n\t\tif ( algnData == '' )\r\n\t\t\talgnData = 'br';\r\n\r\n\t\t// Size\r\n\t\t// Blur\r\n\t\t// Angle\r\n\t\t// Distance\r\n\t\t// BMK_TODO:\r\n\r\n\t\toutData += ' blurRad=\"' + blurRad + '\" dist=\"' + dist + '\" dir=\"' + dir + '\" algn=\"' + algnData + '\" rotWithShape=\"0\"';\r\n\r\n\t\t// sx=\"24000\" sy=\"24000\"\r\n\t\t// BMK_TODO:\r\n\r\n\t\toutData += '><a:prstClr val=\"' + color + '\"><a:alpha val=\"' + alphaPer + '\"/></a:prstClr>';\r\n\t\treturn outData + '</a:' + effectName + '>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the body properties code for text.\r\n\t///\r\n\t/// This method creating the XML code of the body properties of a text.\r\n\t///\r\n\t/// @return The body properties XML code.\r\n\t///\r\n\tfunction createBodyProperties ( objOptions ) {\r\n\t\tvar bodyProperties = '<a:bodyPr';\r\n\r\n\t\tif ( objOptions && objOptions.bodyProp ) {\r\n\t\t\t// Set anchorPoints bottom, center or top:\r\n\t\t\tif ( objOptions.bodyProp.anchor ) {\r\n\t\t\t\tbodyProperties += ' anchor=\"' + objOptions.bodyProp.anchor + '\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( objOptions.bodyProp.anchorCtr ) {\r\n\t\t\t\tbodyProperties += ' anchorCtr=\"' + objOptions.bodyProp.anchorCtr + '\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\t// Enable or disable textwrapping none or square:\r\n\t\t\tif ( objOptions.bodyProp.wrap ) {\r\n\t\t\t\tbodyProperties += ' wrap=\"' + objOptions.bodyProp.wrap + '\"';\r\n\r\n\t\t\t} else {\r\n\t\t\t\tbodyProperties += ' wrap=\"square\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\t// Box margins(padding):\r\n\t\t\t// BMK_TODO: I should pass a better value as the auto_val parameter of parseSmartNumber().\r\n\t\t\tif ( objOptions.bodyProp.bIns ) {\r\n\t\t\t\tbodyProperties += ' bIns=\"' + parseSmartNumber ( objOptions.bodyProp.bIns, 6858000, 369332, 6858000, 10000 ) + '\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( objOptions.bodyProp.lIns ) {\r\n\t\t\t\tbodyProperties += ' lIns=\"' + parseSmartNumber ( objOptions.bodyProp.lIns, 9144000, 2819400, 9144000, 10000 ) + '\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( objOptions.bodyProp.rIns ) {\r\n\t\t\t\tbodyProperties += ' rIns=\"' + parseSmartNumber ( objOptions.bodyProp.rIns, 9144000, 2819400, 9144000, 10000 ) + '\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( objOptions.bodyProp.tIns ) {\r\n\t\t\t\tbodyProperties += ' tIns=\"' + parseSmartNumber ( objOptions.bodyProp.tIns, 6858000, 369332, 6858000, 10000 ) + '\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tbodyProperties += ' rtlCol=\"0\">';\r\n\r\n\t\t\tif ( objOptions.bodyProp.autoFit !== false ) {\r\n\t\t\t\tbodyProperties += '<a:spAutoFit/>';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tbodyProperties += '</a:bodyPr>';\r\n\r\n\t\t// Default:\r\n\t\t} else {\r\n\t\t\tbodyProperties += ' wrap=\"square\" rtlCol=\"0\"></a:bodyPr>';\r\n\t\t} // Endif.\r\n\r\n\t\treturn bodyProperties;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Generate a slider resource.\r\n\t///\r\n\t/// This function generating a slider XML resource.\r\n\t///\r\n\t/// @param[in] data The main slide object.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxSlide ( data ) {\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<p:sld xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"';\r\n\t\tvar objs_list = data.data;\r\n\t\tvar timingData = '';\r\n\r\n\t\tif ( !data.slide.show ) {\r\n\t\t\toutString += ' show=\"0\"';\r\n\t\t} // Endif.\r\n\r\n\t\toutString += '><p:cSld>';\r\n\r\n\t\tif ( data.slide.back ) {\r\n\t\t\toutString += cMakePptxColorSelection ( false, data.slide.back );\r\n\t\t} // Endif.\r\n\r\n\t\toutString += '<p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr>';\r\n\r\n\t\t// Loop on all the objects inside the slide to add it into the slide:\r\n\t\tfor ( var i = 0, total_size = objs_list.length; i < total_size; i++ ) {\r\n\t\t\tvar x = 0;\r\n\t\t\tvar y = 0;\r\n\t\t\tvar cx = 2819400;\r\n\t\t\tvar cy = 369332;\r\n\r\n\t\t\tvar moreStyles = '';\r\n\t\t\tvar moreStylesAttr = '';\r\n\t\t\tvar outStyles = '';\r\n\t\t\tvar styleData = '';\r\n\t\t\tvar shapeType = null;\r\n\t\t\tvar locationAttr = '';\r\n\r\n\t\t\tif ( objs_list[i].options ) {\r\n\t\t\t\tif ( typeof objs_list[i].options.cx != 'undefined' ) {\r\n\t\t\t\t\tif ( objs_list[i].options.cx ) {\r\n\t\t\t\t\t\tcx = parseSmartNumber ( objs_list[i].options.cx, 9144000, 2819400, 9144000, 10000 );\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcx = 1;\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( typeof objs_list[i].options.cy != 'undefined' ) {\r\n\t\t\t\t\tif ( objs_list[i].options.cy ) {\r\n\t\t\t\t\t\tcy = parseSmartNumber ( objs_list[i].options.cy, 6858000, 369332, 6858000, 10000 );\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcy = 1;\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( objs_list[i].options.x ) {\r\n\t\t\t\t\tx = parseSmartNumber ( objs_list[i].options.x, 9144000, 0, 9144000 - cx, 10000 );\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( objs_list[i].options.y ) {\r\n\t\t\t\t\ty = parseSmartNumber ( objs_list[i].options.y, 6858000, 0, 6858000 - cy, 10000 );\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( objs_list[i].options.shape ) {\r\n\t\t\t\t\tshapeType = getShapeInfo ( objs_list[i].options.shape );\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( objs_list[i].options.flip_vertical ) {\r\n\t\t\t\t\tlocationAttr += ' flipV=\"1\"';\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( objs_list[i].options.rotate ) {\r\n\t\t\t\t\tvar rotateVal = objs_list[i].options.rotate > 360 ? (objs_list[i].options.rotate - 360) : objs_list[i].options.rotate;\r\n\t\t\t\t\trotateVal *= 60000;\r\n\t\t\t\t\tlocationAttr += ' rot=\"' + rotateVal + '\"';\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tswitch ( objs_list[i].type ) {\r\n\t\t\t\t// TODO: remove hard code here\r\n\t\t\t\tcase 'chart':\r\n\t\t\t\t\t// loop through the charts\r\n\t\t\t\t\t// \r\n\r\n\t\t\t\t\tif( objs_list[i].renderType === 'pie' )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toutString += '<p:graphicFrame>\\\r\n\t\t\t\t\t\t\t<p:nvGraphicFramePr>\\\r\n\t\t\t\t\t\t\t\t<p:cNvPr id=\"20\" name=\"Chart 19\"/>\\\r\n\t\t\t\t\t\t\t\t<p:cNvGraphicFramePr/>\\\r\n\t\t\t\t\t\t\t\t<p:nvPr>\\\r\n\t\t\t\t\t\t\t\t\t<p:extLst>\\\r\n\t\t\t\t\t\t\t\t\t\t<p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\">\\\r\n\t\t\t\t\t\t\t\t\t\t\t<p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"4198609065\"/>\\\r\n\t\t\t\t\t\t\t\t\t\t</p:ext>\\\r\n\t\t\t\t\t\t\t\t\t</p:extLst>\\\r\n\t\t\t\t\t\t\t\t</p:nvPr>\\\r\n\t\t\t\t\t\t\t</p:nvGraphicFramePr>\\\r\n\t\t\t\t\t\t\t<p:xfrm>\\\r\n\t\t\t\t\t\t\t\t<a:off x=\"1524000\" y=\"1397000\"/>\\\r\n\t\t\t\t\t\t\t\t<a:ext cx=\"6096000\" cy=\"4064000\"/>\\\r\n\t\t\t\t\t\t\t</p:xfrm>\\\r\n\t\t\t\t\t\t\t<a:graphic>\\\r\n\t\t\t\t\t\t\t\t<a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\">\\\r\n\t\t\t\t\t\t\t\t\t<c:chart xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" r:id=\"rId2\"/>\\\r\n\t\t\t\t\t\t\t\t</a:graphicData>\\\r\n\t\t\t\t\t\t\t</a:graphic>\\\r\n\t\t\t\t\t\t</p:graphicFrame>'\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if( objs_list[i].renderType === 'column' )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toutString += '\\\r\n\t\t\t\t\t\t\\\r\n\t\t\t\t\t\t<p:graphicFrame>\\\r\n\t\t\t\t\t\t\t<p:nvGraphicFramePr>\\\r\n\t\t\t\t\t\t\t\t<p:cNvPr id=\"4\" name=\"Chart 3\"/>\\\r\n\t\t\t\t\t\t\t\t<p:cNvGraphicFramePr/>\\\r\n\t\t\t\t\t\t\t\t<p:nvPr>\\\r\n\t\t\t\t\t\t\t\t\t<p:extLst>\\\r\n\t\t\t\t\t\t\t\t\t\t<p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\">\\\r\n\t\t\t\t\t\t\t\t\t\t\t<p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1256887135\"/>\\\r\n\t\t\t\t\t\t\t\t\t\t</p:ext>\\\r\n\t\t\t\t\t\t\t\t\t</p:extLst>\\\r\n\t\t\t\t\t\t\t\t</p:nvPr>\\\r\n\t\t\t\t\t\t\t</p:nvGraphicFramePr>\\\r\n\t\t\t\t\t\t\t<p:xfrm>\\\r\n\t\t\t\t\t\t\t\t<a:off x=\"1524000\" y=\"1397000\"/>\\\r\n\t\t\t\t\t\t\t\t<a:ext cx=\"6096000\" cy=\"4064000\"/>\\\r\n\t\t\t\t\t\t\t</p:xfrm>\\\r\n\t\t\t\t\t\t\t<a:graphic>\\\r\n\t\t\t\t\t\t\t\t<a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\">\\\r\n\t\t\t\t\t\t\t\t\t<c:chart xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" r:id=\"rId2\"/>\\\r\n\t\t\t\t\t\t\t\t</a:graphicData>\\\r\n\t\t\t\t\t\t\t</a:graphic>\\\r\n\t\t\t\t\t\t</p:graphicFrame>\\\r\n\t\t\t\t\t\t'\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'text':\r\n\t\t\t\tcase 'cxn':\r\n\t\t\t\t\tvar effectsList = '';\r\n\r\n\t\t\t\t\tif ( shapeType == null ) shapeType = getShapeInfo ( null );\r\n\r\n\t\t\t\t\t// if ( objs_list[i].type == 'text' ) {\r\n\t\t\t\t\t// \tif ( !objs_list[i].options || (!objs_list[i].options.cx && !objs_list[i].options.cx) ) {\r\n\t\t\t\t\t// \t\tobjs_list[i].options = objs_list[i].options ? objs_list[i].options : {};\r\n\t\t\t\t\t// \t\tobjs_list[i].options.bodyProp = objs_list[i].options.bodyProp ? objs_list[i].options.bodyProp : {};\r\n\t\t\t\t\t// \t\tobjs_list[i].options.bodyProp.autoFit = true;\r\n\t\t\t\t\t// \t\tcx = 9144000 - x;\r\n\t\t\t\t\t// \t\tcy = 6858000 - y;\r\n\t\t\t\t\t// \t} // Endif.\r\n\t\t\t\t\t// } // Endif.\r\n\r\n\t\t\t\t\tif ( objs_list[i].type == 'cxn' ) {\r\n\t\t\t\t\t\toutString += '<p:cxnSp><p:nvCxnSpPr>';\r\n\t\t\t\t\t\toutString += '<p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:nvPr/></p:nvCxnSpPr>';\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toutString += '<p:sp><p:nvSpPr>';\r\n\t\t\t\t\t\toutString += '<p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvSpPr txBox=\"1\"/><p:nvPr/></p:nvSpPr>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\toutString += '<p:spPr>';\r\n\r\n\t\t\t\t\toutString += '<a:xfrm' + locationAttr + '>';\r\n\r\n\t\t\t\t\toutString += '<a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm><a:prstGeom prst=\"' + shapeType.name + '\"><a:avLst/></a:prstGeom>';\r\n\r\n\t\t\t\t\tif ( objs_list[i].options ) {\r\n\t\t\t\t\t\tif ( objs_list[i].options.fill ) {\r\n\t\t\t\t\t\t\toutString += cMakePptxColorSelection ( objs_list[i].options.fill );\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\toutString += '<a:noFill/>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tif ( objs_list[i].options.line ) {\r\n\t\t\t\t\t\t\tvar lineAttr = '';\r\n\r\n\t\t\t\t\t\t\tif ( objs_list[i].options.line_size ) {\r\n\t\t\t\t\t\t\t\tlineAttr += ' w=\"' + (objs_list[i].options.line_size * 12700) + '\"';\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\t// cmpd=\"dbl\"\r\n\r\n\t\t\t\t\t\t\toutString += '<a:ln' + lineAttr + '>';\r\n\t\t\t\t\t\t\toutString += cMakePptxColorSelection ( objs_list[i].options.line );\r\n\r\n\t\t\t\t\t\t\tif ( objs_list[i].options.line_head ) {\r\n\t\t\t\t\t\t\t\toutString += '<a:headEnd type=\"' + objs_list[i].options.line_head + '\"/>';\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\tif ( objs_list[i].options.line_tail ) {\r\n\t\t\t\t\t\t\t\toutString += '<a:tailEnd type=\"' + objs_list[i].options.line_tail + '\"/>';\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\toutString += '</a:ln>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toutString += '<a:noFill/>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( objs_list[i].options.effects ) {\r\n\t\t\t\t\t\tfor ( var ii = 0, total_size_ii = objs_list[i].options.effects.length; ii < total_size_ii; ii++ ) {\r\n\t\t\t\t\t\t\tswitch ( objs_list[i].options.effects[ii].type ) {\r\n\t\t\t\t\t\t\t\tcase 'outerShadow':\r\n\t\t\t\t\t\t\t\t\teffectsList += cbGenerateEffects ( objs_list[i].options.effects[ii], 'outerShdw' );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase 'innerShadow':\r\n\t\t\t\t\t\t\t\t\teffectsList += cbGenerateEffects ( objs_list[i].options.effects[ii], 'innerShdw' );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t} // End of switch.\r\n\t\t\t\t\t\t} // End of for loop.\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( effectsList != '' ) {\r\n\t\t\t\t\t\toutString += '<a:effectLst>' + effectsList + '</a:effectLst>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\toutString += '</p:spPr>';\r\n\r\n\t\t\t\t\tif ( objs_list[i].options ) {\r\n\t\t\t\t\t\tif ( objs_list[i].options.align ) {\r\n\t\t\t\t\t\t\tswitch ( objs_list[i].options.align )\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcase 'right':\r\n\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' algn=\"r\"';\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase 'center':\r\n\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' algn=\"ctr\"';\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase 'justify':\r\n\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' algn=\"just\"';\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t} // End of switch.\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tif ( objs_list[i].options.indentLevel > 0 ) {\r\n\t\t\t\t\t\t\t\tmoreStylesAttr += ' lvl=\"' + objs_list[i].options.indentLevel + '\"';\r\n\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( moreStyles != '' ) {\r\n\t\t\t\t\t\toutStyles = '<a:pPr' + moreStylesAttr + '>' + moreStyles + '</a:pPr>';\r\n\r\n\t\t\t\t\t} else if ( moreStylesAttr != '' ) {\r\n\t\t\t\t\t\toutStyles = '<a:pPr' + moreStylesAttr + '/>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( styleData != '' ) {\r\n\t\t\t\t\t\toutString += '<p:style>' + styleData + '</p:style>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( typeof objs_list[i].text == 'string' ) {\r\n\t\t\t\t\t\toutString += '<p:txBody>' + createBodyProperties ( objs_list[i].options ) + '<a:lstStyle/><a:p>' + outStyles;\r\n\t\t\t\t\t\toutString += cMakePptxOutTextCommand ( objs_list[i].options, objs_list[i].text, data.slide );\r\n\r\n\t\t\t\t\t} else if ( objs_list[i].text ) {\r\n\t\t\t\t\t\tvar outBodyOpt = createBodyProperties ( objs_list[i].options );\r\n\t\t\t\t\t\toutString += '<p:txBody>' + outBodyOpt + '<a:lstStyle/><a:p>' + outStyles;\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, total_size_j = objs_list[i].text.length; j < total_size_j; j++ ) {\r\n\t\t\t\t\t\t\tif ( objs_list[i].text[j] ) {\r\n\t\t\t\t\t\t\t\toutString += cMakePptxOutTextCommand ( objs_list[i].text[j].options, objs_list[i].text[j].text, data.slide, outBodyOpt, outStyles );\r\n\t\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( typeof objs_list[i].text != 'undefined' ) {\r\n\t\t\t\t\t\tvar font_size = '';\r\n\t\t\t\t\t\tif ( objs_list[i].options && objs_list[i].options.font_size ) {\r\n\t\t\t\t\t\t\tfont_size = ' sz=\"' + objs_list[i].options.font_size + '00\"';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\toutString += '<a:endParaRPr lang=\"en-US\"' + font_size + ' dirty=\"0\"/></a:p></p:txBody>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\toutString += objs_list[i].type == 'cxn' ? '</p:cxnSp>' : '</p:sp>';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t// Table:\r\n\t\t\t\tcase 'table':\r\n\t\t\t\t\toutString += '<p:graphicFrame><p:nvGraphicFramePr><p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvGraphicFramePr><a:graphicFrameLocks noGrp=\"1\"/></p:cNvGraphicFramePr><p:nvPr/></p:nvGraphicFramePr>';\r\n\t\t\t\t\toutString += '<p:xfrm><a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></p:xfrm>';\r\n\t\t\t\t\toutString += '<a:graphic><a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/table\"><a:tbl><a:tblPr firstRow=\"1\" bandRow=\"1\"><a:tableStyleId>{073A0DAA-6AF3-43AB-8588-CEC1D06C72B9}</a:tableStyleId></a:tblPr><a:tblGrid>';\r\n\t\t\t\t\t// <a:gridCol w=\"3276600\"/>\r\n\t\t\t\t\toutString += '</a:tblGrid>';\r\n\t\t\t\t\t// objs_list[i].options\r\n\t\t\t\t\t// objs_list[i].rows[][].text\r\n\t\t\t\t\t// BMK_TODO:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t// Image:\r\n\t\t\t\tcase 'image':\r\n\t\t\t\t\toutString += '<p:pic><p:nvPicPr><p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr><p:nvPr/></p:nvPicPr><p:blipFill><a:blip r:embed=\"rId' + objs_list[i].rel_id + '\" cstate=\"print\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill><p:spPr><a:xfrm' + locationAttr + '><a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr></p:pic>';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t// Paragraph:\r\n\t\t\t\tcase 'p':\r\n\t\t\t\t\tif ( shapeType == null ) shapeType = getShapeInfo ( null );\r\n\r\n\t\t\t\t\toutString += '<p:sp><p:nvSpPr>';\r\n\t\t\t\t\toutString += '<p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvSpPr txBox=\"1\"/><p:nvPr/></p:nvSpPr>';\r\n\t\t\t\t\toutString += '<p:spPr>';\r\n\r\n\t\t\t\t\toutString += '<a:xfrm' + locationAttr + '>';\r\n\r\n\t\t\t\t\toutString += '<a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm><a:prstGeom prst=\"' + shapeType.name + '\"><a:avLst/></a:prstGeom>';\r\n\r\n\t\t\t\t\tif ( objs_list[i].options ) {\r\n\t\t\t\t\t\tif ( objs_list[i].options.fill ) {\r\n\t\t\t\t\t\t\toutString += cMakePptxColorSelection ( objs_list[i].options.fill );\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\toutString += '<a:noFill/>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tif ( objs_list[i].options.line ) {\r\n\t\t\t\t\t\t\toutString += '<a:ln>';\r\n\t\t\t\t\t\t\toutString += cMakePptxColorSelection ( objs_list[i].options.line );\r\n\r\n\t\t\t\t\t\t\tif ( objs_list[i].options.line_head ) {\r\n\t\t\t\t\t\t\t\toutString += '<a:headEnd type=\"' + objs_list[i].options.line_head + '\"/>';\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\tif ( objs_list[i].options.line_tail ) {\r\n\t\t\t\t\t\t\t\toutString += '<a:tailEnd type=\"' + objs_list[i].options.line_tail + '\"/>';\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\toutString += '</a:ln>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toutString += '<a:noFill/>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\toutString += '</p:spPr>';\r\n\r\n\t\t\t\t\tif ( styleData != '' ) {\r\n\t\t\t\t\t\toutString += '<p:style>' + styleData + '</p:style>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\toutString += '<p:txBody><a:bodyPr wrap=\"square\" rtlCol=\"0\"><a:spAutoFit/></a:bodyPr><a:lstStyle/>';\r\n\r\n\t\t\t\t\tfor ( var j = 0, total_size_j = objs_list[i].data.length; j < total_size_j; j++ ) {\r\n\t\t\t\t\t\tif ( objs_list[i].data[j] ) {\r\n\t\t\t\t\t\t\tmoreStylesAttr = '';\r\n\t\t\t\t\t\t\tmoreStyles = '';\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif ( objs_list[i].data[j].options ) {\r\n\t\t\t\t\t\t\t\tif ( objs_list[i].data[j].options.align ) {\r\n\t\t\t\t\t\t\t\t\tswitch ( objs_list[i].data[j].options.align )\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tcase 'right':\r\n\t\t\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' algn=\"r\"';\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 'center':\r\n\t\t\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' algn=\"ctr\"';\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 'justify':\r\n\t\t\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' algn=\"just\"';\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t} // End of switch.\r\n\t\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\t\tif ( objs_list[i].data[j].options.indentLevel > 0 ) {\r\n\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' lvl=\"' + objs_list[i].data[j].options.indentLevel + '\"';\r\n\t\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\t\tif ( objs_list[i].data[j].options.listType == 'number' ) {\r\n\t\t\t\t\t\t\t\t\tmoreStyles += '<a:buFont typeface=\"+mj-lt\"/><a:buAutoNum type=\"arabicPeriod\"/>';\r\n\t\t\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\tif ( moreStyles != '' ) {\r\n\t\t\t\t\t\t\t\toutStyles = '<a:pPr' + moreStylesAttr + '>' + moreStyles + '</a:pPr>';\r\n\r\n\t\t\t\t\t\t\t} else if ( moreStylesAttr != '' ) {\r\n\t\t\t\t\t\t\t\toutStyles = '<a:pPr' + moreStylesAttr + '/>';\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\toutString += '<a:p>' + outStyles;\r\n\r\n\t\t\t\t\t\t\t// if ( typeof objs_list[i].data[j].text == 'string' ) {\r\n\t\t\t\t\t\t\toutString += cMakePptxOutTextCommand ( objs_list[i].data[j].options, objs_list[i].data[j].text, data.slide );\r\n\t\t\t\t\t\t\t// BMK_TODO:\r\n\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tvar font_size = '';\r\n\t\t\t\t\tif ( objs_list[i].options && objs_list[i].options.font_size ) {\r\n\t\t\t\t\t\tfont_size = ' sz=\"' + objs_list[i].options.font_size + '00\"';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\toutString += '<a:endParaRPr lang=\"en-US\"' + font_size + ' dirty=\"0\"/></a:p>';\r\n\t\t\t\t\toutString += '</p:txBody>';\r\n\r\n\t\t\t\t\toutString += '</p:sp>';\r\n\t\t\t\t\tbreak;\r\n\t\t\t} // End of switch.\r\n\t\t} // End of for loop.\r\n\t\t\r\n\t\toutString += '</p:spTree></p:cSld><p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr>';\r\n\r\n\t\tif ( timingData != '' ) {\r\n\t\t\toutString += '<p:timing>' + timingData + '</p:timing>';\r\n\t\t} // Endif.\r\n\r\n\t\toutString += '</p:sld>';\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Generate the extended attributes file (app) for PPTX/PPSX documents.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxApp ( data ) {\r\n\t\tvar slidesCount = gen_private.pages.length;\r\n\t\tvar userName = genobj.options.creator || 'officegen';\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\"><TotalTime>0</TotalTime><Words>0</Words><Application>Microsoft Office PowerPoint</Application><PresentationFormat>On-screen Show (4:3)</PresentationFormat><Paragraphs>0</Paragraphs><Slides>' + slidesCount + '</Slides><Notes>0</Notes><HiddenSlides>0</HiddenSlides><MMClips>0</MMClips><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size=\"4\" baseType=\"variant\"><vt:variant><vt:lpstr>Theme</vt:lpstr></vt:variant><vt:variant><vt:i4>1</vt:i4></vt:variant><vt:variant><vt:lpstr>Slide Titles</vt:lpstr></vt:variant><vt:variant><vt:i4>' + slidesCount + '</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size=\"' + (slidesCount + 1) + '\" baseType=\"lpstr\"><vt:lpstr>Office Theme</vt:lpstr>';\r\n\r\n\t\tfor ( var i = 0, total_size = gen_private.pages.length; i < total_size; i++ ) {\r\n\t\t\toutString += '<vt:lpstr>' + gen_private.pages[i].slide.name.encodeHTML () + '</vt:lpstr>';\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '</vt:vector></TitlesOfParts><Company>' + userName + '</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>12.0000</AppVersion></Properties>';\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Convert the chart object into xml string\r\n\t///\r\n\t/// @param[in] data \r\n\t/// @return Text Xml string.\r\n\t///\r\n\tfunction cbMakeCharts ( data ) {\r\n\t\tif( data['renderType'] === 'pie' )\r\n\t\t{\r\n\t\t\treturn officeChart.makePieChartStringFromData( data);\r\n\t\t}\r\n\t\telse if( data['renderType'] === 'column' )\r\n    {\r\n\t\t\treturn officeChart.makeColumnChartStringFromData( data);\r\n    }\r\n    else if( data['renderType'] === 'bar' )\r\n    {\r\n\t\t\treturn officeChart.makeBarChartStringFromData( data);\r\n    }\r\n    else if( data['renderType'] === 'group-bar' )\r\n    {\r\n\t\t\treturn officeChart.makeGroupBarChartStringFromData( data);\r\n    }\r\n\t}\r\n\t\r\n\tfunction cbMakeChartDataExcel ( data ) {\r\n\t\t\r\n\t}\t\r\n\t\r\n\t// Prepare genobj for MS-Office:\r\n\tmsdoc.makemsdoc ( genobj, new_type, options, gen_private, type_info );\r\n\tgen_private.plugs.type.msoffice.makeOfficeGenerator ( 'ppt', 'presentation', {} );\r\n\r\n\tgen_private.features.page_name = 'slides'; // This document type must have pages.\r\n\r\n\tgen_private.plugs.type.msoffice.addInfoType ( 'dc:title', '', 'title', 'setDocTitle' );\r\n\r\n\tvar type_of_main_doc = 'slideshow';\r\n\tif ( new_type != 'ppsx' )\r\n\t{\r\n\t\ttype_of_main_doc = 'presentation';\r\n\t} // Endif.\r\n\r\n\tgen_private.type.msoffice.files_list.push (\r\n\t\t{\r\n\t\t\tname: '/ppt/slideMasters/slideMaster1.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/ppt/presProps.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.presProps+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/ppt/presentation.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.' + type_of_main_doc + '.main+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/ppt/slideLayouts/slideLayout1.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/ppt/tableStyles.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/ppt/viewProps.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml',\r\n\t\t\tclear: 'type'\r\n\t\t}\r\n\t);\r\n\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\presProps.xml', 'buffer', null, cbMakePptxPresProps, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\tableStyles.xml', 'buffer', null, cbMakePptxStyles, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\viewProps.xml', 'buffer', null, cbMakePptxViewProps, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\presentation.xml', 'buffer', null, cbMakePptxPresentation, true );\r\n\t\r\n\t\r\n\t\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\slideLayouts\\\\slideLayout1.xml', 'buffer', null, cbMakePptxLayout, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\slideLayouts\\\\_rels\\\\slideLayout1.xml.rels', 'buffer', [\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster',\r\n\t\t\ttarget: '../slideMasters/slideMaster1.xml'\r\n\t\t}\r\n\t], gen_private.plugs.type.msoffice.cbMakeRels, true );\r\n\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\slideMasters\\\\slideMaster1.xml', 'buffer', null, cbMakePptxSlideMasters, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\slideMasters\\\\_rels\\\\slideMaster1.xml.rels', 'buffer', [\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout',\r\n\t\t\ttarget: '../slideLayouts/slideLayout1.xml'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\r\n\t\t\ttarget: '../theme/theme1.xml'\r\n\t\t}\r\n\t], gen_private.plugs.type.msoffice.cbMakeRels, true );\r\n\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'docProps\\\\app.xml', 'buffer', null, cbMakePptxApp, true );\r\n\r\n\tgen_private.type.msoffice.rels_app.push (\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster',\r\n\t\t\ttarget: 'slideMasters/slideMaster1.xml',\r\n\t\t\tclear: 'type'\r\n\t\t}\r\n\t);\r\n\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\_rels\\\\presentation.xml.rels', 'buffer', gen_private.type.msoffice.rels_app, gen_private.plugs.type.msoffice.cbMakeRels, true );\r\n\r\n\t// ----- API for PowerPoint documents: -----\r\n\r\n\t///\r\n\t/// @brief Create a new slide.\r\n\t///\r\n\t/// This method creating a new slide inside the presentation.\r\n\t///\r\n\t/// @return The new slide object.\r\n\t///\r\n\tgenobj.makeNewSlide = function () {\r\n\t\tvar pageNumber = gen_private.pages.length;\r\n\t\tvar slideObj = { show: true }; // The slide object that the user will use.\r\n\r\n\t\tgen_private.pages[pageNumber] = {};\r\n\t\tgen_private.pages[pageNumber].slide = slideObj;\r\n\t\tgen_private.pages[pageNumber].data = [];\r\n\t\tgen_private.pages[pageNumber].rels = [\r\n\t\t\t{\r\n\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout',\r\n\t\t\t\ttarget: '../slideLayouts/slideLayout1.xml',\r\n\t\t\t\tclear: 'data'\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\tgen_private.type.msoffice.files_list.push (\r\n\t\t\t{\r\n\t\t\t\tname: '/ppt/slides/slide' + (pageNumber + 1) + '.xml',\r\n\t\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.slide+xml',\r\n\t\t\t\tclear: 'data'\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tgen_private.type.msoffice.rels_app.push (\r\n\t\t\t{\r\n\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide',\r\n\t\t\t\ttarget: 'slides/slide' + (pageNumber + 1) + '.xml',\r\n\t\t\t\tclear: 'data'\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tslideObj.getPageNumber = function () { return pageNumber; };\r\n\r\n\t\tslideObj.name = 'Slide ' + (pageNumber + 1);\r\n\r\n\t\t///\r\n\t\t/// @brief ???.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] prgObj Paragraph object.\r\n\t\t///\r\n\t\tfunction addParagraphApiForBasicOpt ( prgObj ) {\r\n\t\t\tif ( !prgObj.api ) {\r\n\t\t\t\tprgObj.api = {};\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tprgObj.api.options = prgObj.options;\r\n\t\t}\r\n\r\n\t\t///\r\n\t\t/// @brief ???.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] prgObj Paragraph object.\r\n\t\t///\r\n\t\tfunction addParagraphApiForEffects ( prgObj ) {\r\n\t\t\tif ( !prgObj.api ) {\r\n\t\t\t\tprgObj.api = {};\r\n\t\t\t} // Endif.\r\n\r\n\t\t\t///\r\n\t\t\t/// @brief ???.\r\n\t\t\t///\r\n\t\t\t/// ???.\r\n\t\t\t///\r\n\t\t\t/// @param[in] inType ???.\r\n\t\t\t/// @param[in] inAlign ???.\r\n\t\t\t/// @param[in] inColor ???.\r\n\t\t\t/// @param[in] inTransparency ???.\r\n\t\t\t/// @param[in] inSize ???.\r\n\t\t\t/// @param[in] inBlur ???.\r\n\t\t\t/// @param[in] inAngle ???.\r\n\t\t\t/// @param[in] inDistance ???.\r\n\t\t\t///\r\n\t\t\tprgObj.api.setShadowEffect = function ( inType, inAlign, inColor, inTransparency, inSize, inBlur, inAngle, inDistance ) {\r\n\t\t\t\tif ( !prgObj.options.effects )\r\n\t\t\t\t\tprgObj.options.effects = [];\r\n\r\n\t\t\t\tvar newEffect = {\r\n\t\t\t\t\t'type': inType,\r\n\t\t\t\t\t'align': inAlign,\r\n\t\t\t\t\t'color': inColor,\r\n\t\t\t\t\t'transparency': inTransparency,\r\n\t\t\t\t\t'size': inSize,\r\n\t\t\t\t\t'blur': inBlur,\r\n\t\t\t\t\t'angle': inAngle,\r\n\t\t\t\t\t'distance': inDistance\r\n\t\t\t\t};\r\n\r\n\t\t\t\tprgObj.options.effects.push ( newEffect );\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t///\r\n\t\t/// @brief Generate the chart based on input data.\r\n\t\t/// @param[in] renderType should belong to: 'column', 'pie'\r\n\t\t/// @param[in] data a JSON object with follow the following format\r\n\t\t///     { \t\r\n\t\t///\t\t\ttitle: 'eSurvey chart',\r\n\t\t///\t\t\tdata:  [\r\n\t\t///\t\t\t\t{\r\n\t\t///\t\t\t\t\tname: 'Income',\r\n\t\t///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n\t\t///\t\t\t\t\tvalues: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n\t\t///\t\t\t\t},\r\n\t\t///\t\t\t\t{\r\n\t\t///\t\t\t\t\tname: 'Expense',\r\n\t\t///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n\t\t///\t\t\t\t\tvalues: [18.1, 22.8, 23.9, 25.1, 25]\r\n\t\t///\t\t\t\t}\r\n\t\t///\t\t\t]\r\n\t\t/// \t}\r\n\t\t/// @author vtloc\r\n\t\t/// @date 2014Jan09\r\n\t\tslideObj.addChart = function ( data, renderType, callback, errorCallback ) {\r\n\t\t\tvar objNumber = gen_private.pages[pageNumber].data.length;\r\n\t\t\tGLOBAL_CHART_COUNT += 1;\r\n\t\t\t\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber] = {};\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].type = 'chart';\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].renderType = 'column';\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].title = data['title'];\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].data = data['data'];\r\n\t\t\tdata['renderType'] = renderType;\r\n\t\t\t\r\n\t\t\t// First, generate a temporatory excel file for storing the chart's data\r\n\t\t\tvar workbook = excelbuilder.createWorkbook('./', 'sample' + GLOBAL_CHART_COUNT + '.xlsx')\r\n\r\n\t\t\t// Create a new worksheet with 10 columns and 12 rows\r\n\t\t\t// number of columns: data['data'].length+1 -> equaly number of series\r\n\t\t\t// number of rows: data['data'][0].values.length+1 \r\n\t\t\tconsole.log(data);\r\n\t\t\t\r\n\t\t\tvar sheet1 = workbook.createSheet('Sheet1', data['data'].length+1, data['data'][0].values.length+1);\r\n\t\t\tvar headerrow = 1;\r\n\r\n\t\t\t// write header using serie name\r\n\t\t\tfor( var j=0; j < data['data'].length; j++ )\r\n\t\t\t{\r\n\t\t\t\tsheet1.set(j+2, headerrow, data['data'][j].name);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// write category column in the first column\r\n\t\t\tfor( var j=0; j < data['data'][0].labels.length; j++ )\r\n\t\t\t{\r\n\t\t\t\tsheet1.set(1, j+2, data['data'][0].labels[j]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// for each serie, write out values in its row\r\n\t\t\tfor (var i = 0; i < data['data'].length; i++)\r\n\t\t\t{\r\n\t\t\t\tfor( var j=0; j < data['data'][i].values.length; j++ )\r\n\t\t\t\t{\r\n\t\t\t\t\t// col i+2\r\n\t\t\t\t\t// row j+1\r\n\t\t\t\t\tsheet1.set(i+2, j+2, data['data'][i].values[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Fill some data\r\n\t\t\t// Save it\r\n\t\t\tvar localEmbeddingExcelFile = 'ppt\\\\embeddings\\\\Microsoft_Excel_Worksheet' + GLOBAL_CHART_COUNT + '.xlsx';\r\n\t\t\tvar tmpExcelFile = './sample'+GLOBAL_CHART_COUNT+'.xlsx';\r\n\t\t\t// will copy the tmpExcelFile into localEmbeddingExcelFile\r\n\t\t\tgen_private.plugs.intAddAnyResourceToParse ( localEmbeddingExcelFile, 'file', tmpExcelFile, cbMakeChartDataExcel, false, true );\r\n\t\t\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\charts\\\\chart'+GLOBAL_CHART_COUNT+'.xml', 'buffer', data, cbMakeCharts, true );\r\n\t\t\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\charts\\\\_rels\\\\chart'+GLOBAL_CHART_COUNT+'.xml.rels', 'buffer', [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package',\r\n\t\t\t\t\t\ttarget: '../embeddings/Microsoft_Excel_Worksheet'+GLOBAL_CHART_COUNT+'.xlsx'\r\n\t\t\t\t\t}\r\n\t\t\t\t], gen_private.plugs.type.msoffice.cbMakeRels, true );\r\n\t\t\tgen_private.type.msoffice.files_list.push (\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '/ppt/charts/chart'+GLOBAL_CHART_COUNT+'.xml',\r\n\t\t\t\t\ttype: 'application/vnd.openxmlformats-officedocument.drawingml.chart+xml',\r\n\t\t\t\t\tclear: 'type'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '/ppt/embeddings/Microsoft_Excel_Worksheet'+GLOBAL_CHART_COUNT+'.xlsx',\r\n\t\t\t\t\ttype: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n\t\t\t\t\text: 'xlsx',\r\n\t\t\t\t\tclear: 'type'\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\tgen_private.pages[pageNumber].rels.push (\r\n\t\t\t{\r\n\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart',\r\n\t\t\t\ttarget: '../charts/chart'+GLOBAL_CHART_COUNT+'.xml',\r\n\t\t\t\tclear: 'data'\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tworkbook.save(function(err){\r\n\t\t\t\tif (err) \r\n\t\t\t\t{\r\n\t\t\t\t  workbook.cancel();\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t  console.log(tmpExcelFile + ' generated');\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t\t///\r\n\t\t/// @brief Generate the column chart based on input data.\r\n\t\t///\r\n\t\t/// @param[in] data a JSON object with follow the following format\r\n\t\t///     { \t\r\n\t\t///\t\t\ttitle: 'eSurvey chart',\r\n\t\t///\t\t\tdata:  [\r\n\t\t///\t\t\t\t{\r\n\t\t///\t\t\t\t\tname: 'Income',\r\n\t\t///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n\t\t///\t\t\t\t\tvalues: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n\t\t///\t\t\t\t},\r\n\t\t///\t\t\t\t{\r\n\t\t///\t\t\t\t\tname: 'Expense',\r\n\t\t///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n\t\t///\t\t\t\t\tvalues: [18.1, 22.8, 23.9, 25.1, 25]\r\n\t\t///\t\t\t\t}\r\n\t\t///\t\t\t]\r\n\t\t/// \t}\r\n\t\t///\r\n\t\tslideObj.addColumnChart = function ( data, cb, errCb) {\r\n\t\t\tthis.addChart( data, 'column', cb, errCb );\r\n\t\t}\r\n\t\t\r\n\t\t///\r\n\t\t/// @brief Generate the pie chart based on input data.\r\n\t\t/// @author vtloc\r\n\t\t/// @date 2014Jan09\r\n\t\tslideObj.addPieChart = function ( data, cb, errCb) {\r\n\t\t\tthis.addChart( data, 'pie');\r\n\t\t}\r\n    \r\n\t\t///\r\n\t\t/// @brief Generate the bar chart based on input data.\r\n\t\t/// @author vtloc\r\n\t\t/// @date 2014Jan09\r\n\t\tslideObj.addBarChart = function ( data, cb, errCb) {\r\n\t\t\tthis.addChart( data, 'bar');\r\n\t\t}\r\n\t\t\r\n\t\tslideObj.addGroupBarChart = function (data, cb, errCb ) {\r\n\t\t\tthis.addChart( data, 'group-bar');\r\n\t\t}\r\n\t\t\r\n\t\t///\r\n\t\t/// @brief ???.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] text ???.\r\n\t\t/// @param[in] opt ???.\r\n\t\t/// @param[in] y_pos ???.\r\n\t\t/// @param[in] x_size ???.\r\n\t\t/// @param[in] y_size ???.\r\n\t\t/// @param[in] opt_b ???.\r\n\t\t///\r\n\t\tslideObj.addText = function ( text, opt, y_pos, x_size, y_size, opt_b ) {\r\n\t\t\tvar objNumber = gen_private.pages[pageNumber].data.length;\r\n\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber] = {};\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].type = 'text';\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].text = text;\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].options = typeof opt == 'object' ? opt : {};\r\n\r\n\t\t\tif ( typeof opt == 'string' ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.color = opt;\r\n\r\n\t\t\t} else if ( (typeof opt != 'object') && (typeof y_pos != 'undefined') ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.x = opt;\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.y = y_pos;\r\n\r\n\t\t\t\tif ( (typeof x_size != 'undefined') && (typeof y_size != 'undefined') ) {\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cx = x_size;\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cy = y_size;\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( typeof opt_b == 'object' ) {\r\n\t\t\t\tfor ( var attrname in opt_b ) { gen_private.pages[pageNumber].data[objNumber].options[attrname] = opt_b[attrname]; }\r\n\r\n\t\t\t} else if ( (typeof x_size == 'object') && (typeof y_size == 'undefined') ) {\r\n\t\t\t\tfor ( var attrname in x_size ) { gen_private.pages[pageNumber].data[objNumber].options[attrname] = x_size[attrname]; }\r\n\t\t\t} // Endif.\r\n\r\n\t\t\taddParagraphApiForBasicOpt ( gen_private.pages[pageNumber].data[objNumber] );\r\n\t\t\taddParagraphApiForEffects ( gen_private.pages[pageNumber].data[objNumber] );\r\n\t\t\treturn gen_private.pages[pageNumber].data[objNumber].api;\r\n\t\t};\r\n\r\n\t\t///\r\n\t\t/// @brief ???.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] shape ???.\r\n\t\t/// @param[in] opt ???.\r\n\t\t/// @param[in] y_pos ???.\r\n\t\t/// @param[in] x_size ???.\r\n\t\t/// @param[in] y_size ???.\r\n\t\t/// @param[in] opt_b ???.\r\n\t\t///\r\n\t\tslideObj.addShape = function ( shape, opt, y_pos, x_size, y_size, opt_b ) {\r\n\t\t\tvar objNumber = gen_private.pages[pageNumber].data.length;\r\n\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber] = {};\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].type = 'text';\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].options = typeof opt == 'object' ? opt : {};\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].options.shape = shape;\r\n\r\n\t\t\tif ( typeof opt == 'string' ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.color = opt;\r\n\r\n\t\t\t} else if ( (typeof opt != 'object') && (typeof y_pos != 'undefined') ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.x = opt;\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.y = y_pos;\r\n\r\n\t\t\t\tif ( (typeof x_size != 'undefined') && (typeof y_size != 'undefined') ) {\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cx = x_size;\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cy = y_size;\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( typeof opt_b == 'object' ) {\r\n\t\t\t\tfor ( var attrname in opt_b ) { gen_private.pages[pageNumber].data[objNumber].options[attrname] = opt_b[attrname]; }\r\n\r\n\t\t\t} else if ( (typeof x_size == 'object') && (typeof y_size == 'undefined') ) {\r\n\t\t\t\tfor ( var attrname in x_size ) { gen_private.pages[pageNumber].data[objNumber].options[attrname] = x_size[attrname]; }\r\n\t\t\t} // Endif.\r\n\r\n\t\t\taddParagraphApiForBasicOpt ( gen_private.pages[pageNumber].data[objNumber] );\r\n\t\t\taddParagraphApiForEffects ( gen_private.pages[pageNumber].data[objNumber] );\r\n\t\t\treturn gen_private.pages[pageNumber].data[objNumber].api;\r\n\t\t};\r\n\r\n\t\t///\r\n\t\t/// @brief ???.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] image_path ???.\r\n\t\t/// @param[in] opt ???.\r\n\t\t/// @param[in] y_pos ???.\r\n\t\t/// @param[in] x_size ???.\r\n\t\t/// @param[in] y_size ???.\r\n\t\t/// @param[in] image_format_type ???.\r\n\t\t///\r\n\t\tslideObj.addImage = function ( image_path, opt, y_pos, x_size, y_size, image_format_type ) {\r\n\t\t\tvar objNumber = gen_private.pages[pageNumber].data.length;\r\n\t\t\tvar image_type = (typeof image_format_type == 'string') ? image_format_type : 'png';\r\n\t\t\tvar defWidth, defHeight = 0;\r\n\r\n\t\t\tif ( typeof image_path == 'string' ) {\r\n\t\t\t\tvar ret_data = fast_image_size ( image_path );\r\n\t\t\t\tif ( ret_data.type == 'unknown' ) {\r\n\t\t\t\t\tvar image_ext = path.extname ( image_path );\r\n\r\n\t\t\t\t\tswitch ( image_ext ) {\r\n\t\t\t\t\t\tcase '.bmp':\r\n\t\t\t\t\t\t\timage_type = 'bmp';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '.gif':\r\n\t\t\t\t\t\t\timage_type = 'gif';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '.jpg':\r\n\t\t\t\t\t\tcase '.jpeg':\r\n\t\t\t\t\t\t\timage_type = 'jpeg';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '.emf':\r\n\t\t\t\t\t\t\timage_type = 'emf';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '.tiff':\r\n\t\t\t\t\t\t\timage_type = 'tiff';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} // End of switch.\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif ( ret_data.width ) {\r\n\t\t\t\t\t\tdefWidth = ret_data.width;\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( ret_data.height ) {\r\n\t\t\t\t\t\tdefHeight = ret_data.height;\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\timage_type = ret_data.type;\r\n\t\t\t\t\tif ( image_type == 'jpg' ) {\r\n\t\t\t\t\t\timage_type = 'jpeg';\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber] = {};\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].type = 'image';\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].image = image_path;\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].options = typeof opt == 'object' ? opt : {};\r\n\r\n\t\t\tif ( !gen_private.pages[pageNumber].data[objNumber].options.cx && defWidth ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cx = defWidth;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( !gen_private.pages[pageNumber].data[objNumber].options.cy && defHeight ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cy = defHeight;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tvar image_id = gen_private.type.msoffice.src_files_list.indexOf ( image_path );\r\n\t\t\tvar image_rel_id = -1;\r\n\r\n\t\t\tif ( image_id >= 0 ) {\r\n\t\t\t\tfor ( var j = 0, total_size_j = gen_private.pages[pageNumber].rels.length; j < total_size_j; j++ ) {\r\n\t\t\t\t\tif ( gen_private.pages[pageNumber].rels[j].target == ('../media/image' + (image_id + 1) + '.' + image_type) ) {\r\n\t\t\t\t\t\timage_rel_id = j + 1;\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // Endif.\r\n\t\t\t\r\n\t\t\t} else\r\n\t\t\t{\r\n\t\t\t\timage_id = gen_private.type.msoffice.src_files_list.length;\r\n\t\t\t\tgen_private.type.msoffice.src_files_list[image_id] = image_path;\r\n\t\t\t\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\media\\\\image' + (image_id + 1) + '.' + image_type, (typeof image_path == 'string') ? 'file' : 'stream', image_path, null, false );\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( image_rel_id == -1 ) {\r\n\t\t\t\timage_rel_id = gen_private.pages[pageNumber].rels.length + 1;\r\n\r\n\t\t\t\tgen_private.pages[pageNumber].rels.push (\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image',\r\n\t\t\t\t\t\ttarget: '../media/image' + (image_id + 1) + '.' + image_type,\r\n\t\t\t\t\t\tclear: 'data'\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].image_id = image_id;\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].rel_id = image_rel_id;\r\n\r\n\t\t\tif ( typeof opt == 'string' ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.color = opt;\r\n\r\n\t\t\t} else if ( (typeof opt != 'object') && (typeof y_pos != 'undefined') ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.x = opt;\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.y = y_pos;\r\n\r\n\t\t\t\tif ( (typeof x_size != 'undefined') && (typeof y_size != 'undefined') ) {\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cx = x_size;\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cy = y_size;\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\taddParagraphApiForBasicOpt ( gen_private.pages[pageNumber].data[objNumber] );\r\n\t\t\taddParagraphApiForEffects ( gen_private.pages[pageNumber].data[objNumber] );\r\n\t\t\treturn gen_private.pages[pageNumber].data[objNumber].api;\r\n\t\t};\r\n\r\n\t\t///\r\n\t\t/// @brief ???.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] text ???.\r\n\t\t/// @param[in] opt ???.\r\n\t\t/// @param[in] y_pos ???.\r\n\t\t/// @param[in] x_size ???.\r\n\t\t/// @param[in] y_size ???.\r\n\t\t/// @param[in] opt_b ???.\r\n\t\t///\r\n\t\tslideObj.addP = function ( text, opt, y_pos, x_size, y_size, opt_b ) {\r\n\t\t\tvar objNumber = gen_private.pages[pageNumber].data.length;\r\n\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber] = {};\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].type = 'p';\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].data = [];\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].options = typeof opt == 'object' ? opt : {};\r\n\r\n\t\t\tif ( typeof opt == 'string' ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.color = opt;\r\n\r\n\t\t\t} else if ( (typeof opt != 'object') && (typeof y_pos != 'undefined') ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.x = opt;\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.y = y_pos;\r\n\r\n\t\t\t\tif ( (typeof x_size != 'undefined') && (typeof y_size != 'undefined') ) {\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cx = x_size;\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cy = y_size;\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( typeof opt_b == 'object' ) {\r\n\t\t\t\tfor ( var attrname in opt_b ) { gen_private.pages[pageNumber].data[objNumber].options[attrname] = opt_b[attrname]; }\r\n\r\n\t\t\t} else if ( (typeof x_size == 'object') && (typeof y_size == 'undefined') ) {\r\n\t\t\t\tfor ( var attrname in x_size ) { gen_private.pages[pageNumber].data[objNumber].options[attrname] = x_size[attrname]; }\r\n\t\t\t} // Endif.\r\n\r\n\t\t\t// BMK_TODO:\r\n\r\n\t\t\treturn gen_private.pages[pageNumber].data[objNumber].data;\r\n\t\t};\r\n\r\n\t\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\slides\\\\slide' + (pageNumber + 1) + '.xml', 'buffer', gen_private.pages[pageNumber], cbMakePptxSlide, false );\r\n\t\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\slides\\\\_rels\\\\slide' + (pageNumber + 1) + '.xml.rels', 'buffer', gen_private.pages[pageNumber].rels, gen_private.plugs.type.msoffice.cbMakeRels, false );\t\t\r\n\t\treturn slideObj;\r\n\t};\r\n}\r\n\r\nvar pptxSchema = {};\r\n\r\nbaseobj.plugins.registerDocType ( 'pptx', makePptx, pptxSchema, baseobj.docType.PRESENTATION, \"Microsoft PowerPoint Document\" );\r\nbaseobj.plugins.registerDocType ( 'ppsx', makePptx, pptxSchema, baseobj.docType.PRESENTATION, \"Microsoft PowerPoint Slideshow Document\" );\r\n\r\n","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/lib/genofficechart.js":"/// @author vtloc\r\n/// @date 2014Jan09\r\n/// This module's purpose is to transform \r\n/// \r\nvar _ = require('underscore');\r\nvar xmlBuilder = require('xmlbuilder');\r\n\r\n///\r\n/// @brief Transform an array of string into an office's compliance structure\r\n///\r\n/// @param[in] region String\r\n///\t\tThe reference cell of the string, for example: $A$1\r\n/// @param[in] stringArr\r\n///\t\tAn array of string, for example: ['foo', 'bar']\r\n///\r\nfunction strRefFromString(region, stringArr) {\r\n\tvar obj = {\r\n\t\t'c:strRef': {\r\n\t\t\t'c:f' : region,\r\n\t\t\t'c:strCache': function() {\r\n\t\t\t\tvar result = {};\r\n\t\t\t\tresult['c:ptCount'] = { '@val' : stringArr.length };\r\n\t\t\t\tresult['#list'] = [];\r\n\t\t\t\tfor( var i=0; i<stringArr.length; i++ )\r\n\t\t\t\t{\r\n\t\t\t\t\tresult['#list'].push({'c:pt' : { '@idx':i, 'c:v': stringArr[i] }});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn obj;\r\n}\r\n\r\n///\r\n/// @brief Transform an array of string into an office's compliance structure\r\n///\r\n/// @param[in] region String\r\n///\t\tThe reference cell of the string, for example: $A$1\r\n/// @param[in] stringArr\r\n///\t\tAn array of numArr, for example: [4, 7, 8]\r\n/// @param[in] formatCode\r\n///\t\tA string describe the number's format. Example: General\r\n///\r\nfunction numRef(region, numArr, formatCode) {\r\n\tvar obj = {\r\n\t\t'c:numRef' : {\r\n\t\t\t'c:f' : region,\r\n\t\t\t'c:numCache' : {\r\n\t\t\t\t'c:formatCode' : formatCode,\r\n\t\t\t\t'c:ptCount' : {'@val': ''+numArr.length},\r\n\t\t\t\t'#list' : function() {\r\n\t\t\t\t\tresult= [];\r\n\t\t\t\t\tfor( var i=0; i<numArr.length; i++ )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tresult.push({'c:pt' : { '@idx':i, 'c:v': numArr[i].toString() }});\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t\r\n\treturn obj;\r\n}\r\n\r\n///\r\n/// @brief Transform an array of string into an office's compliance structure\r\n///\r\n/// @param[in] row int\r\n///\t\tRow index.\r\n/// @param[in] col int\r\n///\t\tCol index.\r\n/// @param[in] isRowAbsolute boolean\r\n///\t\tWill add $ into cell's address if this parameter is true.\r\n/// @param[in] isColAbsolute boolean\r\n///\t\tWill add $ into cell's address if this parameter is true.\r\n///\r\nfunction rowColToSheetAddress(row, col, isRowAbsolute, isColAbsolute) {\r\n\tvar address = \"\";\r\n\t\r\n\tif( isColAbsolute )\r\n\t\taddress += '$';\r\n\t\t\r\n\t// these lines of code will transform the number 1-26 into A->Z\r\n\t// used in excel's cell's coordination\r\n\twhile(col > 0 )\r\n\t{\r\n\t\tvar num = col % 26;\r\n\t\tcol = (col - num ) / 26;\r\n\t\taddress += String.fromCharCode(65+num-1);\r\n\t}\r\n\t\r\n\tif( isRowAbsolute )\r\n\t\taddress += '$';\r\n\t\t\r\n\taddress += row;\r\n\t\r\n\treturn address;\r\n}\r\n\r\n///\r\n/// @brief Transform a data object into column chart\r\n///\r\n/// @param[in] data object\r\n///\t\t{ \t\r\n///\t\t\ttitle: 'eSurvey chart',\r\n///\t\t\tdata:  [ // array of series\r\n///\t\t\t\t{\r\n///\t\t\t\t\tname: 'Income',\r\n///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n///\t\t\t\t\tvalues: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n///\t\t\t\t},\r\n///\t\t\t\t{\r\n///\t\t\t\t\tname: 'Expense',\r\n///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n///\t\t\t\t\tvalues: [18.1, 22.8, 23.9, 25.1, 25]\r\n///\t\t\t\t}\r\n///\t\t\t]\r\n/// \t}\r\n///\r\nfunction makeColumnChartStringFromData( data ) {\r\n\r\n\tvar series = [];\t\r\n\tvar rc2a = rowColToSheetAddress; // shortcut\r\n\t\r\n\tfor( var i=0; i< data['data'].length; i++ )\r\n\t{\r\n\t\tvar serie = data['data'][i];\r\n\t\tvar serieData = {\r\n\t\t\t'c:ser' : {\r\n\t\t\t\t'c:idx' : {'@val': i},\r\n\t\t\t\t'c:order' : {'@val': i},\r\n\t\t\t\t'c:tx' : strRefFromString('Sheet1!' + rc2a(1,2+i,true, true), [serie.name]), // serie's value\r\n\t\t\t\t 'c:invertIfNegative' : {'@val':'0'},\r\n\t\t\t\t 'c:cat' : strRefFromString('Sheet1!'+ rc2a(2,1,true, true) + ':' + rc2a(2+serie.labels.length-1,1,true, true), serie.labels),\r\n\t\t\t\t 'c:val' : numRef('Sheet1!'+rc2a(2,2+i,true, true) + ':' + rc2a(2+serie.labels.length-1,2+i,true, true), serie.values, \"General\")\r\n\t\t\t}\r\n\t\t};\r\n\t\tvar root = xmlBuilder.create(serieData, {headless: true});\r\n\t\r\n\t\tseries.push(root.end({ pretty: true, indent: '  ', newline: '\\n' }));\r\n\t}\r\n\t\r\n\tvar seriesString = \"\";\r\n\t\r\n\tfor( var i=0; i<data['data'].length; i++ )\r\n\t{\r\n\t\tseriesString += series[i] + '\\n';\r\n\t}\r\n\t\r\n\treturn '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\\r\n<c:chartSpace xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">\\\r\n<c:date1904 val=\"1\"/>\\\r\n<c:lang val=\"en-US\"/>\\\r\n<c:chart>\\\r\n    <c:plotArea>\\\r\n        <c:layout/>\\\r\n        <c:barChart>\\\r\n            <c:barDir val=\"col\"/>\\\r\n            <c:grouping val=\"clustered\"/>'\r\n            + seriesString + \r\n            '<c:axId val=\"45021824\"/>\\\r\n            <c:axId val=\"45291008\"/>\\\r\n        </c:barChart>\\\r\n        <c:catAx>\\\r\n            <c:axId val=\"45021824\"/>\\\r\n            <c:scaling>\\\r\n                <c:orientation val=\"minMax\"/>\\\r\n            </c:scaling>\\\r\n            <c:axPos val=\"b\"/>\\\r\n            <c:numFmt formatCode=\"General\" sourceLinked=\"1\"/>\\\r\n            <c:tickLblPos val=\"nextTo\"/>\\\r\n            <c:crossAx val=\"45291008\"/>\\\r\n            <c:crosses val=\"autoZero\"/>\\\r\n            <c:auto val=\"1\"/>\\\r\n            <c:lblAlgn val=\"ctr\"/>\\\r\n            <c:lblOffset val=\"100\"/>\\\r\n        </c:catAx>\\\r\n        <c:valAx>\\\r\n            <c:axId val=\"45291008\"/>\\\r\n            <c:scaling>\\\r\n                <c:orientation val=\"minMax\"/>\\\r\n            </c:scaling>\\\r\n            <c:axPos val=\"l\"/>\\\r\n            <c:majorGridlines/>\\\r\n            <c:numFmt formatCode=\"General\" sourceLinked=\"1\"/>\\\r\n            <c:tickLblPos val=\"nextTo\"/>\\\r\n            <c:crossAx val=\"45021824\"/>\\\r\n            <c:crosses val=\"autoZero\"/>\\\r\n            <c:crossBetween val=\"between\"/>\\\r\n        </c:valAx>\\\r\n    </c:plotArea>\\\r\n    <c:legend>\\\r\n        <c:legendPos val=\"r\"/>\\\r\n        <c:layout/>\\\r\n    </c:legend>\\\r\n    <c:plotVisOnly val=\"1\"/>\\\r\n</c:chart>\\\r\n<c:txPr>\\\r\n    <a:bodyPr/>\\\r\n    <a:lstStyle/>\\\r\n    <a:p>\\\r\n        <a:pPr>\\\r\n            <a:defRPr sz=\"1800\"/>\\\r\n        </a:pPr>\\\r\n        <a:endParaRPr lang=\"en-US\"/>\\\r\n    </a:p>\\\r\n</c:txPr>\\\r\n<c:externalData r:id=\"rId1\"/>\\\r\n</c:chartSpace>'\r\n}\r\n\r\n///\r\n/// @brief Transform a data object into pie chart\r\n///\r\n/// @param[in] data object\r\n///\t\t{ \t\r\n///\t\t\ttitle: 'eSurvey chart',\r\n///\t\t\tdata:  [ // array of series\r\n///\t\t\t\t{\r\n///\t\t\t\t\tname: 'Income',\r\n///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n///\t\t\t\t\tvalues: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n///\t\t\t\t}\r\n///\t\t\t]\r\n/// \t}\r\n///\r\nfunction makePieChartStringFromData( data ) {\r\n  var series = [];\t\r\n\tvar rc2a = rowColToSheetAddress; // shortcut\r\n\t\r\n\tfor( var i=0; i< data['data'].length; i++ )\r\n\t{\r\n\t\tvar serie = data['data'][i];\r\n\t\tvar serieData = {\r\n\t\t\t'c:ser' : {\r\n\t\t\t\t'c:idx' : {'@val': i},\r\n\t\t\t\t'c:order' : {'@val': i},\r\n\t\t\t\t'c:tx' : strRefFromString('Sheet1!' + rc2a(1,2+i,true, true), [serie.name]), // serie's value\r\n\t\t\t\t 'c:invertIfNegative' : {'@val':'0'},\r\n\t\t\t\t 'c:cat' : strRefFromString('Sheet1!'+ rc2a(2,1,true, true) + ':' + rc2a(2+serie.labels.length-1,1,true, true), serie.labels),\r\n\t\t\t\t 'c:val' : numRef('Sheet1!'+rc2a(2,2+i,true, true) + ':' + rc2a(2+serie.labels.length-1,2+i,true, true), serie.values, \"General\")\r\n\t\t\t}\r\n\t\t};\r\n\t\tvar root = xmlBuilder.create(serieData, {headless: true});\r\n\t\r\n\t\tseries.push(root.end({ pretty: true, indent: '  ', newline: '\\n' }));\r\n\t}\r\n\t\r\n\tvar seriesString = \"\";\r\n\t\r\n\tfor( var i=0; i<data['data'].length; i++ )\r\n\t{\r\n\t\tseriesString += series[i] + '\\n';\r\n\t}\r\n\t\r\n\treturn '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\\r\n<c:chartSpace xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">\\\r\n<c:lang val=\"en-US\"/>\\\r\n<c:chart>\\\r\n    <c:title>\\\r\n        <c:layout/>\\\r\n    </c:title>\\\r\n    <c:plotArea>\\\r\n        <c:layout/>\\\r\n        <c:pieChart>\\\r\n            <c:varyColors val=\"1\"/>'\r\n            + seriesString +\r\n            '<c:firstSliceAng val=\"0\"/>\\\r\n        </c:pieChart>\\\r\n    </c:plotArea>\\\r\n    <c:legend>\\\r\n        <c:legendPos val=\"r\"/>\\\r\n        <c:layout/>\\\r\n    </c:legend>\\\r\n    <c:plotVisOnly val=\"1\"/>\\\r\n</c:chart>\\\r\n<c:txPr>\\\r\n    <a:bodyPr/>\\\r\n    <a:lstStyle/>\\\r\n    <a:p>\\\r\n        <a:pPr>\\\r\n            <a:defRPr sz=\"1800\"/>\\\r\n        </a:pPr>\\\r\n        <a:endParaRPr lang=\"en-US\"/>\\\r\n    </a:p>\\\r\n</c:txPr>\\\r\n<c:externalData r:id=\"rId1\"/>\\\r\n</c:chartSpace>'\r\n}\r\n\r\n///\r\n/// @brief Transform a data object into pie chart\r\n///\r\n/// @param[in] data object\r\n///\t\t{ \t\r\n///\t\t\ttitle: 'eSurvey chart',\r\n///\t\t\tdata:  [ // array of series\r\n///\t\t\t\t{\r\n///\t\t\t\t\tname: 'Income',\r\n///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n///\t\t\t\t\tvalues: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n///\t\t\t\t}\r\n///\t\t\t]\r\n/// \t}\r\n///\r\nfunction makeGroupBarChartStringFromData( data ) {\r\n  var series = [];\t\r\n\tvar rc2a = rowColToSheetAddress; // shortcut\r\n\t\r\n\tfor( var i=0; i< data['data'].length; i++ )\r\n\t{\r\n\t\tvar serie = data['data'][i];\r\n\t\tvar serieData = {\r\n\t\t\t'c:ser' : {\r\n\t\t\t\t'c:idx' : {'@val': i},\r\n\t\t\t\t'c:order' : {'@val': i},\r\n\t\t\t\t'c:tx' : strRefFromString('Sheet1!' + rc2a(1,2+i,true, true), [serie.name]), // serie's value\r\n\t\t\t\t 'c:invertIfNegative' : {'@val':'0'},\r\n\t\t\t\t 'c:cat' : strRefFromString('Sheet1!'+ rc2a(2,1,true, true) + ':' + rc2a(2+serie.labels.length-1,1,true, true), serie.labels),\r\n\t\t\t\t 'c:val' : numRef('Sheet1!'+rc2a(2,2+i,true, true) + ':' + rc2a(2+serie.labels.length-1,2+i,true, true), serie.values, \"General\")\r\n\t\t\t}\r\n\t\t};\r\n\t\tvar root = xmlBuilder.create(serieData, {headless: true});\r\n\t\r\n\t\tseries.push(root.end({ pretty: true, indent: '  ', newline: '\\n' }));\r\n\t}\r\n\t\r\n\tvar seriesString = \"\";\r\n\t\r\n\tfor( var i=0; i<data['data'].length; i++ )\r\n\t{\r\n\t\tseriesString += series[i] + '\\n';\r\n\t}\r\n  \r\n  return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\\r\n<c:chartSpace xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">\\\r\n<c:lang val=\"en-US\"/>\\\r\n<c:chart>\\\r\n    <c:plotArea>\\\r\n        <c:layout/>\\\r\n        <c:barChart>\\\r\n            <c:barDir val=\"bar\"/>\\\r\n            <c:grouping val=\"percentStacked\"/>'\r\n            + seriesString +\r\n            '<c:overlap val=\"100\"/>\\\r\n            <c:axId val=\"65025536\"/>\\\r\n            <c:axId val=\"65037824\"/>\\\r\n        </c:barChart>\\\r\n        <c:catAx>\\\r\n            <c:axId val=\"65025536\"/>\\\r\n            <c:scaling>\\\r\n                <c:orientation val=\"minMax\"/>\\\r\n            </c:scaling>\\\r\n            <c:axPos val=\"l\"/>\\\r\n            <c:tickLblPos val=\"nextTo\"/>\\\r\n            <c:crossAx val=\"65037824\"/>\\\r\n            <c:crosses val=\"autoZero\"/>\\\r\n            <c:auto val=\"1\"/>\\\r\n            <c:lblAlgn val=\"ctr\"/>\\\r\n            <c:lblOffset val=\"100\"/>\\\r\n        </c:catAx>\\\r\n        <c:valAx>\\\r\n            <c:axId val=\"65037824\"/>\\\r\n            <c:scaling>\\\r\n                <c:orientation val=\"minMax\"/>\\\r\n            </c:scaling>\\\r\n            <c:axPos val=\"b\"/>\\\r\n            <c:majorGridlines/>\\\r\n            <c:numFmt formatCode=\"0%\" sourceLinked=\"1\"/>\\\r\n            <c:tickLblPos val=\"nextTo\"/>\\\r\n            <c:crossAx val=\"65025536\"/>\\\r\n            <c:crosses val=\"autoZero\"/>\\\r\n            <c:crossBetween val=\"between\"/>\\\r\n        </c:valAx>\\\r\n    </c:plotArea>\\\r\n    <c:legend>\\\r\n        <c:legendPos val=\"r\"/>\\\r\n        <c:layout/>\\\r\n    </c:legend>\\\r\n    <c:plotVisOnly val=\"1\"/>\\\r\n</c:chart>\\\r\n<c:txPr>\\\r\n    <a:bodyPr/>\\\r\n    <a:lstStyle/>\\\r\n    <a:p>\\\r\n        <a:pPr>\\\r\n            <a:defRPr sz=\"1800\"/>\\\r\n        </a:pPr>\\\r\n        <a:endParaRPr lang=\"en-US\"/>\\\r\n    </a:p>\\\r\n</c:txPr>\\\r\n<c:externalData r:id=\"rId1\"/>\\\r\n</c:chartSpace>';\r\n}\r\n\r\n\r\n///\r\n/// @brief Transform a data object into pie chart\r\n///\r\n/// @param[in] data object\r\n///\t\t{ \t\r\n///\t\t\ttitle: 'eSurvey chart',\r\n///\t\t\tdata:  [ // array of series\r\n///\t\t\t\t{\r\n///\t\t\t\t\tname: 'Income',\r\n///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n///\t\t\t\t\tvalues: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n///\t\t\t\t}\r\n///\t\t\t]\r\n/// \t}\r\n///\r\nfunction makeBarChartStringFromData( data ) {\r\n  var series = [];\t\r\n\tvar rc2a = rowColToSheetAddress; // shortcut\r\n\t\r\n\tfor( var i=0; i< data['data'].length; i++ )\r\n\t{\r\n\t\tvar serie = data['data'][i];\r\n\t\tvar serieData = {\r\n\t\t\t'c:ser' : {\r\n\t\t\t\t'c:idx' : {'@val': i},\r\n\t\t\t\t'c:order' : {'@val': i},\r\n\t\t\t\t'c:tx' : strRefFromString('Sheet1!' + rc2a(1,2+i,true, true), [serie.name]), // serie's value\r\n\t\t\t\t 'c:invertIfNegative' : {'@val':'0'},\r\n\t\t\t\t 'c:cat' : strRefFromString('Sheet1!'+ rc2a(2,1,true, true) + ':' + rc2a(2+serie.labels.length-1,1,true, true), serie.labels),\r\n\t\t\t\t 'c:val' : numRef('Sheet1!'+rc2a(2,2+i,true, true) + ':' + rc2a(2+serie.labels.length-1,2+i,true, true), serie.values, \"General\")\r\n\t\t\t}\r\n\t\t};\r\n\t\tvar root = xmlBuilder.create(serieData, {headless: true});\r\n\t\r\n\t\tseries.push(root.end({ pretty: true, indent: '  ', newline: '\\n' }));\r\n\t}\r\n\t\r\n\tvar seriesString = \"\";\r\n\t\r\n\tfor( var i=0; i<data['data'].length; i++ )\r\n\t{\r\n\t\tseriesString += series[i] + '\\n';\r\n\t}\r\n  \r\n  return '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\\r\n<c:chartSpace xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">\\\r\n<c:lang val=\"en-US\"/>\\\r\n<c:chart>\\\r\n    <c:plotArea>\\\r\n        <c:layout/>\\\r\n        <c:barChart>\\\r\n            <c:barDir val=\"bar\"/>\\\r\n            <c:grouping val=\"clustered\"/>'\r\n            + seriesString +\r\n            '<c:axId val=\"64451712\"/>\\\r\n            <c:axId val=\"64453248\"/>\\\r\n        </c:barChart>\\\r\n        <c:catAx>\\\r\n            <c:axId val=\"64451712\"/>\\\r\n            <c:scaling>\\\r\n                <c:orientation val=\"minMax\"/>\\\r\n            </c:scaling>\\\r\n            <c:axPos val=\"l\"/>\\\r\n            <c:tickLblPos val=\"nextTo\"/>\\\r\n            <c:crossAx val=\"64453248\"/>\\\r\n            <c:crosses val=\"autoZero\"/>\\\r\n            <c:auto val=\"1\"/>\\\r\n            <c:lblAlgn val=\"ctr\"/>\\\r\n            <c:lblOffset val=\"100\"/>\\\r\n        </c:catAx>\\\r\n        <c:valAx>\\\r\n            <c:axId val=\"64453248\"/>\\\r\n            <c:scaling>\\\r\n                <c:orientation val=\"minMax\"/>\\\r\n            </c:scaling>\\\r\n            <c:axPos val=\"b\"/>\\\r\n            <c:majorGridlines/>\\\r\n            <c:numFmt formatCode=\"General\" sourceLinked=\"1\"/>\\\r\n            <c:tickLblPos val=\"nextTo\"/>\\\r\n            <c:crossAx val=\"64451712\"/>\\\r\n            <c:crosses val=\"autoZero\"/>\\\r\n            <c:crossBetween val=\"between\"/>\\\r\n        </c:valAx>\\\r\n    </c:plotArea>\\\r\n    <c:legend>\\\r\n        <c:legendPos val=\"r\"/>\\\r\n        <c:layout/>\\\r\n    </c:legend>\\\r\n    <c:plotVisOnly val=\"1\"/>\\\r\n</c:chart>\\\r\n<c:txPr>\\\r\n    <a:bodyPr/>\\\r\n    <a:lstStyle/>\\\r\n    <a:p>\\\r\n        <a:pPr>\\\r\n            <a:defRPr sz=\"1800\"/>\\\r\n        </a:pPr>\\\r\n        <a:endParaRPr lang=\"en-US\"/>\\\r\n    </a:p>\\\r\n</c:txPr>\\\r\n<c:externalData r:id=\"rId1\"/>\\\r\n</c:chartSpace>';\r\n}\r\n\r\n\r\nexports.makePieChartStringFromData = makePieChartStringFromData;\r\nexports.makeColumnChartStringFromData = makeColumnChartStringFromData;\r\nexports.makeBarChartStringFromData = makeBarChartStringFromData;\r\nexports.makeGroupBarChartStringFromData = makeGroupBarChartStringFromData;","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/lib/msofficegen.js":"//\r\n// officegen: basic Microsoft Office common code\r\n//\r\n// Please refer to README.md for this module's documentations.\r\n//\r\n// NOTE:\r\n// - Before changing this code please refer to the hacking the code section on README.md.\r\n//\r\n// Copyright (c) 2013 Ziv Barber;\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files (the\r\n// 'Software'), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\r\n// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\r\n// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\n\r\nvar baseobj = require(\"./basicgen.js\");\r\n\r\nif ( !String.prototype.encodeHTML ) {\r\n\tString.prototype.encodeHTML = function () {\r\n\t\treturn this.replace(/&/g, '&amp;')\r\n\t\t\t.replace(/</g, '&lt;')\r\n\t\t\t.replace(/>/g, '&gt;')\r\n\t\t\t.replace(/\"/g, '&quot;');\r\n\t};\r\n}\r\n\r\n///\r\n/// @brief Extend officegen object with MS-Office support.\r\n///\r\n/// This method extending the given officegen object with the common MS-Office code.\r\n///\r\n/// @param[in] genobj The object to extend.\r\n/// @param[in] new_type The type of object to create.\r\n/// @param[in] options The object's options.\r\n/// @param[in] gen_private Access to the internals of this object.\r\n/// @param[in] type_info Additional information about this type.\r\n///\r\nfunction makemsdoc ( genobj, new_type, options, gen_private, type_info ) {\r\n\t///\r\n\t/// @brief Generate string of the current date and time.\r\n\t///\r\n\t/// This method generating a string with the current date and time in Office XML format.\r\n\t///\r\n\t/// @return String of the current date and time in Office XML format.\r\n\t///\r\n\tfunction getCurDateTimeForOffice () {\r\n\t\tvar date = new Date ();\r\n\r\n\t\tvar year = date.getFullYear ();\r\n\t\tvar month = date.getMonth () + 1;\r\n\t\tvar day = date.getDate ();\r\n\t\tvar hour = date.getHours ();\r\n\t\tvar min = date.getMinutes ();\r\n\t\tvar sec = date.getSeconds ();\r\n\r\n\t\tmonth = (month < 10 ? \"0\" : \"\") + month;\r\n\t\tday = (day < 10 ? \"0\" : \"\") + day;\r\n\t\thour = (hour < 10 ? \"0\" : \"\") + hour;\r\n\t\tmin = (min < 10 ? \"0\" : \"\") + min;\r\n\t\tsec = (sec < 10 ? \"0\" : \"\") + sec;\r\n\r\n\t\treturn year + \"-\" + month + \"-\" + day + \"T\" + hour + \":\" + min + \":\" + sec + 'Z';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Compact the given array.\r\n\t///\r\n\t/// This function compacting the given array.\r\n\t///\r\n\t/// @param[in] arr The array to compact.\r\n\t///\r\n\tfunction compactArray ( arr ) {\r\n\t\tvar len = arr.length, i;\r\n\r\n\t\tfor ( i = 0; i < len; i++ )\r\n\t\t\tarr[i] && arr.push ( arr[i] );  // Copy non-empty values to the end of the array.\r\n\r\n\t\tarr.splice ( 0 , len ); // Cut the array and leave only the non-empty values.\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the main files list resource.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeMainFilesList ( data ) {\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data );\r\n\t\toutString += '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">';\r\n\r\n\t\tfor ( var i = 0, total_size = gen_private.type.msoffice.files_list.length; i < total_size; i++ ) {\r\n\t\t\tif ( typeof gen_private.type.msoffice.files_list[i] != 'undefined' ) {\r\n\t\t\t\tif ( gen_private.type.msoffice.files_list[i].ext )\r\n\t\t\t\t{\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Fixed by @author:vtloc @date:2014Jan09\r\n\t\t\t\t\t// Reason: if we write out duplicate extension, office will raise error\r\n\t\t\t\t\t//\r\n\t\t\t\t\tif( outString.indexOf('<Default Extension=\"'+gen_private.type.msoffice.files_list[i].ext) == -1 )\r\n\t\t\t\t\t{ // check to make sure we don't write duplicate extension tag\r\n\t\t\t\t\t\toutString += '<Default Extension=\"' + gen_private.type.msoffice.files_list[i].ext + '\" ContentType=\"' + gen_private.type.msoffice.files_list[i].type + '\"/>';\r\n\t\t\t\t\t}\r\n\t\t\t\t} else\r\n\t\t\t\t{\r\n\t\t\t\t\toutString += '<Override PartName=\"' + gen_private.type.msoffice.files_list[i].name + '\" ContentType=\"' + gen_private.type.msoffice.files_list[i].type + '\"/>';\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '</Types>\\n';\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeTheme ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"1F497D\"/></a:dk2><a:lt2><a:srgbClr val=\"EEECE1\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Angsana New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Cordia New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:shade val=\"51000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"80000\"><a:schemeClr val=\"phClr\"><a:shade val=\"93000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"94000\"/><a:satMod val=\"135000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeCore ( data ) {\r\n\t\tvar curDateTime = getCurDateTimeForOffice ();\r\n\t\tvar userName = genobj.options.creator ? genobj.options.creator : 'officegen';\r\n\t\tvar extraFields = '';\r\n\r\n\t\t// Work on all the properties:\r\n\t\tfor ( infoRec in genobj.info ) {\r\n\t\t\tif ( genobj.info[infoRec] && genobj.info[infoRec].element && genobj.info[infoRec].data ) {\r\n\t\t\t\textraFields += '<' + genobj.info[infoRec].element + '>' + genobj.info[infoRec].data.encodeHTML () + '</' + genobj.info[infoRec].element + '>';\r\n\t\t\t} // Endif.\r\n\t\t} // End of for loop.\r\n\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">' + extraFields + '<dc:creator>' + userName + '</dc:creator><cp:lastModifiedBy>' + userName + '</cp:lastModifiedBy><cp:revision>1</cp:revision><dcterms:created xsi:type=\"dcterms:W3CDTF\">' + curDateTime + '</dcterms:created><dcterms:modified xsi:type=\"dcterms:W3CDTF\">' + curDateTime + '</dcterms:modified></cp:coreProperties>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Remove selected records from the given array.\r\n\t///\r\n\t/// This method destroys records inside the given array of the given type.\r\n\t///\r\n\t/// @param[in] arr The array to work on it.\r\n\t/// @param[in] type_to_clear The type of records to clear.\r\n\t///\r\n\tfunction clearSmartArrayFromType ( arr, type_to_clear ) {\r\n\t\tvar is_need_compact = false;\r\n\r\n\t\tfor ( var i = 0, total_size = arr.length; i < total_size; i++ ) {\r\n\t\t\tif ( typeof arr[i] != 'undefined' ) {\r\n\t\t\t\tif ( arr[i].clear && (arr[i].clear == type_to_clear) ) {\r\n\t\t\t\t\tdelete arr[i];\r\n\t\t\t\t\tis_need_compact = true;\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\t\t} // End of for loop.\r\n\r\n\t\tif ( is_need_compact ) {\r\n\t\t\tcompactArray ( arr );\r\n\t\t} // Endif.\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Clean after finishing to generate the document.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] err Generation error message (if there were any).\r\n\t/// @param[in] written Number of bytes been created.\r\n\t///\r\n\tfunction cbOfficeClearAfterGenerate ( err, written ) {\r\n\t\tclearSmartArrayFromType ( gen_private.type.msoffice.rels_main, 'generate' );\r\n\t\tclearSmartArrayFromType ( gen_private.type.msoffice.rels_app, 'generate' );\r\n\t\tclearSmartArrayFromType ( gen_private.type.msoffice.files_list, 'generate' );\r\n\t};\r\n\r\n\t///\r\n\t/// @brief Clear all the information of the current document.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\tfunction cbOfficeClearDocData () {\r\n\t\tclearSmartArrayFromType ( gen_private.type.msoffice.rels_main, 'data' );\r\n\t\tclearSmartArrayFromType ( gen_private.type.msoffice.rels_app, 'data' );\r\n\t\tclearSmartArrayFromType ( gen_private.type.msoffice.files_list, 'data' );\r\n\r\n\t\tfor ( infoItem in genobj.info ) {\r\n\t\t\tgenobj.info[infoItem].data = genobj.info[infoItem].def_data;\r\n\t\t} // Endif.\r\n\r\n\t\tgen_private.type.msoffice.src_files_list = [];\r\n\t};\r\n\r\n\t// Basic API for plugins:\r\n\r\n\tgen_private.plugs.type.msoffice = {};\r\n\r\n\t///\r\n\t/// @brief Configure a new Office property type.\r\n\t///\r\n\t/// This method register a new type of property that the user can configure. This property must be \r\n\t/// a valid MS-Office property as you can configure on the \"files/properties\" menu option on MS-Office.\r\n\t///\r\n\t/// @param[in] element_name The name of the XML element of this type.\r\n\t/// @param[in] def_data Default value of this type.\r\n\t/// @param[in] prop_name The name of the options property to configure this type.\r\n\t/// @param[in] user_access_func_name The name of the function to create to configure this type.\r\n\t///\r\n\tgen_private.plugs.type.msoffice.addInfoType = function ( element_name, def_data, prop_name, user_access_func_name ) {\r\n\t\tgenobj.info[element_name] = {};\r\n\t\tgenobj.info[element_name].element = element_name;\r\n\t\tgenobj.info[element_name].data = def_data;\r\n\t\tgenobj.info[element_name].def_data = def_data;\r\n\r\n\t\t// The user of officegen can configure this property using the options object:\r\n\t\tif ( genobj.options.prop_name )\r\n\t\t{\r\n\t\t\tgenobj.info[element_name].data = genobj.options.prop_name;\r\n\t\t} // Endif.\r\n\r\n\t\tgenobj[user_access_func_name] = function ( new_data ) {\r\n\t\t\tgenobj.info[element_name].data = new_data;\r\n\t\t};\r\n\t};\r\n\r\n\t///\r\n\t/// @brief Get the string that opening every Office XML type.\r\n\t///\r\n\t/// Every Microsoft Office XML resource will have this header at the begining of the file.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tgen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml = function ( data ) {\r\n\t\treturn '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\n';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Generate rel based XML file.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Array filled with all the rels links.\r\n\t/// @return Text string.\r\n\t///\r\n\tgen_private.plugs.type.msoffice.cbMakeRels = function ( data ) {\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data );\r\n\t\toutString += '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">';\r\n\r\n\t\t// Add all the rels records inside the data array:\r\n\t\tvar realRel = 1;\r\n\t\tfor ( var i = 0, total_size = data.length; i < total_size; i++ ) {\r\n\t\t\tif ( typeof data[i] != 'undefined' ) {\r\n\t\t\t\toutString += '<Relationship Id=\"rId' + realRel + '\" Type=\"' + data[i].type + '\" Target=\"' + data[i].target + '\"/>';\r\n\t\t\t\trealRel++;\r\n\t\t\t} // Endif.\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '</Relationships>\\n';\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Prepare the officegen object to MS-Office documents.\r\n\t///\r\n\t/// Every plugin that implementing gemenrating MS-Office document must call this method to initialize \r\n\t/// the common stuff.\r\n\t///\r\n\t/// @param[in] main_path The name of the main folder holding the common resources of this type.\r\n\t/// @param[in] main_file The main resource file name of this type.\r\n\t/// @param[in] ext_opt Optional settings (unused right now).\r\n\t///\r\n\tgen_private.plugs.type.msoffice.makeOfficeGenerator = function ( main_path, main_file, ext_opt ) {\r\n\t\tgen_private.features.type.msoffice = {};\r\n\t\tgen_private.features.type.msoffice.main_path = main_path;\r\n\t\tgen_private.features.type.msoffice.main_path_file = main_file;\r\n\t\tgen_private.type.msoffice = {};\r\n\t\tgen_private.type.msoffice.rels_main = [];\r\n\t\tgen_private.type.msoffice.rels_app = [];\r\n\t\tgen_private.type.msoffice.files_list = [];\r\n\t\tgen_private.type.msoffice.src_files_list = [];\r\n\r\n\t\t// Holding all the Office properties:\r\n\t\tgenobj.info = {};\r\n\r\n\t\tgenobj.on ( 'afterGen', cbOfficeClearAfterGenerate );\r\n\t\tgenobj.on ( 'clearDoc', cbOfficeClearDocData );\r\n\r\n\t\tgen_private.type.msoffice.rels_main.push (\r\n\t\t\t{\r\n\t\t\t\ttarget: 'docProps/app.xml',\r\n\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties',\r\n\t\t\t\tclear: 'type'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttarget: 'docProps/core.xml',\r\n\t\t\t\ttype: 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties',\r\n\t\t\t\tclear: 'type'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\ttarget: gen_private.features.type.msoffice.main_path + '/' + gen_private.features.type.msoffice.main_path_file + '.xml',\r\n\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument',\r\n\t\t\t\tclear: 'type'\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tgen_private.type.msoffice.files_list.push (\r\n\t\t\t{\r\n\t\t\t\text: 'rels',\r\n\t\t\t\ttype: 'application/vnd.openxmlformats-package.relationships+xml',\r\n\t\t\t\tclear: 'type'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\text: 'xml',\r\n\t\t\t\ttype: 'application/xml',\r\n\t\t\t\tclear: 'type'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\text: 'jpeg',\r\n\t\t\t\ttype: 'image/jpeg',\r\n\t\t\t\tclear: 'type'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\text: 'png',\r\n\t\t\t\ttype: 'image/png',\r\n\t\t\t\tclear: 'type'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: '/docProps/app.xml',\r\n\t\t\t\ttype: 'application/vnd.openxmlformats-officedocument.extended-properties+xml',\r\n\t\t\t\tclear: 'type'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: '/' + gen_private.features.type.msoffice.main_path + '/theme/theme1.xml',\r\n\t\t\t\ttype: 'application/vnd.openxmlformats-officedocument.theme+xml',\r\n\t\t\t\tclear: 'type'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: '/docProps/core.xml',\r\n\t\t\t\ttype: 'application/vnd.openxmlformats-package.core-properties+xml',\r\n\t\t\t\tclear: 'type'\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tgen_private.plugs.intAddAnyResourceToParse ( '_rels\\\\.rels', 'buffer', gen_private.type.msoffice.rels_main, gen_private.plugs.type.msoffice.cbMakeRels, true );\r\n\t\tgen_private.plugs.intAddAnyResourceToParse ( '[Content_Types].xml', 'buffer', null, cbMakeMainFilesList, true );\r\n\t\tgen_private.plugs.intAddAnyResourceToParse ( 'docProps\\\\core.xml', 'buffer', null, cbMakeCore, true );\r\n\t\tgen_private.plugs.intAddAnyResourceToParse ( gen_private.features.type.msoffice.main_path + '\\\\theme\\\\theme1.xml', 'buffer', null, cbMakeTheme, true );\r\n\t};\r\n};\r\n\r\nbaseobj.plugins.registerPrototype ( 'msoffice', makemsdoc, 'Microsoft Office Document Prototype' );\r\n\r\nexports.makemsdoc = makemsdoc;\r\n\r\n","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/lib/pptxshapes.js":"//\r\n// officegen: List of PPTX shapes.\r\n//\r\n// Please refer to README.md for this module's documentations.\r\n//\r\n// NOTE:\r\n// - Before changing this code please refer to the hacking the code section on README.md.\r\n//\r\n// Copyright {c} 2013;\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files {the\r\n// 'Software'}, to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED 'AS IS': WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\r\n// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\r\n// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\n\r\nmodule.exports = {\r\n\tACTION_BUTTON_BACK_OR_PREVIOUS: {\r\n\t\t'displayName': 'Action Button: Back or Previous',\r\n\t\t'name': 'actionButtonBackPrevious',\r\n\t\t'avLst': {}\r\n\t},\r\n\tACTION_BUTTON_BEGINNING: {\r\n\t\t'displayName': 'Action Button: Beginning',\r\n\t\t'name': 'actionButtonBeginning',\r\n\t\t'avLst': {}\r\n\t},\r\n\tACTION_BUTTON_CUSTOM: {\r\n\t\t'displayName': 'Action Button: Custom',\r\n\t\t'name': 'actionButtonBlank',\r\n\t\t'avLst': {}\r\n\t},\r\n\tACTION_BUTTON_DOCUMENT: {\r\n\t\t'displayName': 'Action Button: Document',\r\n\t\t'name': 'actionButtonDocument',\r\n\t\t'avLst': {}\r\n\t},\r\n\tACTION_BUTTON_END: {\r\n\t\t'displayName': 'Action Button: End',\r\n\t\t'name': 'actionButtonEnd',\r\n\t\t'avLst': {}\r\n\t},\r\n\tACTION_BUTTON_FORWARD_OR_NEXT: {\r\n\t\t'displayName': 'Action Button: Forward or Next',\r\n\t\t'name': 'actionButtonForwardNext',\r\n\t\t'avLst': {}\r\n\t},\r\n\tACTION_BUTTON_HELP: {\r\n\t\t'displayName': 'Action Button: Help',\r\n\t\t'name': 'actionButtonHelp',\r\n\t\t'avLst': {}\r\n\t},\r\n\tACTION_BUTTON_HOME: {\r\n\t\t'displayName': 'Action Button: Home',\r\n\t\t'name': 'actionButtonHome',\r\n\t\t'avLst': {}\r\n\t},\r\n\tACTION_BUTTON_INFORMATION: {\r\n\t\t'displayName': 'Action Button: Information',\r\n\t\t'name': 'actionButtonInformation',\r\n\t\t'avLst': {}\r\n\t},\r\n\tACTION_BUTTON_MOVIE: {\r\n\t\t'displayName': 'Action Button: Movie',\r\n\t\t'name': 'actionButtonMovie',\r\n\t\t'avLst': {}\r\n\t},\r\n\tACTION_BUTTON_RETURN: {\r\n\t\t'displayName': 'Action Button: Return',\r\n\t\t'name': 'actionButtonReturn',\r\n\t\t'avLst': {}\r\n\t},\r\n\tACTION_BUTTON_SOUND: {\r\n\t\t'displayName': 'Action Button: Sound',\r\n\t\t'name': 'actionButtonSound',\r\n\t\t'avLst': {}\r\n\t},\r\n\tARC: {\r\n\t\t'displayName': 'Arc',\r\n\t\t'name': 'arc',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 16200000,\r\n\t\t\t'adj2': 0\r\n\t\t}\r\n\t},\r\n\tBALLOON: {\r\n\t\t'displayName': 'Rounded Rectangular Callout',\r\n\t\t'name': 'wedgeRoundRectCallout',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': -20833,\r\n\t\t\t'adj2': 62500,\r\n\t\t\t'adj3': 16667\r\n\t\t}\r\n\t},\r\n\tBENT_ARROW: {\r\n\t\t'displayName': 'Bent Arrow',\r\n\t\t'name': 'bentArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 25000,\r\n\t\t\t'adj3': 25000,\r\n\t\t\t'adj4': 43750\r\n\t\t}\r\n\t},\r\n\tBENT_UP_ARROW: {\r\n\t\t'displayName': 'Bent-Up Arrow',\r\n\t\t'name': 'bentUpArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 25000,\r\n\t\t\t'adj3': 25000\r\n\t\t}\r\n\t},\r\n\tBEVEL: {\r\n\t\t'displayName': 'Bevel',\r\n\t\t'name': 'bevel',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 12500\r\n\t\t}\r\n\t},\r\n\tBLOCK_ARC: {\r\n\t\t'displayName': 'Block Arc',\r\n\t\t'name': 'blockArc',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 10800000,\r\n\t\t\t'adj2': 0,\r\n\t\t\t'adj3': 25000\r\n\t\t}\r\n\t},\r\n\tCAN: {\r\n\t\t'displayName': 'Can',\r\n\t\t'name': 'can',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 25000\r\n\t\t}\r\n\t},\r\n\tCHART_PLUS: {\r\n\t\t'displayName': 'Chart Plus',\r\n\t\t'name': 'chartPlus',\r\n\t\t'avLst': {}\r\n\t},\r\n\tCHART_STAR: {\r\n\t\t'displayName': 'Chart Star',\r\n\t\t'name': 'chartStar',\r\n\t\t'avLst': {}\r\n\t},\r\n\tCHART_X: {\r\n\t\t'displayName': 'Chart X',\r\n\t\t'name': 'chartX',\r\n\t\t'avLst': {}\r\n\t},\r\n\tCHEVRON: {\r\n\t\t'displayName': 'Chevron',\r\n\t\t'name': 'chevron',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 50000\r\n\t\t}\r\n\t},\r\n\tCHORD: {\r\n\t\t'displayName': 'Chord',\r\n\t\t'name': 'chord',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 2700000,\r\n\t\t\t'adj2': 16200000\r\n\t\t}\r\n\t},\r\n\tCIRCULAR_ARROW: {\r\n\t\t'displayName': 'Circular Arrow',\r\n\t\t'name': 'circularArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 12500,\r\n\t\t\t'adj2': 1142319,\r\n\t\t\t'adj3': 20457681,\r\n\t\t\t'adj4': 10800000,\r\n\t\t\t'adj5': 12500\r\n\t\t}\r\n\t},\r\n\tCLOUD: {\r\n\t\t'displayName': 'Cloud',\r\n\t\t'name': 'cloud',\r\n\t\t'avLst': {}\r\n\t},\r\n\tCLOUD_CALLOUT: {\r\n\t\t'displayName': 'Cloud Callout',\r\n\t\t'name': 'cloudCallout',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': -20833,\r\n\t\t\t'adj2': 62500\r\n\t\t}\r\n\t},\r\n\tCORNER: {\r\n\t\t'displayName': 'Corner',\r\n\t\t'name': 'corner',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 50000,\r\n\t\t\t'adj2': 50000\r\n\t\t}\r\n\t},\r\n\tCORNER_TABS: {\r\n\t\t'displayName': 'Corner Tabs',\r\n\t\t'name': 'cornerTabs',\r\n\t\t'avLst': {}\r\n\t},\r\n\tCROSS: {\r\n\t\t'displayName': 'Cross',\r\n\t\t'name': 'plus',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 25000\r\n\t\t}\r\n\t},\r\n\tCUBE: {\r\n\t\t'displayName': 'Cube',\r\n\t\t'name': 'cube',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 25000\r\n\t\t}\r\n\t},\r\n\tCURVED_DOWN_ARROW: {\r\n\t\t'displayName': 'Curved Down Arrow',\r\n\t\t'name': 'curvedDownArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 50000,\r\n\t\t\t'adj3': 25000\r\n\t\t}\r\n\t},\r\n\tCURVED_DOWN_RIBBON: {\r\n\t\t'displayName': 'Curved Down Ribbon',\r\n\t\t'name': 'ellipseRibbon',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 50000,\r\n\t\t\t'adj3': 12500\r\n\t\t}\r\n\t},\r\n\tCURVED_LEFT_ARROW: {\r\n\t\t'displayName': 'Curved Left Arrow',\r\n\t\t'name': 'curvedLeftArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 50000,\r\n\t\t\t'adj3': 25000\r\n\t\t}\r\n\t},\r\n\tCURVED_RIGHT_ARROW: {\r\n\t\t'displayName': 'Curved Right Arrow',\r\n\t\t'name': 'curvedRightArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 50000,\r\n\t\t\t'adj3': 25000\r\n\t\t}\r\n\t},\r\n\tCURVED_UP_ARROW: {\r\n\t\t'displayName': 'Curved Up Arrow',\r\n\t\t'name': 'curvedUpArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 50000,\r\n\t\t\t'adj3': 25000\r\n\t\t}\r\n\t},\r\n\tCURVED_UP_RIBBON: {\r\n\t\t'displayName': 'Curved Up Ribbon',\r\n\t\t'name': 'ellipseRibbon2',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 50000,\r\n\t\t\t'adj3': 12500\r\n\t\t}\r\n\t},\r\n\tDECAGON: {\r\n\t\t'displayName': 'Decagon',\r\n\t\t'name': 'decagon',\r\n\t\t'avLst': {\r\n\t\t\t'vf': 105146\r\n\t\t}\r\n\t},\r\n\tDIAGONAL_STRIPE: {\r\n\t\t'displayName': 'Diagonal Stripe',\r\n\t\t'name': 'diagStripe',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 50000\r\n\t\t}\r\n\t},\r\n\tDIAMOND: {\r\n\t\t'displayName': 'Diamond',\r\n\t\t'name': 'diamond',\r\n\t\t'avLst': {}\r\n\t},\r\n\tDODECAGON: {\r\n\t\t'displayName': 'Dodecagon',\r\n\t\t'name': 'dodecagon',\r\n\t\t'avLst': {}\r\n\t},\r\n\tDONUT: {\r\n\t\t'displayName': 'Donut',\r\n\t\t'name': 'donut',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 25000\r\n\t\t}\r\n\t},\r\n\tDOUBLE_BRACE: {\r\n\t\t'displayName': 'Double Brace',\r\n\t\t'name': 'bracePair',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 8333\r\n\t\t}\r\n\t},\r\n\tDOUBLE_BRACKET: {\r\n\t\t'displayName': 'Double Bracket',\r\n\t\t'name': 'bracketPair',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 16667\r\n\t\t}\r\n\t},\r\n\tDOUBLE_WAVE: {\r\n\t\t'displayName': 'Double Wave',\r\n\t\t'name': 'doubleWave',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 6250,\r\n\t\t\t'adj2': 0\r\n\t\t}\r\n\t},\r\n\tDOWN_ARROW: {\r\n\t\t'displayName': 'Down Arrow',\r\n\t\t'name': 'downArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 50000,\r\n\t\t\t'adj2': 50000\r\n\t\t}\r\n\t},\r\n\tDOWN_ARROW_CALLOUT: {\r\n\t\t'displayName': 'Down Arrow Callout',\r\n\t\t'name': 'downArrowCallout',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 25000,\r\n\t\t\t'adj3': 25000,\r\n\t\t\t'adj4': 64977\r\n\t\t}\r\n\t},\r\n\tDOWN_RIBBON: {\r\n\t\t'displayName': 'Down Ribbon',\r\n\t\t'name': 'ribbon',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 16667,\r\n\t\t\t'adj2': 50000\r\n\t\t}\r\n\t},\r\n\tEXPLOSION1: {\r\n\t\t'displayName': 'Explosion',\r\n\t\t'name': 'irregularSeal1',\r\n\t\t'avLst': {}\r\n\t},\r\n\tEXPLOSION2: {\r\n\t\t'displayName': 'Explosion',\r\n\t\t'name': 'irregularSeal2',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_ALTERNATE_PROCESS: {\r\n\t\t'displayName': 'Alternate process',\r\n\t\t'name': 'flowChartAlternateProcess',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_CARD: {\r\n\t\t'displayName': 'Card',\r\n\t\t'name': 'flowChartPunchedCard',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_COLLATE: {\r\n\t\t'displayName': 'Collate',\r\n\t\t'name': 'flowChartCollate',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_CONNECTOR: {\r\n\t\t'displayName': 'Connector',\r\n\t\t'name': 'flowChartConnector',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_DATA: {\r\n\t\t'displayName': 'Data',\r\n\t\t'name': 'flowChartInputOutput',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_DECISION: {\r\n\t\t'displayName': 'Decision',\r\n\t\t'name': 'flowChartDecision',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_DELAY: {\r\n\t\t'displayName': 'Delay',\r\n\t\t'name': 'flowChartDelay',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_DIRECT_ACCESS_STORAGE: {\r\n\t\t'displayName': 'Direct Access Storage',\r\n\t\t'name': 'flowChartMagneticDrum',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_DISPLAY: {\r\n\t\t'displayName': 'Display',\r\n\t\t'name': 'flowChartDisplay',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_DOCUMENT: {\r\n\t\t'displayName': 'Document',\r\n\t\t'name': 'flowChartDocument',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_EXTRACT: {\r\n\t\t'displayName': 'Extract',\r\n\t\t'name': 'flowChartExtract',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_INTERNAL_STORAGE: {\r\n\t\t'displayName': 'Internal Storage',\r\n\t\t'name': 'flowChartInternalStorage',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_MAGNETIC_DISK: {\r\n\t\t'displayName': 'Magnetic Disk',\r\n\t\t'name': 'flowChartMagneticDisk',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_MANUAL_INPUT: {\r\n\t\t'displayName': 'Manual Input',\r\n\t\t'name': 'flowChartManualInput',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_MANUAL_OPERATION: {\r\n\t\t'displayName': 'Manual Operation',\r\n\t\t'name': 'flowChartManualOperation',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_MERGE: {\r\n\t\t'displayName': 'Merge',\r\n\t\t'name': 'flowChartMerge',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_MULTIDOCUMENT: {\r\n\t\t'displayName': 'Multidocument',\r\n\t\t'name': 'flowChartMultidocument',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_OFFLINE_STORAGE: {\r\n\t\t'displayName': 'Offline Storage',\r\n\t\t'name': 'flowChartOfflineStorage',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_OFFPAGE_CONNECTOR: {\r\n\t\t'displayName': 'Off-page Connector',\r\n\t\t'name': 'flowChartOffpageConnector',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_OR: {\r\n\t\t'displayName': 'Or',\r\n\t\t'name': 'flowChartOr',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_PREDEFINED_PROCESS: {\r\n\t\t'displayName': 'Predefined Process',\r\n\t\t'name': 'flowChartPredefinedProcess',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_PREPARATION: {\r\n\t\t'displayName': 'Preparation',\r\n\t\t'name': 'flowChartPreparation',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_PROCESS: {\r\n\t\t'displayName': 'Process',\r\n\t\t'name': 'flowChartProcess',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_PUNCHED_TAPE: {\r\n\t\t'displayName': 'Punched Tape',\r\n\t\t'name': 'flowChartPunchedTape',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_SEQUENTIAL_ACCESS_STORAGE: {\r\n\t\t'displayName': 'Sequential Access Storage',\r\n\t\t'name': 'flowChartMagneticTape',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_SORT: {\r\n\t\t'displayName': 'Sort',\r\n\t\t'name': 'flowChartSort',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_STORED_DATA: {\r\n\t\t'displayName': 'Stored Data',\r\n\t\t'name': 'flowChartOnlineStorage',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_SUMMING_JUNCTION: {\r\n\t\t'displayName': 'Summing Junction',\r\n\t\t'name': 'flowChartSummingJunction',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFLOWCHART_TERMINATOR: {\r\n\t\t'displayName': 'Terminator',\r\n\t\t'name': 'flowChartTerminator',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFOLDED_CORNER: {\r\n\t\t'displayName': 'Folded Corner',\r\n\t\t'name': 'folderCorner',\r\n\t\t'avLst': {}\r\n\t},\r\n\tFRAME: {\r\n\t\t'displayName': 'Frame',\r\n\t\t'name': 'frame',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 12500\r\n\t\t}\r\n\t},\r\n\tFUNNEL: {\r\n\t\t'displayName': 'Funnel',\r\n\t\t'name': 'funnel',\r\n\t\t'avLst': {}\r\n\t},\r\n\tGEAR_6: {\r\n\t\t'displayName': 'Gear 6',\r\n\t\t'name': 'gear6',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 15000,\r\n\t\t\t'adj2': 3526\r\n\t\t}\r\n\t},\r\n\tGEAR_9: {\r\n\t\t'displayName': 'Gear 9',\r\n\t\t'name': 'gear9',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 10000,\r\n\t\t\t'adj2': 1763\r\n\t\t}\r\n\t},\r\n\tHALF_FRAME: {\r\n\t\t'displayName': 'Half Frame',\r\n\t\t'name': 'halfFrame',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 33333,\r\n\t\t\t'adj2': 33333\r\n\t\t}\r\n\t},\r\n\tHEART: {\r\n\t\t'displayName': 'Heart',\r\n\t\t'name': 'heart',\r\n\t\t'avLst': {}\r\n\t},\r\n\tHEPTAGON: {\r\n\t\t'displayName': 'Heptagon',\r\n\t\t'name': 'heptagon',\r\n\t\t'avLst': {\r\n\t\t\t'hf': 102572,\r\n\t\t\t'vf': 105210\r\n\t\t}\r\n\t},\r\n\tHEXAGON: {\r\n\t\t'displayName': 'Hexagon',\r\n\t\t'name': 'hexagon',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 25000,\r\n\t\t\t'vf': 115470\r\n\t\t}\r\n\t},\r\n\tHORIZONTAL_SCROLL: {\r\n\t\t'displayName': 'Horizontal Scroll',\r\n\t\t'name': 'horizontalScroll',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 12500\r\n\t\t}\r\n\t},\r\n\tISOSCELES_TRIANGLE: {\r\n\t\t'displayName': 'Isosceles Triangle',\r\n\t\t'name': 'triangle',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 50000\r\n\t\t}\r\n\t},\r\n\tLEFT_ARROW: {\r\n\t\t'displayName': 'Left Arrow',\r\n\t\t'name': 'leftArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 50000,\r\n\t\t\t'adj2': 50000\r\n\t\t}\r\n\t},\r\n\tLEFT_ARROW_CALLOUT: {\r\n\t\t'displayName': 'Left Arrow Callout',\r\n\t\t'name': 'leftArrowCallout',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 25000,\r\n\t\t\t'adj3': 25000,\r\n\t\t\t'adj4': 64977\r\n\t\t}\r\n\t},\r\n\tLEFT_BRACE: {\r\n\t\t'displayName': 'Left Brace',\r\n\t\t'name': 'leftBrace',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 8333,\r\n\t\t\t'adj2': 50000\r\n\t\t}\r\n\t},\r\n\tLEFT_BRACKET: {\r\n\t\t'displayName': 'Left Bracket',\r\n\t\t'name': 'leftBracket',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 8333\r\n\t\t}\r\n\t},\r\n\tLEFT_CIRCULAR_ARROW: {\r\n\t\t'displayName': 'Left Circular Arrow',\r\n\t\t'name': 'leftCircularArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 12500,\r\n\t\t\t'adj2': -1142319,\r\n\t\t\t'adj3': 1142319,\r\n\t\t\t'adj4': 10800000,\r\n\t\t\t'adj5': 12500\r\n\t\t}\r\n\t},\r\n\tLEFT_RIGHT_ARROW: {\r\n\t\t'displayName': 'Left-Right Arrow',\r\n\t\t'name': 'leftRightArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 50000,\r\n\t\t\t'adj2': 50000\r\n\t\t}\r\n\t},\r\n\tLEFT_RIGHT_ARROW_CALLOUT: {\r\n\t\t'displayName': 'Left-Right Arrow Callout',\r\n\t\t'name': 'leftRightArrowCallout',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 25000,\r\n\t\t\t'adj3': 25000,\r\n\t\t\t'adj4': 48123\r\n\t\t}\r\n\t},\r\n\tLEFT_RIGHT_CIRCULAR_ARROW: {\r\n\t\t'displayName': 'Left Right Circular Arrow',\r\n\t\t'name': 'leftRightCircularArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 12500,\r\n\t\t\t'adj2': 1142319,\r\n\t\t\t'adj3': 20457681,\r\n\t\t\t'adj4': 11942319,\r\n\t\t\t'adj5': 12500\r\n\t\t}\r\n\t},\r\n\tLEFT_RIGHT_RIBBON: {\r\n\t\t'displayName': 'Left Right Ribbon',\r\n\t\t'name': 'leftRightRibbon',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 50000,\r\n\t\t\t'adj2': 50000,\r\n\t\t\t'adj3': 16667\r\n\t\t}\r\n\t},\r\n\tLEFT_RIGHT_UP_ARROW: {\r\n\t\t'displayName': 'Left-Right-Up Arrow',\r\n\t\t'name': 'leftRightUpArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 25000,\r\n\t\t\t'adj3': 25000\r\n\t\t}\r\n\t},\r\n\tLEFT_UP_ARROW: {\r\n\t\t'displayName': 'Left-Up Arrow',\r\n\t\t'name': 'leftUpArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 25000,\r\n\t\t\t'adj3': 25000\r\n\t\t}\r\n\t},\r\n\tLIGHTNING_BOLT: {\r\n\t\t'displayName': 'Lightning Bolt',\r\n\t\t'name': 'lightningBolt',\r\n\t\t'avLst': {}\r\n\t},\r\n\tLINE_CALLOUT_1: {\r\n\t\t'displayName': 'Line Callout 1',\r\n\t\t'name': 'borderCallout1',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 112500,\r\n\t\t\t'adj4': -38333\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_1_ACCENT_BAR: {\r\n\t\t'displayName': 'Line Callout 1 {Accent Bar}',\r\n\t\t'name': 'accentCallout1',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 112500,\r\n\t\t\t'adj4': -38333\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_1_BORDER_AND_ACCENT_BAR: {\r\n\t\t'displayName': 'Line Callout 1 {Border and Accent Bar}',\r\n\t\t'name': 'accentBorderCallout1',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 112500,\r\n\t\t\t'adj4': -38333\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_1_NO_BORDER: {\r\n\t\t'displayName': 'Line Callout 1 {No Border}',\r\n\t\t'name': 'callout1',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 112500,\r\n\t\t\t'adj4': -38333\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_2: {\r\n\t\t'displayName': 'Line Callout 2',\r\n\t\t'name': 'borderCallout2',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 18750,\r\n\t\t\t'adj4': -16667,\r\n\t\t\t'adj5': 112500,\r\n\t\t\t'adj6': -46667\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_2_ACCENT_BAR: {\r\n\t\t'displayName': 'Line Callout 2 {Accent Bar}',\r\n\t\t'name': 'accentCallout2',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 18750,\r\n\t\t\t'adj4': -16667,\r\n\t\t\t'adj5': 112500,\r\n\t\t\t'adj6': -46667\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_2_BORDER_AND_ACCENT_BAR: {\r\n\t\t'displayName': 'Line Callout 2 {Border and Accent Bar}',\r\n\t\t'name': 'accentBorderCallout2',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 18750,\r\n\t\t\t'adj4': -16667,\r\n\t\t\t'adj5': 112500,\r\n\t\t\t'adj6': -46667\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_2_NO_BORDER: {\r\n\t\t'displayName': 'Line Callout 2 {No Border}',\r\n\t\t'name': 'callout2',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 18750,\r\n\t\t\t'adj4': -16667,\r\n\t\t\t'adj5': 112500,\r\n\t\t\t'adj6': -46667\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_3: {\r\n\t\t'displayName': 'Line Callout 3',\r\n\t\t'name': 'borderCallout3',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 18750,\r\n\t\t\t'adj4': -16667,\r\n\t\t\t'adj5': 100000,\r\n\t\t\t'adj6': -16667,\r\n\t\t\t'adj7': 112963,\r\n\t\t\t'adj8': -8333\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_3_ACCENT_BAR: {\r\n\t\t'displayName': 'Line Callout 3 {Accent Bar}',\r\n\t\t'name': 'accentCallout3',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 18750,\r\n\t\t\t'adj4': -16667,\r\n\t\t\t'adj5': 100000,\r\n\t\t\t'adj6': -16667,\r\n\t\t\t'adj7': 112963,\r\n\t\t\t'adj8': -8333\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_3_BORDER_AND_ACCENT_BAR: {\r\n\t\t'displayName': 'Line Callout 3 {Border and Accent Bar}',\r\n\t\t'name': 'accentBorderCallout3',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 18750,\r\n\t\t\t'adj4': -16667,\r\n\t\t\t'adj5': 100000,\r\n\t\t\t'adj6': -16667,\r\n\t\t\t'adj7': 112963,\r\n\t\t\t'adj8': -8333\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_3_NO_BORDER: {\r\n\t\t'displayName': 'Line Callout 3 {No Border}',\r\n\t\t'name': 'callout3',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 18750,\r\n\t\t\t'adj4': -16667,\r\n\t\t\t'adj5': 100000,\r\n\t\t\t'adj6': -16667,\r\n\t\t\t'adj7': 112963,\r\n\t\t\t'adj8': -8333\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_4: {\r\n\t\t'displayName': 'Line Callout 3',\r\n\t\t'name': 'borderCallout3',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 18750,\r\n\t\t\t'adj4': -16667,\r\n\t\t\t'adj5': 100000,\r\n\t\t\t'adj6': -16667,\r\n\t\t\t'adj7': 112963,\r\n\t\t\t'adj8': -8333\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_4_ACCENT_BAR: {\r\n\t\t'displayName': 'Line Callout 3 {Accent Bar}',\r\n\t\t'name': 'accentCallout3',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 18750,\r\n\t\t\t'adj4': -16667,\r\n\t\t\t'adj5': 100000,\r\n\t\t\t'adj6': -16667,\r\n\t\t\t'adj7': 112963,\r\n\t\t\t'adj8': -8333\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_4_BORDER_AND_ACCENT_BAR: {\r\n\t\t'displayName': 'Line Callout 3 {Border and Accent Bar}',\r\n\t\t'name': 'accentBorderCallout3',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 18750,\r\n\t\t\t'adj4': -16667,\r\n\t\t\t'adj5': 100000,\r\n\t\t\t'adj6': -16667,\r\n\t\t\t'adj7': 112963,\r\n\t\t\t'adj8': -8333\r\n\t\t}\r\n\t},\r\n\tLINE_CALLOUT_4_NO_BORDER: {\r\n\t\t'displayName': 'Line Callout 3 {No Border}',\r\n\t\t'name': 'callout3',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18750,\r\n\t\t\t'adj2': -8333,\r\n\t\t\t'adj3': 18750,\r\n\t\t\t'adj4': -16667,\r\n\t\t\t'adj5': 100000,\r\n\t\t\t'adj6': -16667,\r\n\t\t\t'adj7': 112963,\r\n\t\t\t'adj8': -8333\r\n\t\t}\r\n\t},\r\n\tLINE: {\r\n\t\t'displayName': 'Line',\r\n\t\t'name': 'line',\r\n\t\t'avLst': {}\r\n\t},\r\n\tLINE_INVERSE: {\r\n\t\t'displayName': 'Straight Connector',\r\n\t\t'name': 'lineInv',\r\n\t\t'avLst': {}\r\n\t},\r\n\tMATH_DIVIDE: {\r\n\t\t'displayName': 'Division',\r\n\t\t'name': 'mathDivide',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 23520,\r\n\t\t\t'adj2': 5880,\r\n\t\t\t'adj3': 11760\r\n\t\t}\r\n\t},\r\n\tMATH_EQUAL: {\r\n\t\t'displayName': 'Equal',\r\n\t\t'name': 'mathEqual',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 23520,\r\n\t\t\t'adj2': 11760\r\n\t\t}\r\n\t},\r\n\tMATH_MINUS: {\r\n\t\t'displayName': 'Minus',\r\n\t\t'name': 'mathMinus',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 23520\r\n\t\t}\r\n\t},\r\n\tMATH_MULTIPLY: {\r\n\t\t'displayName': 'Multiply',\r\n\t\t'name': 'mathMultiply',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 23520\r\n\t\t}\r\n\t},\r\n\tMATH_NOT_EQUAL: {\r\n\t\t'displayName': 'Not Equal',\r\n\t\t'name': 'mathNotEqual',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 23520,\r\n\t\t\t'adj2': 6600000,\r\n\t\t\t'adj3': 11760\r\n\t\t}\r\n\t},\r\n\tMATH_PLUS: {\r\n\t\t'displayName': 'Plus',\r\n\t\t'name': 'mathPlus',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 23520\r\n\t\t}\r\n\t},\r\n\tMOON: {\r\n\t\t'displayName': 'Moon',\r\n\t\t'name': 'moon',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 50000\r\n\t\t}\r\n\t},\r\n\tNON_ISOSCELES_TRAPEZOID: {\r\n\t\t'displayName': 'Non-isosceles Trapezoid',\r\n\t\t'name': 'nonIsoscelesTrapezoid',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 25000\r\n\t\t}\r\n\t},\r\n\tNOTCHED_RIGHT_ARROW: {\r\n\t\t'displayName': 'Notched Right Arrow',\r\n\t\t'name': 'notchedRightArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 50000,\r\n\t\t\t'adj2': 50000\r\n\t\t}\r\n\t},\r\n\tNO_SYMBOL: {\r\n\t\t'displayName': '\"No\" symbol',\r\n\t\t'name': 'noSmoking',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 18750\r\n\t\t}\r\n\t},\r\n\tOCTAGON: {\r\n\t\t'displayName': 'Octagon',\r\n\t\t'name': 'octagon',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 29289\r\n\t\t}\r\n\t},\r\n\tOVAL: {\r\n\t\t'displayName': 'Oval',\r\n\t\t'name': 'ellipse',\r\n\t\t'avLst': {}\r\n\t},\r\n\tOVAL_CALLOUT: {\r\n\t\t'displayName': 'Oval Callout',\r\n\t\t'name': 'wedgeEllipseCallout',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': -20833,\r\n\t\t\t'adj2': 62500\r\n\t\t}\r\n\t},\r\n\tPARALLELOGRAM: {\r\n\t\t'displayName': 'Parallelogram',\r\n\t\t'name': 'parallelogram',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 25000\r\n\t\t}\r\n\t},\r\n\tPENTAGON: {\r\n\t\t'displayName': 'Pentagon',\r\n\t\t'name': 'homePlate',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 50000\r\n\t\t}\r\n\t},\r\n\tPIE: {\r\n\t\t'displayName': 'Pie',\r\n\t\t'name': 'pie',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 0,\r\n\t\t\t'adj2': 16200000\r\n\t\t}\r\n\t},\r\n\tPIE_WEDGE: {\r\n\t\t'displayName': 'Pie',\r\n\t\t'name': 'pieWedge',\r\n\t\t'avLst': {}\r\n\t},\r\n\tPLAQUE: {\r\n\t\t'displayName': 'Plaque',\r\n\t\t'name': 'plaque',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 16667\r\n\t\t}\r\n\t},\r\n\tPLAQUE_TABS: {\r\n\t\t'displayName': 'Plaque Tabs',\r\n\t\t'name': 'plaqueTabs',\r\n\t\t'avLst': {}\r\n\t},\r\n\tQUAD_ARROW: {\r\n\t\t'displayName': 'Quad Arrow',\r\n\t\t'name': 'quadArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 22500,\r\n\t\t\t'adj2': 22500,\r\n\t\t\t'adj3': 22500\r\n\t\t}\r\n\t},\r\n\tQUAD_ARROW_CALLOUT: {\r\n\t\t'displayName': 'Quad Arrow Callout',\r\n\t\t'name': 'quadArrowCallout',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 18515,\r\n\t\t\t'adj2': 18515,\r\n\t\t\t'adj3': 18515,\r\n\t\t\t'adj4': 48123\r\n\t\t}\r\n\t},\r\n\tRECTANGLE: {\r\n\t\t'displayName': 'Rectangle',\r\n\t\t'name': 'rect',\r\n\t\t'avLst': {}\r\n\t},\r\n\tRECTANGULAR_CALLOUT: {\r\n\t\t'displayName': 'Rectangular Callout',\r\n\t\t'name': 'wedgeRectCallout',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': -20833,\r\n\t\t\t'adj2': 62500\r\n\t\t}\r\n\t},\r\n\tREGULAR_PENTAGON: {\r\n\t\t'displayName': 'Regular Pentagon',\r\n\t\t'name': 'pentagon',\r\n\t\t'avLst': {\r\n\t\t\t'hf': 105146,\r\n\t\t\t'vf': 110557\r\n\t\t}\r\n\t},\r\n\tRIGHT_ARROW: {\r\n\t\t'displayName': 'Right Arrow',\r\n\t\t'name': 'rightArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 50000,\r\n\t\t\t'adj2': 50000\r\n\t\t}\r\n\t},\r\n\tRIGHT_ARROW_CALLOUT: {\r\n\t\t'displayName': 'Right Arrow Callout',\r\n\t\t'name': 'rightArrowCallout',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 25000,\r\n\t\t\t'adj3': 25000,\r\n\t\t\t'adj4': 64977\r\n\t\t}\r\n\t},\r\n\tRIGHT_BRACE: {\r\n\t\t'displayName': 'Right Brace',\r\n\t\t'name': 'rightBrace',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 8333,\r\n\t\t\t'adj2': 50000\r\n\t\t}\r\n\t},\r\n\tRIGHT_BRACKET: {\r\n\t\t'displayName': 'Right Bracket',\r\n\t\t'name': 'rightBracket',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 8333\r\n\t\t}\r\n\t},\r\n\tRIGHT_TRIANGLE: {\r\n\t\t'displayName': 'Right Triangle',\r\n\t\t'name': 'rtTriangle',\r\n\t\t'avLst': {}\r\n\t},\r\n\tROUNDED_RECTANGLE: {\r\n\t\t'displayName': 'Rounded Rectangle',\r\n\t\t'name': 'roundRect',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 16667\r\n\t\t}\r\n\t},\r\n\tROUNDED_RECTANGULAR_CALLOUT: {\r\n\t\t'displayName': 'Rounded Rectangular Callout',\r\n\t\t'name': 'wedgeRoundRectCallout',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': -20833,\r\n\t\t\t'adj2': 62500,\r\n\t\t\t'adj3': 16667\r\n\t\t}\r\n\t},\r\n\tROUND_1_RECTANGLE: {\r\n\t\t'displayName': 'Round Single Corner Rectangle',\r\n\t\t'name': 'round1Rect',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 16667\r\n\t\t}\r\n\t},\r\n\tROUND_2_DIAG_RECTANGLE: {\r\n\t\t'displayName': 'Round Diagonal Corner Rectangle',\r\n\t\t'name': 'round2DiagRect',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 16667,\r\n\t\t\t'adj2': 0\r\n\t\t}\r\n\t},\r\n\tROUND_2_SAME_RECTANGLE: {\r\n\t\t'displayName': 'Round Same Side Corner Rectangle',\r\n\t\t'name': 'round2SameRect',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 16667,\r\n\t\t\t'adj2': 0\r\n\t\t}\r\n\t},\r\n\tSMILEY_FACE: {\r\n\t\t'displayName': 'Smiley Face',\r\n\t\t'name': 'smileyFace',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 4653\r\n\t\t}\r\n\t},\r\n\tSNIP_1_RECTANGLE: {\r\n\t\t'displayName': 'Snip Single Corner Rectangle',\r\n\t\t'name': 'snip1Rect',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 16667\r\n\t\t}\r\n\t},\r\n\tSNIP_2_DIAG_RECTANGLE: {\r\n\t\t'displayName': 'Snip Diagonal Corner Rectangle',\r\n\t\t'name': 'snip2DiagRect',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 0,\r\n\t\t\t'adj2': 16667\r\n\t\t}\r\n\t},\r\n\tSNIP_2_SAME_RECTANGLE: {\r\n\t\t'displayName': 'Snip Same Side Corner Rectangle',\r\n\t\t'name': 'snip2SameRect',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 16667,\r\n\t\t\t'adj2': 0\r\n\t\t}\r\n\t},\r\n\tSNIP_ROUND_RECTANGLE: {\r\n\t\t'displayName': 'Snip and Round Single Corner Rectangle',\r\n\t\t'name': 'snipRoundRect',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 16667,\r\n\t\t\t'adj2': 16667\r\n\t\t}\r\n\t},\r\n\tSQUARE_TABS: {\r\n\t\t'displayName': 'Square Tabs',\r\n\t\t'name': 'squareTabs',\r\n\t\t'avLst': {}\r\n\t},\r\n\tSTAR_10_POINT: {\r\n\t\t'displayName': '10-Point Star',\r\n\t\t'name': 'star10',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 42533,\r\n\t\t\t'hf': 105146\r\n\t\t}\r\n\t},\r\n\tSTAR_12_POINT: {\r\n\t\t'displayName': '12-Point Star',\r\n\t\t'name': 'star12',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 37500\r\n\t\t}\r\n\t},\r\n\tSTAR_16_POINT: {\r\n\t\t'displayName': '16-Point Star',\r\n\t\t'name': 'star16',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 37500\r\n\t\t}\r\n\t},\r\n\tSTAR_24_POINT: {\r\n\t\t'displayName': '24-Point Star',\r\n\t\t'name': 'star24',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 37500\r\n\t\t}\r\n\t},\r\n\tSTAR_32_POINT: {\r\n\t\t'displayName': '32-Point Star',\r\n\t\t'name': 'star32',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 37500\r\n\t\t}\r\n\t},\r\n\tSTAR_4_POINT: {\r\n\t\t'displayName': '4-Point Star',\r\n\t\t'name': 'star4',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 12500\r\n\t\t}\r\n\t},\r\n\tSTAR_5_POINT: {\r\n\t\t'displayName': '5-Point Star',\r\n\t\t'name': 'star5',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 19098,\r\n\t\t\t'hf': 105146,\r\n\t\t\t'vf': 110557\r\n\t\t}\r\n\t},\r\n\tSTAR_6_POINT: {\r\n\t\t'displayName': '6-Point Star',\r\n\t\t'name': 'star6',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 28868,\r\n\t\t\t'hf': 115470\r\n\t\t}\r\n\t},\r\n\tSTAR_7_POINT: {\r\n\t\t'displayName': '7-Point Star',\r\n\t\t'name': 'star7',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 34601,\r\n\t\t\t'hf': 102572,\r\n\t\t\t'vf': 105210\r\n\t\t}\r\n\t},\r\n\tSTAR_8_POINT: {\r\n\t\t'displayName': '8-Point Star',\r\n\t\t'name': 'star8',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 37500\r\n\t\t}\r\n\t},\r\n\tSTRIPED_RIGHT_ARROW: {\r\n\t\t'displayName': 'Striped Right Arrow',\r\n\t\t'name': 'stripedRightArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 50000,\r\n\t\t\t'adj2': 50000\r\n\t\t}\r\n\t},\r\n\tSUN: {\r\n\t\t'displayName': 'Sun',\r\n\t\t'name': 'sun',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 25000\r\n\t\t}\r\n\t},\r\n\tSWOOSH_ARROW: {\r\n\t\t'displayName': 'Swoosh Arrow',\r\n\t\t'name': 'swooshArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 16667\r\n\t\t}\r\n\t},\r\n\tTEAR: {\r\n\t\t'displayName': 'Teardrop',\r\n\t\t'name': 'teardrop',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 100000\r\n\t\t}\r\n\t},\r\n\tTRAPEZOID: {\r\n\t\t'displayName': 'Trapezoid',\r\n\t\t'name': 'trapezoid',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 25000\r\n\t\t}\r\n\t},\r\n\tUP_ARROW: {\r\n\t\t'displayName': 'Up Arrow',\r\n\t\t'name': 'upArrow',\r\n\t\t'avLst': {}\r\n\t},\r\n\tUP_ARROW_CALLOUT: {\r\n\t\t'displayName': 'Up Arrow Callout',\r\n\t\t'name': 'upArrowCallout',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 25000,\r\n\t\t\t'adj3': 25000,\r\n\t\t\t'adj4': 64977\r\n\t\t}\r\n\t},\r\n\tUP_DOWN_ARROW: {\r\n\t\t'displayName': 'Up-Down Arrow',\r\n\t\t'name': 'upDownArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 50000,\r\n\t\t\t'adj1': 50000,\r\n\t\t\t'adj2': 50000,\r\n\t\t\t'adj2': 50000\r\n\t\t}\r\n\t},\r\n\tUP_DOWN_ARROW_CALLOUT: {\r\n\t\t'displayName': 'Up-Down Arrow Callout',\r\n\t\t'name': 'upDownArrowCallout',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 25000,\r\n\t\t\t'adj3': 25000,\r\n\t\t\t'adj4': 48123\r\n\t\t}\r\n\t},\r\n\tUP_RIBBON: {\r\n\t\t'displayName': 'Up Ribbon',\r\n\t\t'name': 'ribbon2',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 16667,\r\n\t\t\t'adj2': 50000\r\n\t\t}\r\n\t},\r\n\tU_TURN_ARROW: {\r\n\t\t'displayName': 'U-Turn Arrow',\r\n\t\t'name': 'uturnArrow',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 25000,\r\n\t\t\t'adj2': 25000,\r\n\t\t\t'adj3': 25000,\r\n\t\t\t'adj4': 43750,\r\n\t\t\t'adj5': 75000\r\n\t\t}\r\n\t},\r\n\tVERTICAL_SCROLL: {\r\n\t\t'displayName': 'Vertical Scroll',\r\n\t\t'name': 'verticalScroll',\r\n\t\t'avLst': {\r\n\t\t\t'adj': 12500\r\n\t\t}\r\n\t},\r\n\tWAVE: {\r\n\t\t'displayName': 'Wave',\r\n\t\t'name': 'wave',\r\n\t\t'avLst': {\r\n\t\t\t'adj1': 12500,\r\n\t\t\t'adj2': 0\r\n\t\t}\r\n\t}\r\n}\r\n\r\n","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/lib/msexcel-builder.js":"/*\n  MS Excel 2007 Creater v0.0.1\n  Author : chuanyi.zheng@gmail.com\n  History: 2012/11/07 first created\n*/\n\n\n(function() {\n  var ContentTypes, DocPropsApp, SharedStrings, Sheet, Style, Workbook, XlRels, XlWorkbook, exec, existsSync, fs, opt, path, tool, xml,\n    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };\n\n  fs = require('fs');\n\n  path = require('path');\n\n  exec = require('child_process');\n\n  xml = require('xmlbuilder');\n\n  existsSync = fs.existsSync || path.existsSync;\n\n  tool = {\n    i2a: function(i) {\n      return 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.charAt(i - 1);\n    },\n    copy: function(origin, target) {\n      var f, files, oCur, s, tCur, _i, _len, _results;\n      if (existsSync(origin)) {\n        if (!existsSync(target)) {\n          fs.mkdirSync(target, 755);\n        }\n        files = fs.readdirSync(origin);\n        if (files) {\n          _results = [];\n          for (_i = 0, _len = files.length; _i < _len; _i++) {\n            f = files[_i];\n            oCur = origin + '/' + f;\n            tCur = target + '/' + f;\n            s = fs.statSync(oCur);\n            if (s.isFile()) {\n              _results.push(fs.writeFileSync(tCur, fs.readFileSync(oCur, ''), ''));\n            } else {\n              if (s.isDirectory()) {\n                _results.push(tool.copy(oCur, tCur));\n              } else {\n                _results.push(void 0);\n              }\n            }\n          }\n          return _results;\n        }\n      }\n    }\n  };\n\n  opt = {\n    tmpl_path: __dirname\n  };\n\n  ContentTypes = (function() {\n    function ContentTypes(book) {\n      this.book = book;\n    }\n\n    ContentTypes.prototype.toxml = function() {\n      var i, types, _i, _ref;\n      types = xml.create('Types', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      types.att('xmlns', 'http://schemas.openxmlformats.org/package/2006/content-types');\n      types.ele('Override', {\n        PartName: '/xl/theme/theme1.xml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.theme+xml'\n      });\n      types.ele('Override', {\n        PartName: '/xl/styles.xml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml'\n      });\n      types.ele('Default', {\n        Extension: 'rels',\n        ContentType: 'application/vnd.openxmlformats-package.relationships+xml'\n      });\n      types.ele('Default', {\n        Extension: 'xml',\n        ContentType: 'application/xml'\n      });\n      types.ele('Override', {\n        PartName: '/xl/workbook.xml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml'\n      });\n      types.ele('Override', {\n        PartName: '/docProps/app.xml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.extended-properties+xml'\n      });\n      for (i = _i = 1, _ref = this.book.sheets.length; 1 <= _ref ? _i <= _ref : _i >= _ref; i = 1 <= _ref ? ++_i : --_i) {\n        types.ele('Override', {\n          PartName: '/xl/worksheets/sheet' + i + '.xml',\n          ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml'\n        });\n      }\n      types.ele('Override', {\n        PartName: '/xl/sharedStrings.xml',\n        ContentType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml'\n      });\n      types.ele('Override', {\n        PartName: '/docProps/core.xml',\n        ContentType: 'application/vnd.openxmlformats-package.core-properties+xml'\n      });\n      return types.end();\n    };\n\n    return ContentTypes;\n\n  })();\n\n  DocPropsApp = (function() {\n    function DocPropsApp(book) {\n      this.book = book;\n    }\n\n    DocPropsApp.prototype.toxml = function() {\n      var i, props, tmp, _i, _ref;\n      props = xml.create('Properties', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      props.att('xmlns', 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties');\n      props.att('xmlns:vt', 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes');\n      props.ele('Application', 'Microsoft Excel');\n      props.ele('DocSecurity', '0');\n      props.ele('ScaleCrop', 'false');\n      tmp = props.ele('HeadingPairs').ele('vt:vector', {\n        size: 2,\n        baseType: 'variant'\n      });\n      tmp.ele('vt:variant').ele('vt:lpstr', '???');\n      tmp.ele('vt:variant').ele('vt:i4', '' + this.book.sheets.length);\n      tmp = props.ele('TitlesOfParts').ele('vt:vector', {\n        size: this.book.sheets.length,\n        baseType: 'lpstr'\n      });\n      for (i = _i = 1, _ref = this.book.sheets.length; 1 <= _ref ? _i <= _ref : _i >= _ref; i = 1 <= _ref ? ++_i : --_i) {\n        tmp.ele('vt:lpstr', this.book.sheets[i - 1].name);\n      }\n      props.ele('Company');\n      props.ele('LinksUpToDate', 'false');\n      props.ele('SharedDoc', 'false');\n      props.ele('HyperlinksChanged', 'false');\n      props.ele('AppVersion', '12.0000');\n      return props.end();\n    };\n\n    return DocPropsApp;\n\n  })();\n\n  XlWorkbook = (function() {\n    function XlWorkbook(book) {\n      this.book = book;\n    }\n\n    XlWorkbook.prototype.toxml = function() {\n      var i, tmp, wb, _i, _ref;\n      wb = xml.create('workbook', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      wb.att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');\n      wb.att('xmlns:r', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships');\n      wb.ele('fileVersion ', {\n        appName: 'xl',\n        lastEdited: '4',\n        lowestEdited: '4',\n        rupBuild: '4505'\n      });\n      wb.ele('workbookPr', {\n        filterPrivacy: '1',\n        defaultThemeVersion: '124226'\n      });\n      wb.ele('bookViews').ele('workbookView ', {\n        xWindow: '0',\n        yWindow: '90',\n        windowWidth: '19200',\n        windowHeight: '11640'\n      });\n      tmp = wb.ele('sheets');\n      for (i = _i = 1, _ref = this.book.sheets.length; 1 <= _ref ? _i <= _ref : _i >= _ref; i = 1 <= _ref ? ++_i : --_i) {\n        tmp.ele('sheet', {\n          name: this.book.sheets[i - 1].name,\n          sheetId: '' + i,\n          'r:id': 'rId' + i\n        });\n      }\n      wb.ele('calcPr', {\n        calcId: '124519'\n      });\n      return wb.end();\n    };\n\n    return XlWorkbook;\n\n  })();\n\n  XlRels = (function() {\n    function XlRels(book) {\n      this.book = book;\n    }\n\n    XlRels.prototype.toxml = function() {\n      var i, rs, _i, _ref;\n      rs = xml.create('Relationships', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      rs.att('xmlns', 'http://schemas.openxmlformats.org/package/2006/relationships');\n      for (i = _i = 1, _ref = this.book.sheets.length; 1 <= _ref ? _i <= _ref : _i >= _ref; i = 1 <= _ref ? ++_i : --_i) {\n        rs.ele('Relationship', {\n          Id: 'rId' + i,\n          Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet',\n          Target: 'worksheets/sheet' + i + '.xml'\n        });\n      }\n      rs.ele('Relationship', {\n        Id: 'rId' + (this.book.sheets.length + 1),\n        Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\n        Target: 'theme/theme1.xml'\n      });\n      rs.ele('Relationship', {\n        Id: 'rId' + (this.book.sheets.length + 2),\n        Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles',\n        Target: 'styles.xml'\n      });\n      rs.ele('Relationship', {\n        Id: 'rId' + (this.book.sheets.length + 3),\n        Type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings',\n        Target: 'sharedStrings.xml'\n      });\n      return rs.end();\n    };\n\n    return XlRels;\n\n  })();\n\n  SharedStrings = (function() {\n    function SharedStrings() {\n      this.cache = {};\n      this.arr = [];\n    }\n\n    SharedStrings.prototype.str2id = function(s) {\n      var id;\n      id = this.cache[s];\n      if (id) {\n        return id;\n      } else {\n        this.arr.push(s);\n        this.cache[s] = this.arr.length;\n        return this.arr.length;\n      }\n    };\n\n    SharedStrings.prototype.toxml = function() {\n      var i, si, sst, _i, _ref;\n      sst = xml.create('sst', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      sst.att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');\n      sst.att('count', '' + this.arr.length);\n      sst.att('uniqueCount', '' + this.arr.length);\n      for (i = _i = 0, _ref = this.arr.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n        si = sst.ele('si');\n        si.ele('t', this.arr[i]);\n        si.ele('phoneticPr', {\n          fontId: 1,\n          type: 'noConversion'\n        });\n      }\n      return sst.end();\n    };\n\n    return SharedStrings;\n\n  })();\n\n  Sheet = (function() {\n    function Sheet(book, name, cols, rows) {\n      var i, j, _i, _j, _ref, _ref1;\n      this.book = book;\n      this.name = name;\n      this.cols = cols;\n      this.rows = rows;\n      this.data = {};\n      for (i = _i = 1, _ref = this.rows; 1 <= _ref ? _i <= _ref : _i >= _ref; i = 1 <= _ref ? ++_i : --_i) {\n        this.data[i] = {};\n        for (j = _j = 1, _ref1 = this.cols; 1 <= _ref1 ? _j <= _ref1 : _j >= _ref1; j = 1 <= _ref1 ? ++_j : --_j) {\n          this.data[i][j] = {\n            v: 0,\n            dataType: 'string'\n          };\n        }\n      }\n      this.merges = [];\n      this.col_wd = [];\n      this.row_ht = {};\n      this.styles = {};\n    }\n\n    Sheet.prototype.set = function(col, row, value) {\n      if ((typeof value) === \"string\") {\n        if ((value != null) && value !== '') {\n          this.data[row][col].v = this.book.ss.str2id('' + value);\n        }\n        return this.data[row][col].dataType = 'string';\n      } else {\n        this.data[row][col].v = value;\n        return this.data[row][col].dataType = 'number';\n      }\n    };\n\n    Sheet.prototype.merge = function(from_cell, to_cell) {\n      return this.merges.push({\n        from: from_cell,\n        to: to_cell\n      });\n    };\n\n    Sheet.prototype.width = function(col, wd) {\n      return this.col_wd.push({\n        c: col,\n        cw: wd\n      });\n    };\n\n    Sheet.prototype.height = function(row, ht) {\n      return this.row_ht[row] = ht;\n    };\n\n    Sheet.prototype.font = function(col, row, font_s) {\n      return this.styles['font_' + col + '_' + row] = this.book.st.font2id(font_s);\n    };\n\n    Sheet.prototype.fill = function(col, row, fill_s) {\n      return this.styles['fill_' + col + '_' + row] = this.book.st.fill2id(fill_s);\n    };\n\n    Sheet.prototype.border = function(col, row, bder_s) {\n      return this.styles['bder_' + col + '_' + row] = this.book.st.bder2id(bder_s);\n    };\n\n    Sheet.prototype.align = function(col, row, align_s) {\n      return this.styles['algn_' + col + '_' + row] = align_s;\n    };\n\n    Sheet.prototype.valign = function(col, row, valign_s) {\n      return this.styles['valgn_' + col + '_' + row] = valign_s;\n    };\n\n    Sheet.prototype.rotate = function(col, row, textRotation) {\n      return this.styles['rotate_' + col + '_' + row] = textRotation;\n    };\n\n    Sheet.prototype.wrap = function(col, row, wrap_s) {\n      return this.styles['wrap_' + col + '_' + row] = wrap_s;\n    };\n\n    Sheet.prototype.style_id = function(col, row) {\n      var id, inx, style;\n      inx = '_' + col + '_' + row;\n      style = {\n        font_id: this.styles['font' + inx],\n        fill_id: this.styles['fill' + inx],\n        bder_id: this.styles['bder' + inx],\n        align: this.styles['algn' + inx],\n        valign: this.styles['valgn' + inx],\n        rotate: this.styles['rotate' + inx],\n        wrap: this.styles['wrap' + inx]\n      };\n      id = this.book.st.style2id(style);\n      return id;\n    };\n\n    Sheet.prototype.toxml = function() {\n      var c, cols, cw, ht, i, ix, j, m, mc, r, sd, sid, ws, _i, _j, _k, _l, _len, _len1, _ref, _ref1, _ref2, _ref3;\n      ws = xml.create('worksheet', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      ws.att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');\n      ws.att('xmlns:r', 'http://schemas.openxmlformats.org/officeDocument/2006/relationships');\n      ws.ele('dimension', {\n        ref: 'A1'\n      });\n      ws.ele('sheetViews').ele('sheetView', {\n        workbookViewId: '0'\n      });\n      ws.ele('sheetFormatPr', {\n        defaultRowHeight: '13.5'\n      });\n      if (this.col_wd.length > 0) {\n        cols = ws.ele('cols');\n        _ref = this.col_wd;\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n          cw = _ref[_i];\n          cols.ele('col', {\n            min: '' + cw.c,\n            max: '' + cw.c,\n            width: cw.cw,\n            customWidth: '1'\n          });\n        }\n      }\n      sd = ws.ele('sheetData');\n      for (i = _j = 1, _ref1 = this.rows; 1 <= _ref1 ? _j <= _ref1 : _j >= _ref1; i = 1 <= _ref1 ? ++_j : --_j) {\n        r = sd.ele('row', {\n          r: '' + i,\n          spans: '1:' + this.cols\n        });\n        ht = this.row_ht[i];\n        if (ht) {\n          r.att('ht', ht);\n          r.att('customHeight', '1');\n        }\n        for (j = _k = 1, _ref2 = this.cols; 1 <= _ref2 ? _k <= _ref2 : _k >= _ref2; j = 1 <= _ref2 ? ++_k : --_k) {\n          ix = this.data[i][j];\n          sid = this.style_id(j, i);\n          if ((ix.v !== 0) || (sid !== 1)) {\n            c = r.ele('c', {\n              r: '' + tool.i2a(j) + i\n            });\n            if (sid !== 1) {\n              c.att('s', '' + (sid - 1));\n            }\n            if (ix.v !== 0) {\n              if (ix.dataType === \"string\") {\n                c.att('t', 's');\n                c.ele('v', '' + (ix.v - 1));\n              } else if (ix.dataType === \"number\") {\n                c.ele('v', '' + ix.v);\n              } else {\n                c.ele('v', '' + ix.v);\n              }\n            }\n          }\n        }\n      }\n      if (this.merges.length > 0) {\n        mc = ws.ele('mergeCells', {\n          count: this.merges.length\n        });\n        _ref3 = this.merges;\n        for (_l = 0, _len1 = _ref3.length; _l < _len1; _l++) {\n          m = _ref3[_l];\n          mc.ele('mergeCell', {\n            ref: '' + tool.i2a(m.from.col) + m.from.row + ':' + tool.i2a(m.to.col) + m.to.row\n          });\n        }\n      }\n      ws.ele('phoneticPr', {\n        fontId: '1',\n        type: 'noConversion'\n      });\n      ws.ele('pageMargins', {\n        left: '0.7',\n        right: '0.7',\n        top: '0.75',\n        bottom: '0.75',\n        header: '0.3',\n        footer: '0.3'\n      });\n      ws.ele('pageSetup', {\n        paperSize: '9',\n        orientation: 'portrait',\n        horizontalDpi: '200',\n        verticalDpi: '200'\n      });\n      return ws.end();\n    };\n\n    return Sheet;\n\n  })();\n\n  Style = (function() {\n    function Style(book) {\n      this.book = book;\n      this.cache = {};\n      this.mfonts = [];\n      this.mfills = [];\n      this.mbders = [];\n      this.mstyle = [];\n      this.with_default();\n    }\n\n    Style.prototype.with_default = function() {\n      this.def_font_id = this.font2id(null);\n      this.def_fill_id = this.fill2id(null);\n      this.def_bder_id = this.bder2id(null);\n      this.def_align = '-';\n      this.def_valign = '-';\n      this.def_rotate = '-';\n      this.def_wrap = '-';\n      return this.def_style_id = this.style2id({\n        font_id: this.def_font_id,\n        fill_id: this.def_fill_id,\n        bder_id: this.def_bder_id,\n        align: this.def_align,\n        valign: this.def_valign,\n        rotate: this.def_rotate\n      });\n    };\n\n    Style.prototype.font2id = function(font) {\n      var id, k;\n      font || (font = {});\n      font.bold || (font.bold = '-');\n      font.iter || (font.iter = '-');\n      font.sz || (font.sz = '11');\n      font.color || (font.color = '-');\n      font.name || (font.name = 'Arial');\n      font.scheme || (font.scheme = 'minor');\n      font.family || (font.family = '2');\n      k = 'font_' + font.bold + font.iter + font.sz + font.color + font.name + font.scheme + font.family;\n      id = this.cache[k];\n      if (id) {\n        return id;\n      } else {\n        this.mfonts.push(font);\n        this.cache[k] = this.mfonts.length;\n        return this.mfonts.length;\n      }\n    };\n\n    Style.prototype.fill2id = function(fill) {\n      var id, k;\n      fill || (fill = {});\n      fill.type || (fill.type = 'none');\n      fill.bgColor || (fill.bgColor = '-');\n      fill.fgColor || (fill.fgColor = '-');\n      k = 'fill_' + fill.type + fill.bgColor + fill.fgColor;\n      id = this.cache[k];\n      if (id) {\n        return id;\n      } else {\n        this.mfills.push(fill);\n        this.cache[k] = this.mfills.length;\n        return this.mfills.length;\n      }\n    };\n\n    Style.prototype.bder2id = function(bder) {\n      var id, k;\n      bder || (bder = {});\n      bder.left || (bder.left = '-');\n      bder.right || (bder.right = '-');\n      bder.top || (bder.top = '-');\n      bder.bottom || (bder.bottom = '-');\n      k = 'bder_' + bder.left + '_' + bder.right + '_' + bder.top + '_' + bder.bottom;\n      id = this.cache[k];\n      if (id) {\n        return id;\n      } else {\n        this.mbders.push(bder);\n        this.cache[k] = this.mbders.length;\n        return this.mbders.length;\n      }\n    };\n\n    Style.prototype.style2id = function(style) {\n      var id, k;\n      style.align || (style.align = this.def_align);\n      style.valign || (style.valign = this.def_valign);\n      style.rotate || (style.rotate = this.def_rotate);\n      style.wrap || (style.wrap = this.def_wrap);\n      style.font_id || (style.font_id = this.def_font_id);\n      style.fill_id || (style.fill_id = this.def_fill_id);\n      style.bder_id || (style.bder_id = this.def_bder_id);\n      k = 's_' + style.font_id + '_' + style.fill_id + '_' + style.bder_id + '_' + style.align + '_' + style.valign + '_' + style.wrap + '_' + style.rotate;\n      id = this.cache[k];\n      if (id) {\n        return id;\n      } else {\n        this.mstyle.push(style);\n        this.cache[k] = this.mstyle.length;\n        return this.mstyle.length;\n      }\n    };\n\n    Style.prototype.toxml = function() {\n      var bders, cs, e, ea, es, fills, fonts, o, ss, _i, _j, _k, _l, _len, _len1, _len2, _len3, _ref, _ref1, _ref2, _ref3;\n      ss = xml.create('styleSheet', {\n        version: '1.0',\n        encoding: 'UTF-8',\n        standalone: true\n      });\n      ss.att('xmlns', 'http://schemas.openxmlformats.org/spreadsheetml/2006/main');\n      fonts = ss.ele('fonts', {\n        count: this.mfonts.length\n      });\n      _ref = this.mfonts;\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        o = _ref[_i];\n        e = fonts.ele('font');\n        if (o.bold !== '-') {\n          e.ele('b');\n        }\n        if (o.iter !== '-') {\n          e.ele('i');\n        }\n        e.ele('sz', {\n          val: o.sz\n        });\n        if (o.color !== '-') {\n          e.ele('color', {\n            theme: o.color\n          });\n        }\n        e.ele('name', {\n          val: o.name\n        });\n        e.ele('family', {\n          val: o.family\n        });\n        e.ele('charset', {\n          val: '134'\n        });\n        if (o.scheme !== '-') {\n          e.ele('scheme', {\n            val: 'minor'\n          });\n        }\n      }\n      fills = ss.ele('fills', {\n        count: this.mfills.length\n      });\n      _ref1 = this.mfills;\n      for (_j = 0, _len1 = _ref1.length; _j < _len1; _j++) {\n        o = _ref1[_j];\n        e = fills.ele('fill');\n        es = e.ele('patternFill', {\n          patternType: o.type\n        });\n        if (o.fgColor !== '-') {\n          es.ele('fgColor', {\n            theme: '8',\n            tint: '0.79998168889431442'\n          });\n        }\n        if (o.bgColor !== '-') {\n          es.ele('bgColor', {\n            indexed: o.bgColor\n          });\n        }\n      }\n      bders = ss.ele('borders', {\n        count: this.mbders.length\n      });\n      _ref2 = this.mbders;\n      for (_k = 0, _len2 = _ref2.length; _k < _len2; _k++) {\n        o = _ref2[_k];\n        e = bders.ele('border');\n        if (o.left !== '-') {\n          e.ele('left', {\n            style: o.left\n          }).ele('color', {\n            auto: '1'\n          });\n        } else {\n          e.ele('left');\n        }\n        if (o.right !== '-') {\n          e.ele('right', {\n            style: o.right\n          }).ele('color', {\n            auto: '1'\n          });\n        } else {\n          e.ele('right');\n        }\n        if (o.top !== '-') {\n          e.ele('top', {\n            style: o.top\n          }).ele('color', {\n            auto: '1'\n          });\n        } else {\n          e.ele('top');\n        }\n        if (o.bottom !== '-') {\n          e.ele('bottom', {\n            style: o.bottom\n          }).ele('color', {\n            auto: '1'\n          });\n        } else {\n          e.ele('bottom');\n        }\n        e.ele('diagonal');\n      }\n      ss.ele('cellStyleXfs', {\n        count: '1'\n      }).ele('xf', {\n        numFmtId: '0',\n        fontId: '0',\n        fillId: '0',\n        borderId: '0'\n      }).ele('alignment', {\n        vertical: 'center'\n      });\n      cs = ss.ele('cellXfs', {\n        count: this.mstyle.length\n      });\n      _ref3 = this.mstyle;\n      for (_l = 0, _len3 = _ref3.length; _l < _len3; _l++) {\n        o = _ref3[_l];\n        e = cs.ele('xf', {\n          numFmtId: '0',\n          fontId: o.font_id - 1,\n          fillId: o.fill_id - 1,\n          borderId: o.bder_id - 1,\n          xfId: '0'\n        });\n        if (o.font_id !== 1) {\n          e.att('applyFont', '1');\n        }\n        if (o.fill_id !== 1) {\n          e.att('applyFill', '1');\n        }\n        if (o.bder_id !== 1) {\n          e.att('applyBorder', '1');\n        }\n        if (o.align !== '-' || o.valign !== '-' || o.wrap !== '-') {\n          e.att('applyAlignment', '1');\n          ea = e.ele('alignment', {\n            textRotation: (o.rotate === '-' ? '0' : o.rotate),\n            horizontal: (o.align === '-' ? 'left' : o.align),\n            vertical: (o.valign === '-' ? 'top' : o.valign)\n          });\n          if (o.wrap !== '-') {\n            ea.att('wrapText', '1');\n          }\n        }\n      }\n      ss.ele('cellStyles', {\n        count: '1'\n      }).ele('cellStyle', {\n        name: '??',\n        xfId: '0',\n        builtinId: '0'\n      });\n      ss.ele('dxfs', {\n        count: '0'\n      });\n      ss.ele('tableStyles', {\n        count: '0',\n        defaultTableStyle: 'TableStyleMedium9',\n        defaultPivotStyle: 'PivotStyleLight16'\n      });\n      return ss.end();\n    };\n\n    return Style;\n\n  })();\n\n  Workbook = (function() {\n    function Workbook(fpath, fname) {\n      var target;\n      this.fpath = fpath;\n      this.fname = fname;\n      this.save = __bind(this.save, this);\n      this.id = '' + parseInt(Math.random() * 9999999);\n      target = path.join(path.resolve(this.fpath), this.id);\n      if (existsSync(target)) {\n        fs.rmdirSync(target);\n      }\n      tool.copy(opt.tmpl_path + '/tmpl', target);\n      this.sheets = [];\n      this.ss = new SharedStrings;\n      this.ct = new ContentTypes(this);\n      this.da = new DocPropsApp(this);\n      this.wb = new XlWorkbook(this);\n      this.re = new XlRels(this);\n      this.st = new Style(this);\n    }\n\n    Workbook.prototype.createSheet = function(name, cols, rows) {\n      var sheet;\n      sheet = new Sheet(this, name, cols, rows);\n      this.sheets.push(sheet);\n      return sheet;\n    };\n\n    Workbook.prototype.save = function(cb) {\n      var args, i, opts, target, _i, _ref;\n      target = path.join(path.resolve(this.fpath), this.id);\n      if (!fs.existsSync(target)) {\n        fs.mkdirSync(target, function(e) {\n          return;\n          if (!e || (e && e.code === 'EEXIST')) {\n            return console.log(path + 'created');\n          } else {\n            return console.log(e);\n          }\n        });\n      }\n      fs.writeFileSync(path.join(target, '[Content_Types].xml'), this.ct.toxml(), 'utf8');\n      if (!fs.existsSync(path.join(target, 'docProps'))) {\n        fs.mkdirSync(path.join(target, 'docProps'), function(e) {\n          return;\n          if (!e || (e && e.code === 'EEXIST')) {\n            return console.log(path + 'created');\n          } else {\n            return console.log(e);\n          }\n        });\n      }\n      fs.writeFileSync(path.join(target, 'docProps', 'app.xml'), this.da.toxml(), 'utf8');\n      if (!fs.existsSync(path.join(target, 'xl'))) {\n        fs.mkdirSync(path.join(target, 'xl'), function(e) {\n          return;\n          if (!e || (e && e.code === 'EEXIST')) {\n            return console.log(path + 'created');\n          } else {\n            return console.log(e);\n          }\n        });\n      }\n      fs.writeFileSync(path.join(target, 'xl', 'workbook.xml'), this.wb.toxml(), 'utf8');\n      fs.writeFileSync(path.join(target, 'xl', 'sharedStrings.xml'), this.ss.toxml(), 'utf8');\n      fs.mkdirSync(path.join(target, path.join('xl', '_rels')), function(e) {\n        return;\n        if (!e || (e && e.code === 'EEXIST')) {\n          return console.log(path + 'created');\n        } else {\n          return console.log(e);\n        }\n      });\n      fs.writeFileSync(path.join(target, 'xl', '_rels', 'workbook.xml.rels'), this.re.toxml(), 'utf8');\n      fs.mkdirSync(path.join(target, path.join('xl', 'worksheets')), function(e) {\n        return;\n        if (!e || (e && e.code === 'EEXIST')) {\n          return console.log(path + 'created');\n        } else {\n          return console.log(e);\n        }\n      });\n      for (i = _i = 0, _ref = this.sheets.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\n        fs.writeFileSync(path.join(target, 'xl', 'worksheets', 'sheet' + (i + 1) + '.xml'), this.sheets[i].toxml(), 'utf8');\n      }\n      fs.writeFileSync(path.join(target, 'xl', 'styles.xml'), this.st.toxml(), 'utf8');\n      args = ' a -tzip \"' + path.join(path.resolve('..'), this.fname) + '\" \"*\"'; // zip -r path .\n      opts = {\n        cwd: target\n      };\n      \n      var p = 'cd ' + target + '/; zip -r ../' + this.fname + ' .; cd ..;';\n      return exec.exec(p, function(err, stdout, stderr) {\n        return exec.exec('rm -r ' + target, function() {\n          console.log(err);\n          return cb(err);\n        });\n      });\n    };\n\n    Workbook.prototype.cancel = function() {\n      return fs.rmdirSync(target);\n    };\n\n    return Workbook;\n\n  })();\n\n  module.exports = {\n    createWorkbook: function(fpath, fname) {\n      return new Workbook(fpath, fname);\n    }\n  };\n\n}).call(this);\n","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/lib/genxlsx.js":"//\r\n// officegen: All the code to generate XLSX files.\r\n//\r\n// Please refer to README.md for this module's documentations.\r\n//\r\n// NOTE:\r\n// - Before changing this code please refer to the hacking the code section on README.md.\r\n//\r\n// Copyright (c) 2013 Ziv Barber;\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files (the\r\n// 'Software'), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\r\n// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\r\n// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\n\r\nvar baseobj = require(\"./basicgen.js\");\r\nvar msdoc = require(\"./msofficegen.js\");\r\n\r\nif ( !String.prototype.encodeHTML ) {\r\n\tString.prototype.encodeHTML = function () {\r\n\t\treturn this.replace(/&/g, '&amp;')\r\n\t\t\t.replace(/</g, '&lt;')\r\n\t\t\t.replace(/>/g, '&gt;')\r\n\t\t\t.replace(/\"/g, '&quot;');\r\n\t};\r\n}\r\n\r\n///\r\n/// @brief Extend officegen object with XLSX support.\r\n///\r\n/// This method extending the given officegen object to create XLSX document.\r\n///\r\n/// @param[in] genobj The object to extend.\r\n/// @param[in] new_type The type of object to create.\r\n/// @param[in] options The object's options.\r\n/// @param[in] gen_private Access to the internals of this object.\r\n/// @param[in] type_info Additional information about this type.\r\n///\r\nfunction makeXlsx ( genobj, new_type, options, gen_private, type_info ) {\r\n\t///\r\n\t/// @brief Create the shared string resource.\r\n\t///\r\n\t/// This resource holding all the text strings of any Excel document.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeXlsSharedStrings ( data ) {\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"' + genobj.generate_data.total_strings + '\" uniqueCount=\"' + genobj.generate_data.shared_strings.length + '\">';\r\n\r\n\t\tfor ( var i = 0, total_size = genobj.generate_data.shared_strings.length; i < total_size; i++ ) {\r\n\t\t\toutString += '<si><t>' + genobj.generate_data.shared_strings[i].encodeHTML () + '</t></si>';\r\n\t\t} // Endif.\r\n\r\n\t\treturn outString + '</sst>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Prepare everything to generate XLSX files.\r\n\t///\r\n\t/// This method working on all the Excel cells to find out information needed by the generator engine.\r\n\t///\r\n\tfunction cbPrepareXlsxToGenerate () {\r\n\t\tgenobj.generate_data = {};\r\n\t\tgenobj.generate_data.shared_strings = [];\r\n\t\tgenobj.lookup_strings = {};\r\n\t\tgenobj.generate_data.total_strings = 0;\r\n\t\tgenobj.generate_data.cell_strings = [];\r\n\r\n\t\t// Create the share strings data:\r\n\t\tfor ( var i = 0, total_size = gen_private.pages.length; i < total_size; i++ ) {\r\n\t\t\tif ( gen_private.pages[i] ) {\r\n\t\t\t\tfor ( var rowId = 0, total_size_y = gen_private.pages[i].sheet.data.length; rowId < total_size_y; rowId++ ) {\r\n\t\t\t\t\tif ( gen_private.pages[i].sheet.data[rowId] ) {\r\n\t\t\t\t\t\tfor ( var columnId = 0, total_size_x = gen_private.pages[i].sheet.data[rowId].length; columnId < total_size_x; columnId++ ) {\r\n\t\t\t\t\t\t\tif ( typeof gen_private.pages[i].sheet.data[rowId][columnId] != 'undefined' ) {\r\n\t\t\t\t\t\t\t\tswitch ( typeof gen_private.pages[i].sheet.data[rowId][columnId] ) {\r\n\t\t\t\t\t\t\t\t\tcase 'string':\r\n\t\t\t\t\t\t\t\t\t\tgenobj.generate_data.total_strings++;\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( !genobj.generate_data.cell_strings[i] ) {\r\n\t\t\t\t\t\t\t\t\t\t\tgenobj.generate_data.cell_strings[i] = [];\r\n\t\t\t\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( !genobj.generate_data.cell_strings[i][rowId] ) {\r\n\t\t\t\t\t\t\t\t\t\t\tgenobj.generate_data.cell_strings[i][rowId] = [];\r\n\t\t\t\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\t\t\t\tvar shared_str = gen_private.pages[i].sheet.data[rowId][columnId];\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (shared_str in genobj.lookup_strings) {\r\n\t\t\t\t\t\t\t\t\t\t\tgenobj.generate_data.cell_strings[i][rowId][columnId] = genobj.lookup_strings[ shared_str ];\r\n\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\tvar shared_str_position = genobj.generate_data.shared_strings.length;\r\n\t\t\t\t\t\t\t\t\t\t\tgenobj.generate_data.cell_strings[i][rowId][columnId] = shared_str_position;\r\n\t\t\t\t\t\t\t\t\t\t\tgenobj.lookup_strings[ shared_str ] = shared_str_position;\r\n\t\t\t\t\t\t\t\t\t\t\tgenobj.generate_data.shared_strings[shared_str_position] = shared_str;\r\n\t\t\t\t\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t} // End of switch.\r\n\t\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t\t} // End of for loop.\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // End of for loop.\r\n\t\t\t} // Endif.\r\n\t\t} // End of for loop.\r\n\r\n\t\tif ( genobj.generate_data.total_strings ) {\r\n\t\t\tgen_private.plugs.intAddAnyResourceToParse ( 'xl\\\\sharedStrings.xml', 'buffer', null, cbMakeXlsSharedStrings, false );\r\n\t\t\tgen_private.type.msoffice.files_list.push (\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '/xl/sharedStrings.xml',\r\n\t\t\t\t\ttype: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml',\r\n\t\t\t\t\tclear: 'generate'\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\tgen_private.type.msoffice.rels_app.push (\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings',\r\n\t\t\t\t\ttarget: 'sharedStrings.xml',\r\n\t\t\t\t\tclear: 'generate'\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\t// console.log ( genobj.generate_data.total_strings );\r\n\t\t\t// console.log ( genobj.generate_data.shared_strings.length );\r\n\t\t} // Endif.\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeXlsStyles ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"><fonts count=\"1\"><font><sz val=\"11\"/><color theme=\"1\"/><name val=\"Calibri\"/><family val=\"2\"/><scheme val=\"minor\"/></font></fonts><fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills><borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders><cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs><cellXfs count=\"2\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" xfId=\"0\"/><xf applyAlignment=\"1\" borderId=\"0\" fillId=\"0\" fontId=\"0\" numFmtId=\"0\" xfId=\"0\"><alignment wrapText=\"1\"/></xf></cellXfs><cellStyles count=\"1\"><cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\"/></cellStyles><dxfs count=\"0\"/><tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleLight16\"/></styleSheet>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeXlsApp ( data ) {\r\n\t\tvar pagesCount = gen_private.pages.length;\r\n\t\tvar userName = genobj.options.creator || 'officegen';\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\"><Application>Microsoft Excel</Application><DocSecurity>0</DocSecurity><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size=\"2\" baseType=\"variant\"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>' + pagesCount + '</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size=\"' + pagesCount + '\" baseType=\"lpstr\">';\r\n\r\n\t\tfor ( var i = 0, total_size = gen_private.pages.length; i < total_size; i++ ) {\r\n\t\t\toutString += '<vt:lpstr>Sheet' + (i + 1) + '</vt:lpstr>';\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '</vt:vector></TitlesOfParts><Company>' + userName + '</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>12.0000</AppVersion></Properties>';\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeXlsWorkbook ( data ) {\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"><fileVersion appName=\"xl\" lastEdited=\"4\" lowestEdited=\"4\" rupBuild=\"4507\"/><workbookPr defaultThemeVersion=\"124226\"/><bookViews><workbookView xWindow=\"120\" yWindow=\"75\" windowWidth=\"19095\" windowHeight=\"7485\"/></bookViews><sheets>';\r\n\r\n\t\tfor ( var i = 0, total_size = gen_private.pages.length; i < total_size; i++ ) {\r\n\t\t\tvar sheetName = gen_private.pages[i].sheet.name || 'Sheet' + (i + 1);\r\n                        var rId = gen_private.pages[i].relId;\r\n\t\t\toutString += '<sheet name=\"' + sheetName + '\" sheetId=\"' + (i + 1) + '\" r:id=\"rId' + rId + '\"/>';\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '</sheets><calcPr calcId=\"125725\"/></workbook>';\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Translate from the Excel displayed row name into index number.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] cell_string Either the cell displayed position or the row displayed position.\r\n\t/// @return The cell's row Id.\r\n\t///\r\n\tfunction cbCellToNumber ( cell_string, ret_also_column ) {\r\n\t\tvar cellNumber = 0;\r\n\t\tvar cellIndex = 0;\r\n\t\tvar cellMax = cell_string.length;\r\n\t\tvar rowId = 0;\r\n\r\n\t\t// Converted from C++ (from DuckWriteC++):\r\n\t\twhile ( cellIndex < cellMax )\r\n\t\t{\r\n\t\t\tvar curChar = cell_string.charCodeAt ( cellIndex );\r\n\t\t\tif ( (curChar >= 0x30) && (curChar <= 0x39) )\r\n\t\t\t{\r\n\t\t\t\trowId = parseInt ( cell_string.slice ( cellIndex ), 10 );\r\n\t\t\t\trowId = (rowId > 0) ? (rowId - 1) : 0;\r\n\t\t\t\tbreak;\r\n\r\n\t\t\t} else if ( (curChar >= 0x41) && (curChar <= 0x5A) )\r\n\t\t\t{\r\n\t\t\t\tif ( cellIndex > 0 )\r\n\t\t\t\t{\r\n\t\t\t\t\tcellNumber++;\r\n\t\t\t\t\tcellNumber *= (0x5B-0x41);\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tcellNumber += (curChar - 0x41);\r\n\r\n\t\t\t} else if ( (curChar >= 0x61) && (curChar <= 0x7A) )\r\n\t\t\t{\r\n\t\t\t\tif ( cellIndex > 0 )\r\n\t\t\t\t{\r\n\t\t\t\t\tcellNumber++;\r\n\t\t\t\t\tcellNumber *= (0x5B-0x41);\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tcellNumber += (curChar - 0x61);\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tcellIndex++;\r\n\t\t} // End of while loop.\r\n\r\n\t\tif ( ret_also_column ) {\r\n\t\t\treturn { row: rowId, column: cellNumber };\r\n\t\t} // Endif.\r\n\r\n\t\treturn cellNumber;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] cell_number ???.\r\n\t/// @return ???.\r\n\t///\r\n\tfunction cbNumberToCell ( cell_number ) {\r\n\t\tvar outCell = '';\r\n\t\tvar curCell = cell_number;\r\n\r\n\t\twhile ( curCell >= 0 )\r\n\t\t{\r\n\t\t\toutCell = String.fromCharCode ( (curCell % (0x5B-0x41)) + 0x41 ) + outCell;\r\n\t\t\tif ( curCell >= (0x5B-0x41) )\r\n\t\t\t\tcurCell = Math.floor ( curCell / (0x5B-0x41) ) - 1;\r\n\t\t\telse\r\n\t\t\t\tbreak;\r\n\t\t} // End of while loop.\r\n\r\n\t\treturn outCell;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data The main sheet object.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeXlsSheet ( data ) {\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">';\r\n\t\tvar maxX = 0;\r\n\t\tvar maxY = 0;\r\n\t\tvar curColMax;\r\n\t\tvar rowId;\r\n\t\tvar columnId;\r\n\r\n\t\t// Find the maximum cells area:\r\n\t\tmaxY = data.sheet.data.length ? (data.sheet.data.length - 1) : 0;\r\n\t\tfor ( var rowId = 0, total_size_y = data.sheet.data.length; rowId < total_size_y; rowId++ ) {\r\n\t\t\tif ( data.sheet.data[rowId] ) {\r\n\t\t\t\tcurColMax = data.sheet.data[rowId].length ? (data.sheet.data[rowId].length - 1) : 0;\r\n\t\t\t\tmaxX = maxX < curColMax ? curColMax : maxX;\r\n\t\t\t} // Endif.\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '<dimension ref=\"A1:' + cbNumberToCell ( maxX ) + '' + (maxY + 1) + '\"/><sheetViews>';\r\n\t\toutString += '<sheetView tabSelected=\"1\" workbookViewId=\"0\"/>';\r\n\t\t// outString += '<selection activeCell=\"A1\" sqref=\"A1\"/>';\r\n\t\toutString += '</sheetViews><sheetFormatPr defaultRowHeight=\"15\"/>';\r\n\r\n\t\t// BMK_TODO: <cols><col min=\"2\" max=\"2\" width=\"19\" customWidth=\"1\"/></cols>\r\n\r\n\t\toutString += '<sheetData>';\r\n\r\n\t\tfor ( var rowId = 0, total_size_y = data.sheet.data.length; rowId < total_size_y; rowId++ ) {\r\n\t\t\tif ( data.sheet.data[rowId] ) {\r\n\t\t\t\t// Patch by arnesten <notifications@github.com>: Automatically support line breaks if used in cell + calculates row height:\r\n                var rowLines = 1;\r\n                data.sheet.data[rowId].forEach(function (cellData) {\r\n                    if (typeof cellData === 'string') {\r\n                        var candidate = cellData.split('\\n').length;\r\n                        rowLines = Math.max(rowLines, candidate);\r\n                    }\r\n                });\r\n\t\t\t\toutString += '<row r=\"' + (rowId + 1) + '\" spans=\"1:' + (data.sheet.data[rowId].length) + '\" ht=\"' + ( rowLines * 15 ) + '\">';\r\n\t\t\t\t// End of patch.\r\n\r\n\t\t\t\tfor ( var columnId = 0, total_size_x = data.sheet.data[rowId].length; columnId < total_size_x; columnId++ ) {\r\n                    var cellData = data.sheet.data[rowId][columnId];\r\n                    if ( typeof  cellData != 'undefined' ) {\r\n\t\t\t\t\t\tvar isString = '';\r\n\t\t\t\t\t\tvar cellOutData = '0';\r\n\r\n\t\t\t\t\t\tswitch ( typeof cellData ) {\r\n\t\t\t\t\t\t\tcase 'number':\r\n\t\t\t\t\t\t\t\tcellOutData = cellData;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 'string':\r\n\t\t\t\t\t\t\t\tcellOutData = genobj.generate_data.cell_strings[data.id][rowId][columnId];\r\n                                if (cellData.indexOf('\\n') >= 0) {\r\n                                    isString = ' s=\"1\" t=\"s\"';\r\n                                }\r\n                                else {\r\n                                    isString = ' t=\"s\"';\r\n                                }\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t} // End of switch.\r\n\r\n\t\t\t\t\t\toutString += '<c r=\"' + cbNumberToCell ( columnId ) + '' + (rowId + 1) + '\"' + isString + '><v>' + cellOutData + '</v></c>';\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // End of for loop.\r\n\r\n\t\t\t\toutString += '</row>';\r\n\t\t\t} // Endif.\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '</sheetData><pageMargins left=\"0.7\" right=\"0.7\" top=\"0.75\" bottom=\"0.75\" header=\"0.3\" footer=\"0.3\"/></worksheet>';\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t// Prepare genobj for MS-Office:\r\n\tmsdoc.makemsdoc ( genobj, new_type, options, gen_private, type_info );\r\n\tgen_private.plugs.type.msoffice.makeOfficeGenerator ( 'xl', 'workbook', {} );\r\n\r\n\tgen_private.features.page_name = 'sheets'; // This document type must have pages.\r\n\r\n\t// On each generate we'll prepare the shared strings list:\r\n\tgenobj.on ( 'beforeGen', cbPrepareXlsxToGenerate );\r\n\r\n\tgen_private.type.msoffice.files_list.push (\r\n\t\t{\r\n\t\t\tname: '/xl/styles.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/xl/workbook.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml',\r\n\t\t\tclear: 'type'\r\n\t\t}\r\n\t);\r\n\r\n\tgen_private.type.msoffice.rels_app.push (\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles',\r\n\t\t\ttarget: 'styles.xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\r\n\t\t\ttarget: 'theme/theme1.xml',\r\n\t\t\tclear: 'type'\r\n\t\t}\r\n\t);\r\n\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'docProps\\\\app.xml', 'buffer', null, cbMakeXlsApp, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'xl\\\\styles.xml', 'buffer', null, cbMakeXlsStyles, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'xl\\\\workbook.xml', 'buffer', null, cbMakeXlsWorkbook, true );\r\n\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'xl\\\\_rels\\\\workbook.xml.rels', 'buffer', gen_private.type.msoffice.rels_app, gen_private.plugs.type.msoffice.cbMakeRels, true );\r\n\r\n\t// ----- API for Excel documents: -----\r\n\r\n\t///\r\n\t/// @brief Create a new sheet.\r\n\t///\r\n\t/// This method creating a new Excel sheet.\r\n\t///\r\n\tgenobj.makeNewSheet = function () {\r\n\t\tvar pageNumber = gen_private.pages.length;\r\n\t\tvar sheetObj = {}; // The sheet object that the user will use.\r\n\r\n\t\tsheetObj.data = []; // Place here all the data.\r\n\r\n\t\tgen_private.pages[pageNumber] = {};\r\n\t\tgen_private.pages[pageNumber].id = pageNumber;\r\n\t\tgen_private.pages[pageNumber].relId = gen_private.type.msoffice.rels_app.length + 1;\r\n\t\tgen_private.pages[pageNumber].sheet = sheetObj;\r\n\r\n\t\tgen_private.type.msoffice.rels_app.push (\r\n\t\t\t{\r\n\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet',\r\n\t\t\t\ttarget: 'worksheets/sheet' + (pageNumber + 1) + '.xml',\r\n\t\t\t\tclear: 'data'\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tgen_private.type.msoffice.files_list.push (\r\n\t\t\t{\r\n\t\t\t\tname: '/xl/worksheets/sheet' + (pageNumber + 1) + '.xml',\r\n\t\t\t\ttype: 'application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml',\r\n\t\t\t\tclear: 'data'\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tsheetObj.setCell = function ( position, data_val ) {\r\n\t\t\tvar rel_pos = cbCellToNumber ( position, true );\r\n\r\n\t\t\tif ( !sheetObj.data[rel_pos.row] ) {\r\n\t\t\t\tsheetObj.data[rel_pos.row] = [];\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tsheetObj.data[rel_pos.row][rel_pos.column] = data_val;\r\n\t\t};\r\n\r\n\t\tgen_private.plugs.intAddAnyResourceToParse ( 'xl\\\\worksheets\\\\sheet' + (pageNumber + 1) + '.xml', 'buffer', gen_private.pages[pageNumber], cbMakeXlsSheet, false );\r\n\r\n\t\treturn sheetObj;\r\n\t};\r\n}\r\n\r\nbaseobj.plugins.registerDocType ( 'xlsx', makeXlsx, {}, baseobj.docType.SPREADSHEET, \"Microsoft Excel Document\" );\r\n\r\n","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/lib/gendocx.js":"//\r\n// officegen: All the code to generate DOCX files.\r\n//\r\n// Please refer to README.md for this module's documentations.\r\n//\r\n// NOTE:\r\n// - Before changing this code please refer to the hacking the code section on README.md.\r\n//\r\n// Copyright (c) 2013 Ziv Barber;\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files (the\r\n// 'Software'), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\r\n// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\r\n// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\n\r\nvar baseobj = require(\"./basicgen.js\");\r\nvar msdoc = require(\"./msofficegen.js\");\r\n\r\nvar path = require('path');\r\n\r\nvar fast_image_size = require('fast-image-size');\r\n\r\nif ( !String.prototype.encodeHTML ) {\r\n\tString.prototype.encodeHTML = function () {\r\n\t\treturn this.replace(/&/g, '&amp;')\r\n\t\t\t.replace(/</g, '&lt;')\r\n\t\t\t.replace(/>/g, '&gt;')\r\n\t\t\t.replace(/\"/g, '&quot;');\r\n\t};\r\n}\r\n\r\n///\r\n/// @brief Extend officegen object with DOCX support.\r\n///\r\n/// This method extending the given officegen object to create DOCX document.\r\n///\r\n/// @param[in] genobj The object to extend.\r\n/// @param[in] new_type The type of object to create.\r\n/// @param[in] options The object's options.\r\n/// @param[in] gen_private Access to the internals of this object.\r\n/// @param[in] type_info Additional information about this type.\r\n///\r\nfunction makeDocx ( genobj, new_type, options, gen_private, type_info ) {\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeDocxFontsTable ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<w:fonts xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"><w:font w:name=\"Calibri\"><w:panose1 w:val=\"020F0502020204030204\"/><w:charset w:val=\"00\"/><w:family w:val=\"swiss\"/><w:pitch w:val=\"variable\"/><w:sig w:usb0=\"A00002EF\" w:usb1=\"4000207B\" w:usb2=\"00000000\" w:usb3=\"00000000\" w:csb0=\"0000009F\" w:csb1=\"00000000\"/></w:font><w:font w:name=\"Arial\"><w:panose1 w:val=\"020B0604020202020204\"/><w:charset w:val=\"00\"/><w:family w:val=\"swiss\"/><w:pitch w:val=\"variable\"/><w:sig w:usb0=\"20002A87\" w:usb1=\"80000000\" w:usb2=\"00000008\" w:usb3=\"00000000\" w:csb0=\"000001FF\" w:csb1=\"00000000\"/></w:font><w:font w:name=\"Times New Roman\"><w:panose1 w:val=\"02020603050405020304\"/><w:charset w:val=\"00\"/><w:family w:val=\"roman\"/><w:pitch w:val=\"variable\"/><w:sig w:usb0=\"20002A87\" w:usb1=\"80000000\" w:usb2=\"00000008\" w:usb3=\"00000000\" w:csb0=\"000001FF\" w:csb1=\"00000000\"/></w:font><w:font w:name=\"Cambria\"><w:panose1 w:val=\"02040503050406030204\"/><w:charset w:val=\"00\"/><w:family w:val=\"roman\"/><w:pitch w:val=\"variable\"/><w:sig w:usb0=\"A00002EF\" w:usb1=\"4000004B\" w:usb2=\"00000000\" w:usb3=\"00000000\" w:csb0=\"0000009F\" w:csb1=\"00000000\"/></w:font></w:fonts>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeDocxSettings ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<w:settings xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:sl=\"http://schemas.openxmlformats.org/schemaLibrary/2006/main\"><w:zoom w:percent=\"120\"/><w:defaultTabStop w:val=\"720\"/><w:characterSpacingControl w:val=\"doNotCompress\"/><w:compat/><w:rsids><w:rsidRoot w:val=\"00A94AF2\"/><w:rsid w:val=\"00A02F19\"/><w:rsid w:val=\"00A94AF2\"/></w:rsids><m:mathPr><m:mathFont m:val=\"Cambria Math\"/><m:brkBin m:val=\"before\"/><m:brkBinSub m:val=\"--\"/><m:smallFrac m:val=\"off\"/><m:dispDef/><m:lMargin m:val=\"0\"/><m:rMargin m:val=\"0\"/><m:defJc m:val=\"centerGroup\"/><m:wrapIndent m:val=\"1440\"/><m:intLim m:val=\"subSup\"/><m:naryLim m:val=\"undOvr\"/></m:mathPr><w:themeFontLang w:val=\"en-US\" w:bidi=\"en-US\"/><w:clrSchemeMapping w:bg1=\"light1\" w:t1=\"dark1\" w:bg2=\"light2\" w:t2=\"dark2\" w:accent1=\"accent1\" w:accent2=\"accent2\" w:accent3=\"accent3\" w:accent4=\"accent4\" w:accent5=\"accent5\" w:accent6=\"accent6\" w:hyperlink=\"hyperlink\" w:followedHyperlink=\"followedHyperlink\"/><w:shapeDefaults><o:shapedefaults v:ext=\"edit\" spidmax=\"2050\"/><o:shapelayout v:ext=\"edit\"><o:idmap v:ext=\"edit\" data=\"1\"/></o:shapelayout></w:shapeDefaults><w:decimalSymbol w:val=\".\"/><w:listSeparator w:val=\",\"/></w:settings>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeDocxWeb ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<w:webSettings xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"><w:optimizeForBrowser/></w:webSettings>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeDocxStyles ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<w:styles xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"><w:docDefaults><w:rPrDefault><w:rPr><w:rFonts w:asciiTheme=\"minorHAnsi\" w:eastAsiaTheme=\"minorHAnsi\" w:hAnsiTheme=\"minorHAnsi\" w:cstheme=\"minorBidi\"/><w:sz w:val=\"22\"/><w:szCs w:val=\"22\"/><w:lang w:val=\"en-US\" w:eastAsia=\"en-US\" w:bidi=\"en-US\"/></w:rPr></w:rPrDefault><w:pPrDefault><w:pPr><w:spacing w:after=\"200\" w:line=\"276\" w:lineRule=\"auto\"/></w:pPr></w:pPrDefault></w:docDefaults><w:latentStyles w:defLockedState=\"0\" w:defUIPriority=\"99\" w:defSemiHidden=\"1\" w:defUnhideWhenUsed=\"1\" w:defQFormat=\"0\" w:count=\"267\"><w:lsdException w:name=\"Normal\" w:semiHidden=\"0\" w:uiPriority=\"0\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 1\" w:semiHidden=\"0\" w:uiPriority=\"9\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 2\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 3\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 4\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 5\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 6\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 7\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 8\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"heading 9\" w:uiPriority=\"9\" w:qFormat=\"1\"/><w:lsdException w:name=\"toc 1\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 2\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 3\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 4\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 5\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 6\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 7\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 8\" w:uiPriority=\"39\"/><w:lsdException w:name=\"toc 9\" w:uiPriority=\"39\"/><w:lsdException w:name=\"caption\" w:uiPriority=\"35\" w:qFormat=\"1\"/><w:lsdException w:name=\"Title\" w:semiHidden=\"0\" w:uiPriority=\"10\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Default Paragraph Font\" w:uiPriority=\"1\"/><w:lsdException w:name=\"Subtitle\" w:semiHidden=\"0\" w:uiPriority=\"11\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Strong\" w:semiHidden=\"0\" w:uiPriority=\"22\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Emphasis\" w:semiHidden=\"0\" w:uiPriority=\"20\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Table Grid\" w:semiHidden=\"0\" w:uiPriority=\"59\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Placeholder Text\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"No Spacing\" w:semiHidden=\"0\" w:uiPriority=\"1\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Light Shading\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 2\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Shading Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Revision\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"List Paragraph\" w:semiHidden=\"0\" w:uiPriority=\"34\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Quote\" w:semiHidden=\"0\" w:uiPriority=\"29\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Intense Quote\" w:semiHidden=\"0\" w:uiPriority=\"30\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Medium List 2 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3 Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid Accent 1\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Shading Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 2 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3 Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid Accent 2\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Shading Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 2 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3 Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid Accent 3\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Shading Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 2 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3 Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid Accent 4\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Shading Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 2 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3 Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid Accent 5\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Shading Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"60\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light List Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"61\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Light Grid Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"62\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 1 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"63\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Shading 2 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"64\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 1 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"65\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium List 2 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"66\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 1 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"67\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 2 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"68\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Medium Grid 3 Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"69\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Dark List Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"70\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Shading Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"71\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful List Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"72\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Colorful Grid Accent 6\" w:semiHidden=\"0\" w:uiPriority=\"73\" w:unhideWhenUsed=\"0\"/><w:lsdException w:name=\"Subtle Emphasis\" w:semiHidden=\"0\" w:uiPriority=\"19\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Intense Emphasis\" w:semiHidden=\"0\" w:uiPriority=\"21\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Subtle Reference\" w:semiHidden=\"0\" w:uiPriority=\"31\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Intense Reference\" w:semiHidden=\"0\" w:uiPriority=\"32\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Book Title\" w:semiHidden=\"0\" w:uiPriority=\"33\" w:unhideWhenUsed=\"0\" w:qFormat=\"1\"/><w:lsdException w:name=\"Bibliography\" w:uiPriority=\"37\"/><w:lsdException w:name=\"TOC Heading\" w:uiPriority=\"39\" w:qFormat=\"1\"/></w:latentStyles><w:style w:type=\"paragraph\" w:default=\"1\" w:styleId=\"Normal\"><w:name w:val=\"Normal\"/><w:qFormat/><w:rsid w:val=\"00A02F19\"/></w:style><w:style w:type=\"character\" w:default=\"1\" w:styleId=\"DefaultParagraphFont\"><w:name w:val=\"Default Paragraph Font\"/><w:uiPriority w:val=\"1\"/><w:semiHidden/><w:unhideWhenUsed/></w:style><w:style w:type=\"table\" w:default=\"1\" w:styleId=\"TableNormal\"><w:name w:val=\"Normal Table\"/><w:uiPriority w:val=\"99\"/><w:semiHidden/><w:unhideWhenUsed/><w:qFormat/><w:tblPr><w:tblInd w:w=\"0\" w:type=\"dxa\"/><w:tblCellMar><w:top w:w=\"0\" w:type=\"dxa\"/><w:left w:w=\"108\" w:type=\"dxa\"/><w:bottom w:w=\"0\" w:type=\"dxa\"/><w:right w:w=\"108\" w:type=\"dxa\"/></w:tblCellMar></w:tblPr></w:style><w:style w:type=\"numbering\" w:default=\"1\" w:styleId=\"NoList\"><w:name w:val=\"No List\"/><w:uiPriority w:val=\"99\"/><w:semiHidden/><w:unhideWhenUsed/></w:style></w:styles>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeDocxApp ( data ) {\r\n\t\tvar userName = genobj.options.creator || 'officegen';\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\"><Template>Normal.dotm</Template><TotalTime>1</TotalTime><Pages>1</Pages><Words>0</Words><Characters>0</Characters><Application>Microsoft Office Word</Application><DocSecurity>0</DocSecurity><Lines>1</Lines><Paragraphs>1</Paragraphs><ScaleCrop>false</ScaleCrop><Company>' + userName + '</Company><LinksUpToDate>false</LinksUpToDate><CharactersWithSpaces>0</CharactersWithSpaces><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>12.0000</AppVersion></Properties>';\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakeDocxDocument ( data ) {\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<w:document xmlns:ve=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:m=\"http://schemas.openxmlformats.org/officeDocument/2006/math\" xmlns:v=\"urn:schemas-microsoft-com:vml\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\" xmlns:w10=\"urn:schemas-microsoft-com:office:word\" xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\" xmlns:wne=\"http://schemas.microsoft.com/office/word/2006/wordml\"><w:body>';\r\n\t\tvar objs_list = data.data;\r\n\r\n\t\t// Work on all the stored paragraphs inside this document:\r\n\t\tfor ( var i = 0, total_size = objs_list.length; i < total_size; i++ ) {\r\n\t\t\toutString += '<w:p w:rsidR=\"00A77427\" w:rsidRDefault=\"007F1D13\">';\r\n\t\t\tvar pPrData = '';\r\n\r\n\t\t\tif ( objs_list[i].options ) {\r\n\t\t\t\tif ( objs_list[i].options.align ) {\r\n\t\t\t\t\tswitch ( objs_list[i].options.align ) {\r\n\t\t\t\t\t\tcase 'center':\r\n\t\t\t\t\t\t\tpPrData += '<w:jc w:val=\"center\"/>';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'right':\r\n\t\t\t\t\t\t\tpPrData += '<w:jc w:val=\"right\"/>';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'justify':\r\n\t\t\t\t\t\t\tpPrData += '<w:jc w:val=\"both\"/>';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} // End of switch.\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( objs_list[i].options.list_type ) {\r\n\t\t\t\t\tpPrData += '<w:pStyle w:val=\"ListParagraph\"/><w:numPr><w:ilvl w:val=\"0\"/><w:numId w:val=\"' + objs_list[i].options.list_type + '\"/></w:numPr>';\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( pPrData ) {\r\n\t\t\t\toutString += '<w:pPr>' + pPrData + '</w:pPr>';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\t// Work on all the objects in the document:\r\n\t\t\tfor ( var j = 0, total_size_j = objs_list[i].data.length; j < total_size_j; j++ ) {\r\n\t\t\t\tif ( objs_list[i].data[j] ) {\r\n\t\t\t\t\tvar rExtra = '';\r\n\t\t\t\t\tvar tExtra = '';\r\n\t\t\t\t\tvar rPrData = '';\r\n\r\n\t\t\t\t\tif ( objs_list[i].data[j].options ) {\r\n\t\t\t\t\t\tif ( objs_list[i].data[j].options.color ) {\r\n\t\t\t\t\t\t\trPrData += '<w:color w:val=\"' + objs_list[i].data[j].options.color + '\"/>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tif ( objs_list[i].data[j].options.back ) {\r\n\t\t\t\t\t\t\trPrData += '<w:shd w:val=\"clear\" w:color=\"auto\" w:fill=\"' + objs_list[i].data[j].options.back + '\"/>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tif ( objs_list[i].data[j].options.bold ) {\r\n\t\t\t\t\t\t\trPrData += '<w:b/><w:bCs/>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tif ( objs_list[i].data[j].options.underline ) {\r\n\t\t\t\t\t\t\trPrData += '<w:u w:val=\"single\"/>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tif ( objs_list[i].data[j].options.font_face ) {\r\n\t\t\t\t\t\t\trPrData += '<w:rFonts w:ascii=\"' + objs_list[i].data[j].options.font_face + '\" w:hAnsi=\"' + objs_list[i].data[j].options.font_face + '\" w:cs=\"' + objs_list[i].data[j].options.font_face + '\"/>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tif ( objs_list[i].data[j].options.font_size ) {\r\n\t\t\t\t\t\t\trPrData += '<w:sz w:val=\"' + objs_list[i].data[j].options.font_size + '\"/><w:szCs w:val=\"' + objs_list[i].data[j].options.font_size + '\"/>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tif ( objs_list[i].data[j].options.border ) {\r\n\t\t\t\t\t\t\tswitch ( objs_list[i].data[j].options.border )\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcase 'single':\r\n\t\t\t\t\t\t\t\tcase true:\r\n\t\t\t\t\t\t\t\t\trPrData += '<w:bdr w:val=\"single\" w:sz=\"4\" w:space=\"0\" w:color=\"auto\"/>';\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t} // End of switch.\r\n\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( objs_list[i].data[j].text ) {\r\n\t\t\t\t\t\tif ( objs_list[i].data[j].text[0] == ' ' ) {\r\n\t\t\t\t\t\t\ttExtra += ' xml:space=\"preserve\"';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\toutString += '<w:r' + rExtra + '>';\r\n\r\n\t\t\t\t\t\tif ( rPrData ) {\r\n\t\t\t\t\t\t\toutString += '<w:rPr>' + rPrData + '</w:rPr>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\toutString += '<w:t' + tExtra + '>' + objs_list[i].data[j].text.encodeHTML () + '</w:t></w:r>';\r\n\r\n\t\t\t\t\t} else if ( objs_list[i].data[j].page_break ) {\r\n\t\t\t\t\t\toutString += '<w:r><w:br w:type=\"page\"/></w:r>';\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t} else if ( objs_list[i].data[j].image ) {\r\n\t\t\t\t\t\toutString += '<w:r' + rExtra + '>';\r\n\r\n\t\t\t\t\t\trPrData += '<w:noProof/>';\r\n\r\n\t\t\t\t\t\tif ( rPrData ) {\r\n\t\t\t\t\t\t\toutString += '<w:rPr>' + rPrData + '</w:rPr>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\toutString += '<w:drawing>';\r\n\t\t\t\t\t\toutString += '<wp:inline distT=\"0\" distB=\"0\" distL=\"0\" distR=\"0\">';\r\n\t\t\t\t\t\toutString += '<wp:extent cx=\"' + (objs_list[i].data[j].options.cx * 10000) + '\" cy=\"' + (objs_list[i].data[j].options.cy * 10000) + '\"/>';\r\n\t\t\t\t\t\toutString += '<wp:effectExtent l=\"19050\" t=\"0\" r=\"9525\" b=\"0\"/>';\r\n\t\t\t\t\t\toutString += '<wp:docPr id=\"' + (objs_list[i].data[j].image_id + 1) + '\" name=\"Picture ' + objs_list[i].data[j].image_id + '\" descr=\"Picture ' + objs_list[i].data[j].image_id + '\"/>';\r\n\t\t\t\t\t\toutString += '<wp:cNvGraphicFramePr>';\r\n\t\t\t\t\t\toutString += '<a:graphicFrameLocks xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" noChangeAspect=\"1\"/>';\r\n\t\t\t\t\t\toutString += '</wp:cNvGraphicFramePr>';\r\n\t\t\t\t\t\toutString += '<a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\">';\r\n\t\t\t\t\t\toutString += '<a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/picture\">';\r\n\t\t\t\t\t\toutString += '<pic:pic xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\">';\r\n\t\t\t\t\t\toutString += '<pic:nvPicPr>';\r\n\t\t\t\t\t\toutString += '<pic:cNvPr id=\"0\" name=\"Picture ' + objs_list[i].data[j].image_id + '\"/>';\r\n\t\t\t\t\t\toutString += '<pic:cNvPicPr/>';\r\n\t\t\t\t\t\toutString += '</pic:nvPicPr>';\r\n\t\t\t\t\t\toutString += '<pic:blipFill>';\r\n\t\t\t\t\t\toutString += '<a:blip r:embed=\"rId' + objs_list[i].data[j].rel_id + '\" cstate=\"print\"/>';\r\n\t\t\t\t\t\toutString += '<a:stretch>';\r\n\t\t\t\t\t\toutString += '<a:fillRect/>';\r\n\t\t\t\t\t\toutString += '</a:stretch>';\r\n\t\t\t\t\t\toutString += '</pic:blipFill>';\r\n\t\t\t\t\t\toutString += '<pic:spPr>';\r\n\t\t\t\t\t\toutString += '<a:xfrm>';\r\n\t\t\t\t\t\toutString += '<a:off x=\"0\" y=\"0\"/>';\r\n\t\t\t\t\t\toutString += '<a:ext cx=\"' + objs_list[i].data[j].options.cx + '\" cy=\"' + objs_list[i].data[j].options.cy + '\"/>';\r\n\t\t\t\t\t\toutString += '</a:xfrm>';\r\n\t\t\t\t\t\toutString += '<a:prstGeom prst=\"rect\">';\r\n\t\t\t\t\t\toutString += '<a:avLst/>';\r\n\t\t\t\t\t\toutString += '</a:prstGeom>';\r\n\t\t\t\t\t\toutString += '</pic:spPr>';\r\n\t\t\t\t\t\toutString += '</pic:pic>';\r\n\t\t\t\t\t\toutString += '</a:graphicData>';\r\n\t\t\t\t\t\toutString += '</a:graphic>';\r\n\t\t\t\t\t\toutString += '</wp:inline>';\r\n\t\t\t\t\t\toutString += '</w:drawing>';\r\n\r\n\t\t\t\t\t\toutString += '</w:r>';\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\toutString += '</w:p>';\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '<w:p w:rsidR=\"00A02F19\" w:rsidRDefault=\"00A02F19\"/><w:sectPr w:rsidR=\"00A02F19\" w:rsidSect=\"00A02F19\"><w:pgSz w:w=\"12240\" w:h=\"15840\"/><w:pgMar w:top=\"1440\" w:right=\"1800\" w:bottom=\"1440\" w:left=\"1800\" w:header=\"720\" w:footer=\"720\" w:gutter=\"0\"/><w:cols w:space=\"720\"/><w:docGrid w:linePitch=\"360\"/></w:sectPr></w:body></w:document>';\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t// Prepare genobj for MS-Office:\r\n\tmsdoc.makemsdoc ( genobj, new_type, options, gen_private, type_info );\r\n\tgen_private.plugs.type.msoffice.makeOfficeGenerator ( 'word', 'document', {} );\r\n\r\n\tgenobj.on ( 'clearData', function () {\r\n\t\tgenobj.data.length = 0;\r\n\t});\r\n\r\n\tgen_private.plugs.type.msoffice.addInfoType ( 'dc:title', '', 'title', 'setDocTitle' );\r\n\tgen_private.plugs.type.msoffice.addInfoType ( 'dc:subject', '', 'subject', 'setDocSubject' );\r\n\tgen_private.plugs.type.msoffice.addInfoType ( 'cp:keywords', '', 'keywords', 'setDocKeywords' );\r\n\tgen_private.plugs.type.msoffice.addInfoType ( 'dc:description', '', 'description', 'setDescription' );\r\n\r\n\tgen_private.type.msoffice.files_list.push (\r\n\t\t{\r\n\t\t\tname: '/word/settings.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/word/fontTable.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/word/webSettings.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/word/styles.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/word/document.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml',\r\n\t\t\tclear: 'type'\r\n\t\t}\r\n\t);\r\n\r\n\tgen_private.type.msoffice.rels_app.push (\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles',\r\n\t\t\ttarget: 'styles.xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings',\r\n\t\t\ttarget: 'settings.xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/webSettings',\r\n\t\t\ttarget: 'webSettings.xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable',\r\n\t\t\ttarget: 'fontTable.xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\r\n\t\t\ttarget: 'theme/theme1.xml',\r\n\t\t\tclear: 'type'\r\n\t\t}\r\n\t);\r\n\r\n\tgenobj.data = []; // All the data will be placed here.\r\n\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'docProps\\\\app.xml', 'buffer', null, cbMakeDocxApp, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'word\\\\fontTable.xml', 'buffer', null, cbMakeDocxFontsTable, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'word\\\\settings.xml', 'buffer', null, cbMakeDocxSettings, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'word\\\\webSettings.xml', 'buffer', null, cbMakeDocxWeb, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'word\\\\styles.xml', 'buffer', null, cbMakeDocxStyles, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'word\\\\document.xml', 'buffer', genobj, cbMakeDocxDocument, true );\r\n\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'word\\\\_rels\\\\document.xml.rels', 'buffer', gen_private.type.msoffice.rels_app, gen_private.plugs.type.msoffice.cbMakeRels, true );\r\n\r\n\t// ----- API for Word documents: -----\r\n\r\n\t///\r\n\t/// @brief Create a new paragraph.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] options Default options for all the objects inside this paragraph.\r\n\t///\r\n\tgenobj.createP = function ( options ) {\r\n\t\tvar newP = {};\r\n\r\n\t\tnewP.data = [];\r\n\t\tnewP.options = options || {};\r\n\r\n\t\t///\r\n\t\t/// @brief Insert text inside this paragraph.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] text_msg The text message itself.\r\n\t\t/// @param[in] opt ???.\r\n\t\t/// @param[in] flag_data ???.\r\n\t\t///\r\n\t\tnewP.addText = function ( text_msg, opt, flag_data ) {\r\n\t\t\tnewP.data[newP.data.length] = { text: text_msg, options: opt || {}, ext_data: flag_data };\r\n\t\t};\r\n\r\n\t\t///\r\n\t\t/// @brief Insert an image into the current paragraph.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] image_path The image file to add.\r\n\t\t/// @param[in] opt Additional options (cx, cy).\r\n\t\t/// @param[in] image_format_type ???.\r\n\t\t///\r\n\t\tnewP.addImage = function ( image_path, opt, image_format_type ) {\r\n\t\t\tvar image_type = (typeof image_format_type == 'string') ? image_format_type : 'png';\r\n\t\t\tvar defWidth = 320;\r\n\t\t\tvar defHeight = 200;\r\n\r\n\t\t\tif ( typeof image_path == 'string' ) {\r\n\t\t\t\tvar ret_data = fast_image_size ( image_path );\r\n\t\t\t\tif ( ret_data.type == 'unknown' ) {\r\n\t\t\t\t\tvar image_ext = path.extname ( image_path );\r\n\r\n\t\t\t\t\tswitch ( image_ext ) {\r\n\t\t\t\t\t\tcase '.bmp':\r\n\t\t\t\t\t\t\timage_type = 'bmp';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '.gif':\r\n\t\t\t\t\t\t\timage_type = 'gif';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '.jpg':\r\n\t\t\t\t\t\tcase '.jpeg':\r\n\t\t\t\t\t\t\timage_type = 'jpeg';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '.emf':\r\n\t\t\t\t\t\t\timage_type = 'emf';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '.tiff':\r\n\t\t\t\t\t\t\timage_type = 'tiff';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} // End of switch.\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif ( ret_data.width ) {\r\n\t\t\t\t\t\tdefWidth = ret_data.width;\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( ret_data.height ) {\r\n\t\t\t\t\t\tdefHeight = ret_data.height;\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\timage_type = ret_data.type;\r\n\t\t\t\t\tif ( image_type == 'jpg' ) {\r\n\t\t\t\t\t\timage_type = 'jpeg';\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tvar objNum = newP.data.length;\r\n\t\t\tnewP.data[objNum] = { image: image_path, options: opt || {} };\r\n\r\n\t\t\tif ( !newP.data[objNum].options.cx && defWidth ) {\r\n\t\t\t\tnewP.data[objNum].options.cx = defWidth;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( !newP.data[objNum].options.cy && defHeight ) {\r\n\t\t\t\tnewP.data[objNum].options.cy = defHeight;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tvar image_id = gen_private.type.msoffice.src_files_list.indexOf ( image_path );\r\n\t\t\tvar image_rel_id = -1;\r\n\r\n\t\t\tif ( image_id >= 0 ) {\r\n\t\t\t\tfor ( var j = 0, total_size_j = gen_private.type.msoffice.rels_app.length; j < total_size_j; j++ ) {\r\n\t\t\t\t\tif ( gen_private.type.msoffice.rels_app[j].target == ('media/image' + (image_id + 1) + '.' + image_type) ) {\r\n\t\t\t\t\t\timage_rel_id = j + 1;\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // Endif.\r\n\t\t\t\r\n\t\t\t} else\r\n\t\t\t{\r\n\t\t\t\timage_id = gen_private.type.msoffice.src_files_list.length;\r\n\t\t\t\tgen_private.type.msoffice.src_files_list[image_id] = image_path;\r\n\t\t\t\tgen_private.plugs.intAddAnyResourceToParse ( 'word\\\\media\\\\image' + (image_id + 1) + '.' + image_type, (typeof image_path == 'string') ? 'file' : 'stream', image_path, null, false );\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( image_rel_id == -1 ) {\r\n\t\t\t\timage_rel_id = gen_private.type.msoffice.rels_app.length + 1;\r\n\r\n\t\t\t\tgen_private.type.msoffice.rels_app.push (\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image',\r\n\t\t\t\t\t\ttarget: 'media/image' + (image_id + 1) + '.' + image_type,\r\n\t\t\t\t\t\tclear: 'data'\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tnewP.data[objNum].image_id = image_id;\r\n\t\t\tnewP.data[objNum].rel_id = image_rel_id;\r\n\t\t};\r\n\r\n\t\tgenobj.data[genobj.data.length] = newP;\r\n\t\treturn newP;\r\n\t};\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] options ???.\r\n\t///\r\n\tgenobj.createListOfDots = function ( options ) {\r\n\t\tvar newP = genobj.createP ( options );\r\n\r\n\t\tnewP.options.list_type = '1';\r\n\r\n\t\treturn newP;\r\n\t};\r\n\r\n\t///\r\n\t/// @brief Create a list of numbers based paragraph.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] options ???.\r\n\t///\r\n\tgenobj.createListOfNumbers = function ( options ) {\r\n\t\tvar newP = genobj.createP ( options );\r\n\r\n\t\tnewP.options.list_type = '2';\r\n\r\n\t\treturn newP;\r\n\t};\r\n\r\n\t///\r\n\t/// @brief Add a page break.\r\n\t///\r\n\t/// This method add a page break to the current Word document.\r\n\t///\r\n\tgenobj.putPageBreak = function () {\r\n\t\tvar newP = {};\r\n\r\n\t\tnewP.data = [ { 'page_break': true } ];\r\n\r\n\t\tgenobj.data[genobj.data.length] = newP;\r\n\t\treturn newP;\r\n\t};\r\n}\r\n\r\nbaseobj.plugins.registerDocType ( 'docx', makeDocx, {}, baseobj.docType.TEXT, \"Microsoft Word Document\" );\r\n\r\n","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/Gruntfile.js":"module.exports = function(grunt) {\r\n\tvar path = require(\"path\");\r\n\t// Project configuration.\r\n\tgrunt.initConfig({\r\n\t\tpkg: grunt.file.readJSON('package.json'),\r\n\t\tcoffee: {\r\n\t\t\tdynamic_mappings: {\r\n\t\t\t    expand: true,\r\n\t\t\t    flatten: false,\r\n\t\t\t    cwd: 'src/',\r\n\t\t\t    src: ['**/*.coffee'],\r\n\t\t\t    dest: 'lib/',\r\n\t\t\t    ext: '.js'\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\twatch: {\r\n\t\t\tcoffee: {\r\n\t\t\t\tfiles: ['src/*.coffee'],\r\n\t\t\t\ttasks: 'coffee'\r\n\t\t\t},\r\n\t\t}\r\n\t});\r\n\t\r\n\tgrunt.event.on('watch', function(action, filepath, target) {\r\n\t\tconsole.log(filepath);\r\n        grunt.config(['coffee', 'dynamic_mappings', 'files', 'src'], filepath);\r\n    } );\r\n\t\r\n\t// Load the plugin that provides the \"less\" task.\r\n\r\n\tgrunt.loadNpmTasks('grunt-contrib-watch');\r\n\tgrunt.loadNpmTasks('grunt-contrib-coffee');\r\n\t\r\n\tgrunt.registerTask('default', ['coffee:dynamic_mappings', 'watch']);\r\n};","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/lib/genpptx_2013.js":"//\r\n// officegen: All the code to generate PPTX/PPTS files.\r\n//\r\n// Please refer to README.md for this module's documentations.\r\n//\r\n// NOTE:\r\n// - Before changing this code please refer to the hacking the code section on README.md.\r\n//\r\n// Copyright (c) 2013 Ziv Barber;\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files (the\r\n// 'Software'), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\r\n// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\r\n// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\nvar baseobj = require(\"./basicgen.js\");\r\nvar officeChart = require(\"./genofficechart.js\");\r\nvar msdoc = require(\"./msofficegen.js\");\r\nvar pptxShapes = require(\"./pptxshapes.js\");\r\n\r\nvar path = require('path');\r\n\r\nvar fast_image_size = require('fast-image-size');\r\n\r\nvar excelbuilder = require('./msexcel-builder.js');\r\n\r\nif ( !String.prototype.encodeHTML ) {\r\n\tString.prototype.encodeHTML = function () {\r\n\t\treturn this.replace(/&/g, '&amp;')\r\n\t\t\t.replace(/</g, '&lt;')\r\n\t\t\t.replace(/>/g, '&gt;')\r\n\t\t\t.replace(/\"/g, '&quot;');\r\n\t};\r\n}\r\n\r\nvar GLOBAL_CHART_COUNT = 0;\r\n\r\n///\r\n/// @brief Extend officegen object with PPTX/PPSX support.\r\n///\r\n/// This method extending the given officegen object to create PPTX/PPSX document.\r\n///\r\n/// @param[in] genobj The object to extend.\r\n/// @param[in] new_type The type of object to create.\r\n/// @param[in] options The object's options.\r\n/// @param[in] gen_private Access to the internals of this object.\r\n/// @param[in] type_info Additional information about this type.\r\n///\r\nfunction makePptx ( genobj, new_type, options, gen_private, type_info ) {\r\n\t///\r\n\t/// @brief Convert shape name to shape information.\r\n\t///\r\n\t/// This method convert the shape information reseived from the user to the real shape information object.\r\n\t///\r\n\t/// @param[in] shapeName Either the name of the shape or the shape information.\r\n\t/// @return Information about this shape.\r\n\t///\r\n\tfunction getShapeInfo ( shapeName ) {\r\n\t\tif ( !shapeName ) {\r\n\t\t\treturn pptxShapes.RECTANGLE;\r\n\t\t} // Endif.\r\n\r\n\t\tif ( (typeof shapeName == 'object') && shapeName.name && shapeName.displayName && shapeName.avLst ) {\r\n\t\t\treturn shapeName;\r\n\t\t} // Endif.\r\n\r\n\t\tif ( pptxShapes[shapeName] ) {\r\n\t\t\treturn pptxShapes[shapeName];\r\n\t\t} // Endif.\r\n\r\n\t\tfor ( var shapeIntName in pptxShapes ) {\r\n\t\t\tif ( pptxShapes[shapeIntName].name == shapeName ) {\r\n\t\t\t\treturn pptxShapes[shapeIntName];\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( pptxShapes[shapeIntName].displayName == shapeName ) {\r\n\t\t\t\treturn pptxShapes[shapeIntName];\r\n\t\t\t} // Endif.\r\n\t\t} // End of for loop.\r\n\r\n\t\treturn pptxShapes.RECTANGLE;\r\n\t}\r\n\r\n\tgenobj.shapes = pptxShapes;\r\n\r\n\t///\r\n\t/// @brief Create the 'presProps.xml' resource.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxPresProps ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + \r\n\t\t\r\n'<p:presentationPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">\\\r\n\t<p:extLst>\\\r\n\t\t<p:ext uri=\"{E76CE94A-603C-4142-B9EB-6D1370010A27}\">\\\r\n\t\t\t<p14:discardImageEditData xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"0\"/>\\\r\n\t\t</p:ext>\\\r\n\t\t<p:ext uri=\"{D31A062A-798A-4329-ABDD-BBA856620510}\">\\\r\n\t\t\t<p14:defaultImageDpi xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"220\"/>\\\r\n\t\t</p:ext>\\\r\n\t\t<p:ext uri=\"{FD5EFAAD-0ECE-453E-9831-46B23BE46B34}\">\\\r\n\t\t\t<p15:chartTrackingRefBased xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\" val=\"1\"/>\\\r\n\t\t</p:ext>\\\r\n\t</p:extLst>\\\r\n</p:presentationPr>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the 'tableStyles.xml' resource.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxStyles ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<a:tblStyleLst xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" def=\"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}\"/>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the 'viewProps.xml' resource.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxViewProps ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<p:viewPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:normalViewPr><p:restoredLeft sz=\"15620\"/><p:restoredTop sz=\"94660\"/></p:normalViewPr><p:slideViewPr><p:cSldViewPr><p:cViewPr varScale=\"1\"><p:scale><a:sx n=\"64\" d=\"100\"/><a:sy n=\"64\" d=\"100\"/></p:scale><p:origin x=\"-1392\" y=\"-96\"/></p:cViewPr><p:guideLst><p:guide orient=\"horz\" pos=\"2160\"/><p:guide pos=\"2880\"/></p:guideLst></p:cSldViewPr></p:slideViewPr><p:notesTextViewPr><p:cViewPr><p:scale><a:sx n=\"100\" d=\"100\"/><a:sy n=\"100\" d=\"100\"/></p:scale><p:origin x=\"0\" y=\"0\"/></p:cViewPr></p:notesTextViewPr><p:gridSpacing cx=\"78028800\" cy=\"78028800\"/></p:viewPr>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the 'slideLayout1.xml' resource.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxLayout ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<p:sldLayout xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" type=\"title\" preserve=\"1\"><p:cSld name=\"Title Slide\"><p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id=\"2\" name=\"Title 1\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ctrTitle\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"685800\" y=\"2130425\"/><a:ext cx=\"7772400\" cy=\"1470025\"/></a:xfrm></p:spPr><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"3\" name=\"Subtitle 2\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"subTitle\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"1371600\" y=\"3886200\"/><a:ext cx=\"6400800\" cy=\"1752600\"/></a:xfrm></p:spPr><p:txBody><a:bodyPr/><a:lstStyle><a:lvl1pPr marL=\"0\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"457200\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"914400\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1371600\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"1828800\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2286000\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2743200\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3200400\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3657600\" indent=\"0\" algn=\"ctr\"><a:buNone/><a:defRPr><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl9pPr></a:lstStyle><a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master subtitle style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"4\" name=\"Date Placeholder 3\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"dt\" sz=\"half\" idx=\"10\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:fld id=\"{F8166F1F-CE9B-4651-A6AA-CD717754106B}\" type=\"datetimeFigureOut\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>6/13/2013</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"5\" name=\"Footer Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"11\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"6\" name=\"Slide Number Placeholder 5\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"12\"/></p:nvPr></p:nvSpPr><p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:fld id=\"{F7021451-1387-4CA6-816F-3879F97B5CBC}\" type=\"slidenum\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>�#�</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp></p:spTree></p:cSld><p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr></p:sldLayout>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the main presentation resource.\r\n\t///\r\n\t/// This resource is the main resource of any PowerPoint document.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxPresentation ( data ) {\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<p:presentation xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" saveSubsetFonts=\"1\"><p:sldMasterIdLst><p:sldMasterId id=\"2147483648\" r:id=\"rId1\"/></p:sldMasterIdLst><p:sldIdLst>';\r\n\r\n\t\tfor ( var i = 0, total_size = gen_private.pages.length; i < total_size; i++ ) {\r\n\t\t\toutString += '<p:sldId id=\"' + (i + 256) + '\" r:id=\"rId' + (i + 2) + '\"/>';\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '</p:sldIdLst><p:sldSz cx=\"9144000\" cy=\"6858000\" type=\"screen4x3\"/><p:notesSz cx=\"6858000\" cy=\"9144000\"/><p:defaultTextStyle><a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>';\r\n\r\n\t\tvar curPos = 0;\r\n\t\tfor ( var i = 1; i < 10; i++ )\r\n\t\t{\r\n\t\t\toutString += '<a:lvl' + i + 'pPr marL=\"' + curPos + '\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl' + i + 'pPr>';\r\n\t\t\tcurPos += 457200;\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '</p:defaultTextStyle>';\r\n\t\t\r\n\t\toutString += '<p:extLst>\\\r\n\t\t<p:ext uri=\"{EFAFB233-063F-42B5-8137-9DF3F51BA10A}\">\\\r\n\t\t\t<p15:sldGuideLst xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\"/>\\\r\n\t\t</p:ext>\\\r\n\t</p:extLst></p:presentation>';\r\n\t\t\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the slides masters resource.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxSlideMasters ( data ) {\r\n\t\treturn gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<p:sldMaster xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:cSld><p:bg><p:bgRef idx=\"1001\"><a:schemeClr val=\"bg1\"/></p:bgRef></p:bg><p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id=\"2\" name=\"Title Placeholder 1\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"title\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"274638\"/><a:ext cx=\"8229600\" cy=\"1143000\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"><a:normAutofit/></a:bodyPr><a:lstStyle/><a:p><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master title style</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"3\" name=\"Text Placeholder 2\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"body\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"1600200\"/><a:ext cx=\"8229600\" cy=\"4525963\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\"><a:normAutofit/></a:bodyPr><a:lstStyle/><a:p><a:pPr lvl=\"0\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl=\"1\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl=\"2\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl=\"3\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl=\"4\"/><a:r><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>Fifth level</a:t></a:r><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"4\" name=\"Date Placeholder 3\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"dt\" sz=\"half\" idx=\"2\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"457200\" y=\"6356350\"/><a:ext cx=\"2133600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"l\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\"{F8166F1F-CE9B-4651-A6AA-CD717754106B}\" type=\"datetimeFigureOut\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>6/13/2013</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"5\" name=\"Footer Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"3\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"3124200\" y=\"6356350\"/><a:ext cx=\"2895600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"ctr\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"6\" name=\"Slide Number Placeholder 5\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"4\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"6553200\" y=\"6356350\"/><a:ext cx=\"2133600\" cy=\"365125\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle><a:lvl1pPr algn=\"r\"><a:defRPr sz=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"><a:tint val=\"75000\"/></a:schemeClr></a:solidFill></a:defRPr></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\"{F7021451-1387-4CA6-816F-3879F97B5CBC}\" type=\"slidenum\"><a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t>�#�</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp></p:spTree></p:cSld><p:clrMap bg1=\"lt1\" tx1=\"dk1\" bg2=\"lt2\" tx2=\"dk2\" accent1=\"accent1\" accent2=\"accent2\" accent3=\"accent3\" accent4=\"accent4\" accent5=\"accent5\" accent6=\"accent6\" hlink=\"hlink\" folHlink=\"folHlink\"/><p:sldLayoutIdLst><p:sldLayoutId id=\"2147483649\" r:id=\"rId1\"/></p:sldLayoutIdLst><p:txStyles><p:titleStyle><a:lvl1pPr algn=\"ctr\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"0\"/></a:spcBef><a:buNone/><a:defRPr sz=\"4400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mj-lt\"/><a:ea typeface=\"+mj-ea\"/><a:cs typeface=\"+mj-cs\"/></a:defRPr></a:lvl1pPr></p:titleStyle><p:bodyStyle><a:lvl1pPr marL=\"342900\" indent=\"-342900\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"3200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"742950\" indent=\"-285750\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"1143000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1600200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"2057400\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2514600\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2971800\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3429000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3886200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"�\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr></p:bodyStyle><p:otherStyle><a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr><a:lvl1pPr marL=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"457200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"914400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1371600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"1828800\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2286000\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2743200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3200400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3657600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr></p:otherStyle></p:txStyles></p:sldMaster>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Generate the XML code to describe colors.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] color_info Foreground color information.\r\n\t/// @param[in] back_info Background color information.\r\n\t///\r\n\tfunction cMakePptxColorSelection ( color_info, back_info )\r\n\t{\r\n\t\tvar outText = '';\r\n\t\tvar colorVal;\r\n\t\tvar fillType = 'solid';\r\n\t\tvar internalElements = '';\r\n\r\n\t\tif ( back_info ) {\r\n\t\t\toutText += '<p:bg><p:bgPr>';\r\n\r\n\t\t\toutText += cMakePptxColorSelection ( back_info, false );\r\n\r\n\t\t\toutText += '<a:effectLst/>';\r\n\t\t\t// BMK_TODO: (add support for effects)\r\n\t\t\t\r\n\t\t\toutText += '</p:bgPr></p:bg>';\r\n\t\t} // Endif.\r\n\r\n\t\tif ( color_info ) {\r\n\t\t\tif ( typeof color_info == 'string' ) {\r\n\t\t\t\tcolorVal = color_info;\r\n\r\n\t\t\t} else {\r\n\t\t\t\tif ( color_info.type ) {\r\n\t\t\t\t\tfillType = color_info.type;\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( color_info.color ) {\r\n\t\t\t\t\tcolorVal = color_info.color;\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( color_info.alpha ) {\r\n\t\t\t\t\tinternalElements += '<a:alpha val=\"' + (100 - color_info.alpha) + '000\"/>';\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tswitch ( fillType )\r\n\t\t\t{\r\n\t\t\t\tcase 'solid':\r\n\t\t\t\t\toutText += '<a:solidFill><a:srgbClr val=\"' + colorVal + '\">' + internalElements + '</a:srgbClr></a:solidFill>';\r\n\t\t\t\t\tbreak;\r\n\t\t\t} // End of switch.\r\n\t\t} // Endif.\r\n\r\n\t\treturn outText;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] text_info Information how to display the text.\r\n\t/// @param[in] slide_obj The object of this slider.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cMakePptxOutTextData ( text_info, slide_obj ) {\r\n\t\tvar out_obj = {};\r\n\r\n\t\tout_obj.font_size = '';\r\n\t\tout_obj.bold = '';\r\n\t\tout_obj.underline = '';\r\n\t\tout_obj.rpr_info = '';\r\n\r\n\t\tif ( typeof text_info == 'object' )\r\n\t\t{\r\n\t\t\tif ( text_info.bold ) {\r\n\t\t\t\tout_obj.bold = ' b=\"1\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( text_info.underline ) {\r\n\t\t\t\tout_obj.underline = ' u=\"sng\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( text_info.font_size ) {\r\n\t\t\t\tout_obj.font_size = ' sz=\"' + text_info.font_size + '00\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( text_info.color ) {\r\n\t\t\t\tout_obj.rpr_info += cMakePptxColorSelection ( text_info.color );\r\n\r\n\t\t\t} else if ( slide_obj && slide_obj.color )\r\n\t\t\t{\r\n\t\t\t\tout_obj.rpr_info += cMakePptxColorSelection ( slide_obj.color );\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( text_info.font_face ) {\r\n\t\t\t\tout_obj.rpr_info += '<a:latin typeface=\"' + text_info.font_face + '\" pitchFamily=\"34\" charset=\"0\"/><a:cs typeface=\"' + text_info.font_face + '\" pitchFamily=\"34\" charset=\"0\"/>';\r\n\t\t\t} // Endif.\r\n\r\n\t\t} else {\r\n\t\t\tif ( slide_obj && slide_obj.color )\r\n\t\t\t{\r\n\t\t\t\tout_obj.rpr_info += cMakePptxColorSelection ( slide_obj.color );\r\n\t\t\t} // Endif.\r\n\t\t} // Endif.\r\n\r\n\t\tif ( out_obj.rpr_info != '' )\r\n\t\t\tout_obj.rpr_info += '</a:rPr>';\r\n\r\n\t\treturn out_obj;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] text_info Information how to display the text.\r\n\t/// @param[in] text_string The text string.\r\n\t/// @param[in] slide_obj The object of this slider.\r\n\t/// @return The PPTX code.\r\n\t///\r\n\tfunction cMakePptxOutTextCommand ( text_info, text_string, slide_obj ) {\r\n\t\tvar area_opt_data = cMakePptxOutTextData ( text_info, slide_obj );\r\n\t\tvar outData = '<a:r><a:rPr lang=\"en-US\"' + area_opt_data.font_size + area_opt_data.bold + area_opt_data.underline + ' dirty=\"0\" smtClean=\"0\"' + (area_opt_data.rpr_info != '' ? ('>' + area_opt_data.rpr_info) : '/>') + '<a:t>';\r\n\r\n\t\t// Automatic support for newline - split it into multi-p:\r\n\t\tvar parsedText = text_string.split ( \"\\n\" );\r\n\t\tif ( parsedText.length > 1 ) {\r\n\t\t\tvar outTextData = '';\r\n\t\t\tfor ( var i = 0, total_size_i = parsedText.length; i < total_size_i; i++ ) {\r\n\t\t\t\toutTextData += outData + parsedText[i].encodeHTML ();\r\n\r\n\t\t\t\tif ( (i + 1) < total_size_i ) {\r\n\t\t\t\t\toutTextData += '</a:t></a:r></a:p><a:p>';\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // End of for loop.\r\n\r\n\t\t\toutData = outTextData;\r\n\r\n\t\t} else {\r\n\t\t\toutData += text_string.encodeHTML ();\r\n\t\t} // Endif.\r\n\r\n\t\tvar outBreakP = '';\r\n\t\tif ( text_info.breakLine ) {\r\n\t\t\toutBreakP += '</a:p><a:p>';\r\n\t\t} // Endif.\r\n\t\t\r\n\t\treturn outData + '</a:t></a:r>' + outBreakP;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief ???.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] in_data_val Input value as passed by the user.\r\n\t/// @param[in] max_value Maximum value allowed.\r\n\t/// @param[in] def_value Default value.\r\n\t/// @param[in] auto_val ???.\r\n\t/// @param[in] mul_val ???.\r\n\t/// @return ???.\r\n\t///\r\n\tfunction parseSmartNumber ( in_data_val, max_value, def_value, auto_val, mul_val ) {\t\r\n\t\tif ( typeof in_data_val == 'undefined' ) {\r\n\t\t\treturn (typeof def_value == 'number') ? def_value : 0;\r\n\t\t} // Endif.\r\n\r\n\t\tif ( in_data_val == '' ) {\r\n\t\t\tin_data_val = 0;\r\n\t\t} // Endif.\r\n\t\t\r\n\t\tif ( typeof in_data_val == 'string' && !isNaN ( in_data_val ) ) {\r\n\t\t\tin_data_val = parseInt ( in_data_val, 10 );\r\n\t\t} // Endif.\r\n\t\r\n\t\tvar realNum = mul_val ? in_data_val * mul_val : in_data_val;\r\n\r\n\t\tif ( typeof in_data_val == 'string' ) {\r\n\t\t\tif ( in_data_val.indexOf ( '%' ) != -1 ) {\r\n\t\t\t\tvar realMax = (typeof max_value == 'number') ? max_value : 0;\r\n\t\t\t\tif ( realMax <= 0 ) return 0;\r\n\r\n\t\t\t\tvar realVal = parseInt ( in_data_val, 10 );\r\n\t\t\t\treturn (realMax / 100) * realVal;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( in_data_val.indexOf ( '#' ) != -1 ) {\r\n\t\t\t\tvar realVal = parseInt ( in_data_val, 10 );\r\n\t\t\t\treturn realMax;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tvar realAuto = (typeof auto_val == 'number') ? auto_val : 0;\r\n\r\n\t\t\tif ( in_data_val == '*' ) {\r\n\t\t\t\treturn realAuto;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( in_data_val == 'c' ) {\r\n\t\t\t\treturn realAuto / 2;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\treturn (typeof def_value == 'number') ? def_value : 0;\r\n\t\t} // Endif.\r\n\t\r\n\t\tif ( typeof in_data_val == 'number' ) {\r\n\t\t\treturn realNum;\r\n\t\t} // Endif.\r\n\r\n\t\treturn (typeof def_value == 'number') ? def_value : 0;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the XML code of a single effect.\r\n\t///\r\n\t/// This method creating the effect XML code for a single object.\r\n\t///\r\n\t/// @param[in] effectData Effect data.\r\n\t/// @param[in] effectName The name of the effect.\r\n\t///\r\n\tfunction cbGenerateEffects ( effectData, effectName ) {\r\n\t\tvar outData = '<a:' + effectName + ' ';\r\n\t\tvar color = effectData.color || 'black';\r\n\t\tvar alphaPer = 60;\r\n\t\tvar algnData = '';\r\n\t\tvar blurRad = 50800;\r\n\t\tvar dist = 38100;\r\n\t\tvar dir = 13500000;\r\n\r\n\t\tif ( typeof effectData.transparency == 'number' ) {\r\n\t\t\talphaPer = effectData.transparency;\r\n\t\t} // Endif.\r\n\r\n\t\tif ( (alphaPer > 100) || (alphaPer < 0) )\r\n\t\t\talphaPer = 60;\r\n\r\n\t\talphaPer = (100 - alphaPer) * 1000;\r\n\r\n\t\tif ( effectData.align ) {\r\n\t\t\tif ( effectData.align.top )\r\n\t\t\t\talgnData += 't';\r\n\r\n\t\t\tif ( effectData.align.bottom )\r\n\t\t\t\talgnData += 'b';\r\n\r\n\t\t\tif ( effectData.align.left )\r\n\t\t\t\talgnData += 'l';\r\n\r\n\t\t\tif ( effectData.align.right )\r\n\t\t\t\talgnData += 'r';\r\n\t\t} // Endif.\r\n\r\n\t\tif ( algnData == '' )\r\n\t\t\talgnData = 'br';\r\n\r\n\t\t// Size\r\n\t\t// Blur\r\n\t\t// Angle\r\n\t\t// Distance\r\n\t\t// BMK_TODO:\r\n\r\n\t\toutData += ' blurRad=\"' + blurRad + '\" dist=\"' + dist + '\" dir=\"' + dir + '\" algn=\"' + algnData + '\" rotWithShape=\"0\"';\r\n\r\n\t\t// sx=\"24000\" sy=\"24000\"\r\n\t\t// BMK_TODO:\r\n\r\n\t\toutData += '><a:prstClr val=\"' + color + '\"><a:alpha val=\"' + alphaPer + '\"/></a:prstClr>';\r\n\t\treturn outData + '</a:' + effectName + '>';\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Create the body properties code for text.\r\n\t///\r\n\t/// This method creating the XML code of the body properties of a text.\r\n\t///\r\n\t/// @return The body properties XML code.\r\n\t///\r\n\tfunction createBodyProperties ( objOptions ) {\r\n\t\tvar bodyProperties = '<a:bodyPr';\r\n\r\n\t\tif ( objOptions && objOptions.bodyProp ) {\r\n\t\t\t// Set anchorPoints bottom, center or top:\r\n\t\t\tif ( objOptions.bodyProp.anchor ) {\r\n\t\t\t\tbodyProperties += ' anchor=\"' + objOptions.bodyProp.anchor + '\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( objOptions.bodyProp.anchorCtr ) {\r\n\t\t\t\tbodyProperties += ' anchorCtr=\"' + objOptions.bodyProp.anchorCtr + '\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\t// Enable or disable textwrapping none or square:\r\n\t\t\tif ( objOptions.bodyProp.wrap ) {\r\n\t\t\t\tbodyProperties += ' wrap=\"' + objOptions.bodyProp.wrap + '\"';\r\n\r\n\t\t\t} else {\r\n\t\t\t\tbodyProperties += ' wrap=\"square\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\t// Box margins(padding):\r\n\t\t\t// BMK_TODO: I should pass a better value as the auto_val parameter of parseSmartNumber().\r\n\t\t\tif ( objOptions.bodyProp.bIns ) {\r\n\t\t\t\tbodyProperties += ' bIns=\"' + parseSmartNumber ( objOptions.bodyProp.bIns, 6858000, 369332, 6858000, 10000 ) + '\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( objOptions.bodyProp.lIns ) {\r\n\t\t\t\tbodyProperties += ' lIns=\"' + parseSmartNumber ( objOptions.bodyProp.lIns, 9144000, 2819400, 9144000, 10000 ) + '\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( objOptions.bodyProp.rIns ) {\r\n\t\t\t\tbodyProperties += ' rIns=\"' + parseSmartNumber ( objOptions.bodyProp.rIns, 9144000, 2819400, 9144000, 10000 ) + '\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( objOptions.bodyProp.tIns ) {\r\n\t\t\t\tbodyProperties += ' tIns=\"' + parseSmartNumber ( objOptions.bodyProp.tIns, 6858000, 369332, 6858000, 10000 ) + '\"';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tbodyProperties += ' rtlCol=\"0\">';\r\n\r\n\t\t\tif ( objOptions.bodyProp.autoFit !== false ) {\r\n\t\t\t\tbodyProperties += '<a:spAutoFit/>';\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tbodyProperties += '</a:bodyPr>';\r\n\r\n\t\t// Default:\r\n\t\t} else {\r\n\t\t\tbodyProperties += ' wrap=\"square\" rtlCol=\"0\"></a:bodyPr>';\r\n\t\t} // Endif.\r\n\r\n\t\treturn bodyProperties;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Generate a slider resource.\r\n\t///\r\n\t/// This function generating a slider XML resource.\r\n\t///\r\n\t/// @param[in] data The main slide object.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxSlide ( data ) {\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<p:sld xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"';\r\n\t\tvar objs_list = data.data;\r\n\t\tvar timingData = '';\r\n\r\n\t\tif ( !data.slide.show ) {\r\n\t\t\toutString += ' show=\"0\"';\r\n\t\t} // Endif.\r\n\r\n\t\toutString += '><p:cSld>';\r\n\r\n\t\tif ( data.slide.back ) {\r\n\t\t\toutString += cMakePptxColorSelection ( false, data.slide.back );\r\n\t\t} // Endif.\r\n\r\n\t\toutString += '<p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr>';\r\n\r\n\t\t// Loop on all the objects inside the slide to add it into the slide:\r\n\t\tfor ( var i = 0, total_size = objs_list.length; i < total_size; i++ ) {\r\n\t\t\tvar x = 0;\r\n\t\t\tvar y = 0;\r\n\t\t\tvar cx = 2819400;\r\n\t\t\tvar cy = 369332;\r\n\r\n\t\t\tvar moreStyles = '';\r\n\t\t\tvar moreStylesAttr = '';\r\n\t\t\tvar outStyles = '';\r\n\t\t\tvar styleData = '';\r\n\t\t\tvar shapeType = null;\r\n\t\t\tvar locationAttr = '';\r\n\r\n\t\t\tif ( objs_list[i].options ) {\r\n\t\t\t\tif ( typeof objs_list[i].options.cx != 'undefined' ) {\r\n\t\t\t\t\tif ( objs_list[i].options.cx ) {\r\n\t\t\t\t\t\tcx = parseSmartNumber ( objs_list[i].options.cx, 9144000, 2819400, 9144000, 10000 );\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcx = 1;\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( typeof objs_list[i].options.cy != 'undefined' ) {\r\n\t\t\t\t\tif ( objs_list[i].options.cy ) {\r\n\t\t\t\t\t\tcy = parseSmartNumber ( objs_list[i].options.cy, 6858000, 369332, 6858000, 10000 );\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcy = 1;\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( objs_list[i].options.x ) {\r\n\t\t\t\t\tx = parseSmartNumber ( objs_list[i].options.x, 9144000, 0, 9144000 - cx, 10000 );\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( objs_list[i].options.y ) {\r\n\t\t\t\t\ty = parseSmartNumber ( objs_list[i].options.y, 6858000, 0, 6858000 - cy, 10000 );\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( objs_list[i].options.shape ) {\r\n\t\t\t\t\tshapeType = getShapeInfo ( objs_list[i].options.shape );\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( objs_list[i].options.flip_vertical ) {\r\n\t\t\t\t\tlocationAttr += ' flipV=\"1\"';\r\n\t\t\t\t} // Endif.\r\n\r\n\t\t\t\tif ( objs_list[i].options.rotate ) {\r\n\t\t\t\t\tvar rotateVal = objs_list[i].options.rotate > 360 ? (objs_list[i].options.rotate - 360) : objs_list[i].options.rotate;\r\n\t\t\t\t\trotateVal *= 60000;\r\n\t\t\t\t\tlocationAttr += ' rot=\"' + rotateVal + '\"';\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tswitch ( objs_list[i].type ) {\r\n\t\t\t\t// TODO: remove hard code here\r\n\t\t\t\tcase 'chart':\r\n\t\t\t\t\t// loop through the charts\r\n\t\t\t\t\t// \r\n\r\n\t\t\t\t\tif( objs_list[i].renderType === 'pie' )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toutString += '<p:graphicFrame>\\\r\n\t\t\t\t\t\t\t<p:nvGraphicFramePr>\\\r\n\t\t\t\t\t\t\t\t<p:cNvPr id=\"20\" name=\"Chart 19\"/>\\\r\n\t\t\t\t\t\t\t\t<p:cNvGraphicFramePr/>\\\r\n\t\t\t\t\t\t\t\t<p:nvPr>\\\r\n\t\t\t\t\t\t\t\t\t<p:extLst>\\\r\n\t\t\t\t\t\t\t\t\t\t<p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\">\\\r\n\t\t\t\t\t\t\t\t\t\t\t<p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"4198609065\"/>\\\r\n\t\t\t\t\t\t\t\t\t\t</p:ext>\\\r\n\t\t\t\t\t\t\t\t\t</p:extLst>\\\r\n\t\t\t\t\t\t\t\t</p:nvPr>\\\r\n\t\t\t\t\t\t\t</p:nvGraphicFramePr>\\\r\n\t\t\t\t\t\t\t<p:xfrm>\\\r\n\t\t\t\t\t\t\t\t<a:off x=\"1524000\" y=\"1397000\"/>\\\r\n\t\t\t\t\t\t\t\t<a:ext cx=\"6096000\" cy=\"4064000\"/>\\\r\n\t\t\t\t\t\t\t</p:xfrm>\\\r\n\t\t\t\t\t\t\t<a:graphic>\\\r\n\t\t\t\t\t\t\t\t<a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\">\\\r\n\t\t\t\t\t\t\t\t\t<c:chart xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" r:id=\"rId2\"/>\\\r\n\t\t\t\t\t\t\t\t</a:graphicData>\\\r\n\t\t\t\t\t\t\t</a:graphic>\\\r\n\t\t\t\t\t\t</p:graphicFrame>'\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if( objs_list[i].renderType === 'column' )\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toutString += '\\\r\n\t\t\t\t\t\t\\\r\n\t\t\t\t\t\t<p:graphicFrame>\\\r\n\t\t\t\t\t\t\t<p:nvGraphicFramePr>\\\r\n\t\t\t\t\t\t\t\t<p:cNvPr id=\"4\" name=\"Chart 3\"/>\\\r\n\t\t\t\t\t\t\t\t<p:cNvGraphicFramePr/>\\\r\n\t\t\t\t\t\t\t\t<p:nvPr>\\\r\n\t\t\t\t\t\t\t\t\t<p:extLst>\\\r\n\t\t\t\t\t\t\t\t\t\t<p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\">\\\r\n\t\t\t\t\t\t\t\t\t\t\t<p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1256887135\"/>\\\r\n\t\t\t\t\t\t\t\t\t\t</p:ext>\\\r\n\t\t\t\t\t\t\t\t\t</p:extLst>\\\r\n\t\t\t\t\t\t\t\t</p:nvPr>\\\r\n\t\t\t\t\t\t\t</p:nvGraphicFramePr>\\\r\n\t\t\t\t\t\t\t<p:xfrm>\\\r\n\t\t\t\t\t\t\t\t<a:off x=\"1524000\" y=\"1397000\"/>\\\r\n\t\t\t\t\t\t\t\t<a:ext cx=\"6096000\" cy=\"4064000\"/>\\\r\n\t\t\t\t\t\t\t</p:xfrm>\\\r\n\t\t\t\t\t\t\t<a:graphic>\\\r\n\t\t\t\t\t\t\t\t<a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\">\\\r\n\t\t\t\t\t\t\t\t\t<c:chart xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" r:id=\"rId2\"/>\\\r\n\t\t\t\t\t\t\t\t</a:graphicData>\\\r\n\t\t\t\t\t\t\t</a:graphic>\\\r\n\t\t\t\t\t\t</p:graphicFrame>\\\r\n\t\t\t\t\t\t'\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'text':\r\n\t\t\t\tcase 'cxn':\r\n\t\t\t\t\tvar effectsList = '';\r\n\r\n\t\t\t\t\tif ( shapeType == null ) shapeType = getShapeInfo ( null );\r\n\r\n\t\t\t\t\t// if ( objs_list[i].type == 'text' ) {\r\n\t\t\t\t\t// \tif ( !objs_list[i].options || (!objs_list[i].options.cx && !objs_list[i].options.cx) ) {\r\n\t\t\t\t\t// \t\tobjs_list[i].options = objs_list[i].options ? objs_list[i].options : {};\r\n\t\t\t\t\t// \t\tobjs_list[i].options.bodyProp = objs_list[i].options.bodyProp ? objs_list[i].options.bodyProp : {};\r\n\t\t\t\t\t// \t\tobjs_list[i].options.bodyProp.autoFit = true;\r\n\t\t\t\t\t// \t\tcx = 9144000 - x;\r\n\t\t\t\t\t// \t\tcy = 6858000 - y;\r\n\t\t\t\t\t// \t} // Endif.\r\n\t\t\t\t\t// } // Endif.\r\n\r\n\t\t\t\t\tif ( objs_list[i].type == 'cxn' ) {\r\n\t\t\t\t\t\toutString += '<p:cxnSp><p:nvCxnSpPr>';\r\n\t\t\t\t\t\toutString += '<p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:nvPr/></p:nvCxnSpPr>';\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toutString += '<p:sp><p:nvSpPr>';\r\n\t\t\t\t\t\toutString += '<p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvSpPr txBox=\"1\"/><p:nvPr/></p:nvSpPr>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\toutString += '<p:spPr>';\r\n\r\n\t\t\t\t\toutString += '<a:xfrm' + locationAttr + '>';\r\n\r\n\t\t\t\t\toutString += '<a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm><a:prstGeom prst=\"' + shapeType.name + '\"><a:avLst/></a:prstGeom>';\r\n\r\n\t\t\t\t\tif ( objs_list[i].options ) {\r\n\t\t\t\t\t\tif ( objs_list[i].options.fill ) {\r\n\t\t\t\t\t\t\toutString += cMakePptxColorSelection ( objs_list[i].options.fill );\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\toutString += '<a:noFill/>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tif ( objs_list[i].options.line ) {\r\n\t\t\t\t\t\t\tvar lineAttr = '';\r\n\r\n\t\t\t\t\t\t\tif ( objs_list[i].options.line_size ) {\r\n\t\t\t\t\t\t\t\tlineAttr += ' w=\"' + (objs_list[i].options.line_size * 12700) + '\"';\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\t// cmpd=\"dbl\"\r\n\r\n\t\t\t\t\t\t\toutString += '<a:ln' + lineAttr + '>';\r\n\t\t\t\t\t\t\toutString += cMakePptxColorSelection ( objs_list[i].options.line );\r\n\r\n\t\t\t\t\t\t\tif ( objs_list[i].options.line_head ) {\r\n\t\t\t\t\t\t\t\toutString += '<a:headEnd type=\"' + objs_list[i].options.line_head + '\"/>';\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\tif ( objs_list[i].options.line_tail ) {\r\n\t\t\t\t\t\t\t\toutString += '<a:tailEnd type=\"' + objs_list[i].options.line_tail + '\"/>';\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\toutString += '</a:ln>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toutString += '<a:noFill/>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( objs_list[i].options.effects ) {\r\n\t\t\t\t\t\tfor ( var ii = 0, total_size_ii = objs_list[i].options.effects.length; ii < total_size_ii; ii++ ) {\r\n\t\t\t\t\t\t\tswitch ( objs_list[i].options.effects[ii].type ) {\r\n\t\t\t\t\t\t\t\tcase 'outerShadow':\r\n\t\t\t\t\t\t\t\t\teffectsList += cbGenerateEffects ( objs_list[i].options.effects[ii], 'outerShdw' );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase 'innerShadow':\r\n\t\t\t\t\t\t\t\t\teffectsList += cbGenerateEffects ( objs_list[i].options.effects[ii], 'innerShdw' );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t} // End of switch.\r\n\t\t\t\t\t\t} // End of for loop.\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( effectsList != '' ) {\r\n\t\t\t\t\t\toutString += '<a:effectLst>' + effectsList + '</a:effectLst>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\toutString += '</p:spPr>';\r\n\r\n\t\t\t\t\tif ( objs_list[i].options ) {\r\n\t\t\t\t\t\tif ( objs_list[i].options.align ) {\r\n\t\t\t\t\t\t\tswitch ( objs_list[i].options.align )\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcase 'right':\r\n\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' algn=\"r\"';\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase 'center':\r\n\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' algn=\"ctr\"';\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase 'justify':\r\n\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' algn=\"just\"';\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t} // End of switch.\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tif ( objs_list[i].options.indentLevel > 0 ) {\r\n\t\t\t\t\t\t\t\tmoreStylesAttr += ' lvl=\"' + objs_list[i].options.indentLevel + '\"';\r\n\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( moreStyles != '' ) {\r\n\t\t\t\t\t\toutStyles = '<a:pPr' + moreStylesAttr + '>' + moreStyles + '</a:pPr>';\r\n\r\n\t\t\t\t\t} else if ( moreStylesAttr != '' ) {\r\n\t\t\t\t\t\toutStyles = '<a:pPr' + moreStylesAttr + '/>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( styleData != '' ) {\r\n\t\t\t\t\t\toutString += '<p:style>' + styleData + '</p:style>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( typeof objs_list[i].text == 'string' ) {\r\n\t\t\t\t\t\toutString += '<p:txBody>' + createBodyProperties ( objs_list[i].options ) + '<a:lstStyle/><a:p>' + outStyles;\r\n\t\t\t\t\t\toutString += cMakePptxOutTextCommand ( objs_list[i].options, objs_list[i].text, data.slide );\r\n\r\n\t\t\t\t\t} else if ( objs_list[i].text ) {\r\n\t\t\t\t\t\tvar outBodyOpt = createBodyProperties ( objs_list[i].options );\r\n\t\t\t\t\t\toutString += '<p:txBody>' + outBodyOpt + '<a:lstStyle/><a:p>' + outStyles;\r\n\r\n\t\t\t\t\t\tfor ( var j = 0, total_size_j = objs_list[i].text.length; j < total_size_j; j++ ) {\r\n\t\t\t\t\t\t\tif ( objs_list[i].text[j] ) {\r\n\t\t\t\t\t\t\t\toutString += cMakePptxOutTextCommand ( objs_list[i].text[j].options, objs_list[i].text[j].text, data.slide, outBodyOpt, outStyles );\r\n\t\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( typeof objs_list[i].text != 'undefined' ) {\r\n\t\t\t\t\t\tvar font_size = '';\r\n\t\t\t\t\t\tif ( objs_list[i].options && objs_list[i].options.font_size ) {\r\n\t\t\t\t\t\t\tfont_size = ' sz=\"' + objs_list[i].options.font_size + '00\"';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\toutString += '<a:endParaRPr lang=\"en-US\"' + font_size + ' dirty=\"0\"/></a:p></p:txBody>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\toutString += objs_list[i].type == 'cxn' ? '</p:cxnSp>' : '</p:sp>';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t// Table:\r\n\t\t\t\tcase 'table':\r\n\t\t\t\t\toutString += '<p:graphicFrame><p:nvGraphicFramePr><p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvGraphicFramePr><a:graphicFrameLocks noGrp=\"1\"/></p:cNvGraphicFramePr><p:nvPr/></p:nvGraphicFramePr>';\r\n\t\t\t\t\toutString += '<p:xfrm><a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></p:xfrm>';\r\n\t\t\t\t\toutString += '<a:graphic><a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/table\"><a:tbl><a:tblPr firstRow=\"1\" bandRow=\"1\"><a:tableStyleId>{073A0DAA-6AF3-43AB-8588-CEC1D06C72B9}</a:tableStyleId></a:tblPr><a:tblGrid>';\r\n\t\t\t\t\t// <a:gridCol w=\"3276600\"/>\r\n\t\t\t\t\toutString += '</a:tblGrid>';\r\n\t\t\t\t\t// objs_list[i].options\r\n\t\t\t\t\t// objs_list[i].rows[][].text\r\n\t\t\t\t\t// BMK_TODO:\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t// Image:\r\n\t\t\t\tcase 'image':\r\n\t\t\t\t\toutString += '<p:pic><p:nvPicPr><p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr><p:nvPr/></p:nvPicPr><p:blipFill><a:blip r:embed=\"rId' + objs_list[i].rel_id + '\" cstate=\"print\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill><p:spPr><a:xfrm' + locationAttr + '><a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr></p:pic>';\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t// Paragraph:\r\n\t\t\t\tcase 'p':\r\n\t\t\t\t\tif ( shapeType == null ) shapeType = getShapeInfo ( null );\r\n\r\n\t\t\t\t\toutString += '<p:sp><p:nvSpPr>';\r\n\t\t\t\t\toutString += '<p:cNvPr id=\"' + (i + 2) + '\" name=\"Object ' + (i + 1) + '\"/><p:cNvSpPr txBox=\"1\"/><p:nvPr/></p:nvSpPr>';\r\n\t\t\t\t\toutString += '<p:spPr>';\r\n\r\n\t\t\t\t\toutString += '<a:xfrm' + locationAttr + '>';\r\n\r\n\t\t\t\t\toutString += '<a:off x=\"' + x + '\" y=\"' + y + '\"/><a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm><a:prstGeom prst=\"' + shapeType.name + '\"><a:avLst/></a:prstGeom>';\r\n\r\n\t\t\t\t\tif ( objs_list[i].options ) {\r\n\t\t\t\t\t\tif ( objs_list[i].options.fill ) {\r\n\t\t\t\t\t\t\toutString += cMakePptxColorSelection ( objs_list[i].options.fill );\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\toutString += '<a:noFill/>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\tif ( objs_list[i].options.line ) {\r\n\t\t\t\t\t\t\toutString += '<a:ln>';\r\n\t\t\t\t\t\t\toutString += cMakePptxColorSelection ( objs_list[i].options.line );\r\n\r\n\t\t\t\t\t\t\tif ( objs_list[i].options.line_head ) {\r\n\t\t\t\t\t\t\t\toutString += '<a:headEnd type=\"' + objs_list[i].options.line_head + '\"/>';\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\tif ( objs_list[i].options.line_tail ) {\r\n\t\t\t\t\t\t\t\toutString += '<a:tailEnd type=\"' + objs_list[i].options.line_tail + '\"/>';\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\toutString += '</a:ln>';\r\n\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\toutString += '<a:noFill/>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\toutString += '</p:spPr>';\r\n\r\n\t\t\t\t\tif ( styleData != '' ) {\r\n\t\t\t\t\t\toutString += '<p:style>' + styleData + '</p:style>';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\toutString += '<p:txBody><a:bodyPr wrap=\"square\" rtlCol=\"0\"><a:spAutoFit/></a:bodyPr><a:lstStyle/>';\r\n\r\n\t\t\t\t\tfor ( var j = 0, total_size_j = objs_list[i].data.length; j < total_size_j; j++ ) {\r\n\t\t\t\t\t\tif ( objs_list[i].data[j] ) {\r\n\t\t\t\t\t\t\tmoreStylesAttr = '';\r\n\t\t\t\t\t\t\tmoreStyles = '';\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif ( objs_list[i].data[j].options ) {\r\n\t\t\t\t\t\t\t\tif ( objs_list[i].data[j].options.align ) {\r\n\t\t\t\t\t\t\t\t\tswitch ( objs_list[i].data[j].options.align )\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tcase 'right':\r\n\t\t\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' algn=\"r\"';\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 'center':\r\n\t\t\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' algn=\"ctr\"';\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 'justify':\r\n\t\t\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' algn=\"just\"';\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t} // End of switch.\r\n\t\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\t\tif ( objs_list[i].data[j].options.indentLevel > 0 ) {\r\n\t\t\t\t\t\t\t\t\tmoreStylesAttr += ' lvl=\"' + objs_list[i].data[j].options.indentLevel + '\"';\r\n\t\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\t\tif ( objs_list[i].data[j].options.listType == 'number' ) {\r\n\t\t\t\t\t\t\t\t\tmoreStyles += '<a:buFont typeface=\"+mj-lt\"/><a:buAutoNum type=\"arabicPeriod\"/>';\r\n\t\t\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\tif ( moreStyles != '' ) {\r\n\t\t\t\t\t\t\t\toutStyles = '<a:pPr' + moreStylesAttr + '>' + moreStyles + '</a:pPr>';\r\n\r\n\t\t\t\t\t\t\t} else if ( moreStylesAttr != '' ) {\r\n\t\t\t\t\t\t\t\toutStyles = '<a:pPr' + moreStylesAttr + '/>';\r\n\t\t\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\t\t\toutString += '<a:p>' + outStyles;\r\n\r\n\t\t\t\t\t\t\t// if ( typeof objs_list[i].data[j].text == 'string' ) {\r\n\t\t\t\t\t\t\toutString += cMakePptxOutTextCommand ( objs_list[i].data[j].options, objs_list[i].data[j].text, data.slide );\r\n\t\t\t\t\t\t\t// BMK_TODO:\r\n\t\t\t\t\t\t} // Endif.\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tvar font_size = '';\r\n\t\t\t\t\tif ( objs_list[i].options && objs_list[i].options.font_size ) {\r\n\t\t\t\t\t\tfont_size = ' sz=\"' + objs_list[i].options.font_size + '00\"';\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\toutString += '<a:endParaRPr lang=\"en-US\"' + font_size + ' dirty=\"0\"/></a:p>';\r\n\t\t\t\t\toutString += '</p:txBody>';\r\n\r\n\t\t\t\t\toutString += '</p:sp>';\r\n\t\t\t\t\tbreak;\r\n\t\t\t} // End of switch.\r\n\t\t} // End of for loop.\r\n\t\t\r\n\t\toutString += '</p:spTree></p:cSld><p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr>';\r\n\r\n\t\tif ( timingData != '' ) {\r\n\t\t\toutString += '<p:timing>' + timingData + '</p:timing>';\r\n\t\t} // Endif.\r\n\r\n\t\toutString += '</p:sld>';\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Generate the extended attributes file (app) for PPTX/PPSX documents.\r\n\t///\r\n\t/// ???.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction cbMakePptxApp ( data ) {\r\n\t\tvar slidesCount = gen_private.pages.length;\r\n\t\tvar userName = genobj.options.creator || 'officegen';\r\n\t\tvar outString = gen_private.plugs.type.msoffice.cbMakeMsOfficeBasicXml ( data ) + '<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\"><TotalTime>0</TotalTime><Words>0</Words><Application>Microsoft Office PowerPoint</Application><PresentationFormat>On-screen Show (4:3)</PresentationFormat><Paragraphs>0</Paragraphs><Slides>' + slidesCount + '</Slides><Notes>0</Notes><HiddenSlides>0</HiddenSlides><MMClips>0</MMClips><ScaleCrop>false</ScaleCrop><HeadingPairs><vt:vector size=\"4\" baseType=\"variant\"><vt:variant><vt:lpstr>Theme</vt:lpstr></vt:variant><vt:variant><vt:i4>1</vt:i4></vt:variant><vt:variant><vt:lpstr>Slide Titles</vt:lpstr></vt:variant><vt:variant><vt:i4>' + slidesCount + '</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size=\"' + (slidesCount + 1) + '\" baseType=\"lpstr\"><vt:lpstr>Office Theme</vt:lpstr>';\r\n\r\n\t\tfor ( var i = 0, total_size = gen_private.pages.length; i < total_size; i++ ) {\r\n\t\t\toutString += '<vt:lpstr>' + gen_private.pages[i].slide.name.encodeHTML () + '</vt:lpstr>';\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '</vt:vector></TitlesOfParts><Company>' + userName + '</Company><LinksUpToDate>false</LinksUpToDate><SharedDoc>false</SharedDoc><HyperlinksChanged>false</HyperlinksChanged><AppVersion>12.0000</AppVersion></Properties>';\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Convert the chart object into xml string\r\n\t///\r\n\t/// @param[in] data \r\n\t/// @return Text Xml string.\r\n\t///\r\n\tfunction cbMakeCharts ( data ) {\r\n\t\tif( data['renderType'] === 'pie' )\r\n\t\t{\r\n\t\t\treturn officeChart.makePieChartStringFromData( data);\r\n\t\t}\r\n\t\telse if( data['renderType'] === 'column' )\r\n    {\r\n\t\t\treturn officeChart.makeColumnChartStringFromData( data);\r\n    }\r\n    else if( data['renderType'] === 'bar' )\r\n    {\r\n\t\t\treturn officeChart.makeBarChartStringFromData( data);\r\n    }\r\n\t}\r\n\t\r\n\tfunction cbMakeChartColors ( data ) {\r\n\t\treturn '<cs:colorStyle xmlns:cs=\"http://schemas.microsoft.com/office/drawing/2012/chartStyle\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" meth=\"cycle\" id=\"10\"><a:schemeClr val=\"accent1\"/><a:schemeClr val=\"accent2\"/><a:schemeClr val=\"accent3\"/><a:schemeClr val=\"accent4\"/><a:schemeClr val=\"accent5\"/><a:schemeClr val=\"accent6\"/><cs:variation/><cs:variation><a:lumMod val=\"60000\"/></cs:variation><cs:variation><a:lumMod val=\"80000\"/><a:lumOff val=\"20000\"/></cs:variation><cs:variation><a:lumMod val=\"80000\"/></cs:variation><cs:variation><a:lumMod val=\"60000\"/><a:lumOff val=\"40000\"/></cs:variation><cs:variation><a:lumMod val=\"50000\"/></cs:variation><cs:variation><a:lumMod val=\"70000\"/><a:lumOff val=\"30000\"/></cs:variation><cs:variation><a:lumMod val=\"70000\"/></cs:variation><cs:variation><a:lumMod val=\"50000\"/><a:lumOff val=\"50000\"/></cs:variation></cs:colorStyle>'\r\n\t}\r\n\t\r\n\tfunction cbMakeChartStyle ( data ) {\r\n\t\treturn '<cs:chartStyle xmlns:cs=\"http://schemas.microsoft.com/office/drawing/2012/chartStyle\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" id=\"201\"><cs:axisTitle><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></cs:fontRef><cs:defRPr sz=\"1330\" kern=\"1200\"/></cs:axisTitle><cs:categoryAxis><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></cs:fontRef><cs:spPr><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"15000\"/><a:lumOff val=\"85000\"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz=\"1197\" kern=\"1200\"/></cs:categoryAxis><cs:chartArea mods=\"allowNoFillOverride allowNoLineOverride\"><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val=\"bg1\"/></a:solidFill><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"15000\"/><a:lumOff val=\"85000\"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz=\"1330\" kern=\"1200\"/></cs:chartArea><cs:dataLabel><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"><a:lumMod val=\"75000\"/><a:lumOff val=\"25000\"/></a:schemeClr></cs:fontRef><cs:defRPr sz=\"1197\" kern=\"1200\"/></cs:dataLabel><cs:dataLabelCallout><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"dk1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val=\"lt1\"/></a:solidFill><a:ln><a:solidFill><a:schemeClr val=\"dk1\"><a:lumMod val=\"25000\"/><a:lumOff val=\"75000\"/></a:schemeClr></a:solidFill></a:ln></cs:spPr><cs:defRPr sz=\"1197\" kern=\"1200\"/><cs:bodyPr rot=\"0\" spcFirstLastPara=\"1\" vertOverflow=\"clip\" horzOverflow=\"clip\" vert=\"horz\" wrap=\"square\" lIns=\"36576\" tIns=\"18288\" rIns=\"36576\" bIns=\"18288\" anchor=\"ctr\" anchorCtr=\"1\"><a:spAutoFit/></cs:bodyPr></cs:dataLabelCallout><cs:dataPoint><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"1\"><cs:styleClr val=\"auto\"/></cs:fillRef><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef></cs:dataPoint><cs:dataPoint3D><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"1\"><cs:styleClr val=\"auto\"/></cs:fillRef><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef></cs:dataPoint3D><cs:dataPointLine><cs:lnRef idx=\"0\"><cs:styleClr val=\"auto\"/></cs:lnRef><cs:fillRef idx=\"1\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:ln w=\"28575\" cap=\"rnd\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:dataPointLine><cs:dataPointMarker><cs:lnRef idx=\"0\"><cs:styleClr val=\"auto\"/></cs:lnRef><cs:fillRef idx=\"1\"><cs:styleClr val=\"auto\"/></cs:fillRef><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:ln w=\"9525\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill></a:ln></cs:spPr></cs:dataPointMarker><cs:dataPointMarkerLayout symbol=\"circle\" size=\"5\"/><cs:dataPointWireframe><cs:lnRef idx=\"0\"><cs:styleClr val=\"auto\"/></cs:lnRef><cs:fillRef idx=\"1\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:ln w=\"9525\" cap=\"rnd\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:round/></a:ln></cs:spPr></cs:dataPointWireframe><cs:dataTable><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></cs:fontRef><cs:spPr><a:noFill/><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"15000\"/><a:lumOff val=\"85000\"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr><cs:defRPr sz=\"1197\" kern=\"1200\"/></cs:dataTable><cs:downBar><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"dk1\"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val=\"dk1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></a:solidFill><a:ln w=\"9525\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></a:solidFill></a:ln></cs:spPr></cs:downBar><cs:dropLine><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"35000\"/><a:lumOff val=\"65000\"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:dropLine><cs:errorBar><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:errorBar><cs:floor><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:noFill/><a:ln><a:noFill/></a:ln></cs:spPr></cs:floor><cs:gridlineMajor><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"15000\"/><a:lumOff val=\"85000\"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:gridlineMajor><cs:gridlineMinor><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"5000\"/><a:lumOff val=\"95000\"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:gridlineMinor><cs:hiLoLine><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"75000\"/><a:lumOff val=\"25000\"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:hiLoLine><cs:leaderLine><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"35000\"/><a:lumOff val=\"65000\"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:leaderLine><cs:legend><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></cs:fontRef><cs:defRPr sz=\"1197\" kern=\"1200\"/></cs:legend><cs:plotArea mods=\"allowNoFillOverride allowNoLineOverride\"><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef></cs:plotArea><cs:plotArea3D mods=\"allowNoFillOverride allowNoLineOverride\"><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef></cs:plotArea3D><cs:seriesAxis><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></cs:fontRef><cs:defRPr sz=\"1197\" kern=\"1200\"/></cs:seriesAxis><cs:seriesLine><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"35000\"/><a:lumOff val=\"65000\"/></a:schemeClr></a:solidFill><a:round/></a:ln></cs:spPr></cs:seriesLine><cs:title><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></cs:fontRef><cs:defRPr sz=\"1862\" b=\"0\" kern=\"1200\" spc=\"0\" baseline=\"0\"/></cs:title><cs:trendline><cs:lnRef idx=\"0\"><cs:styleClr val=\"auto\"/></cs:lnRef><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:ln w=\"19050\" cap=\"rnd\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"sysDot\"/></a:ln></cs:spPr></cs:trendline><cs:trendlineLabel><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></cs:fontRef><cs:defRPr sz=\"1197\" kern=\"1200\"/></cs:trendlineLabel><cs:upBar><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"dk1\"/></cs:fontRef><cs:spPr><a:solidFill><a:schemeClr val=\"lt1\"/></a:solidFill><a:ln w=\"9525\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"15000\"/><a:lumOff val=\"85000\"/></a:schemeClr></a:solidFill></a:ln></cs:spPr></cs:upBar><cs:valueAxis><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></cs:fontRef><cs:defRPr sz=\"1197\" kern=\"1200\"/></cs:valueAxis><cs:wall><cs:lnRef idx=\"0\"/><cs:fillRef idx=\"0\"/><cs:effectRef idx=\"0\"/><cs:fontRef idx=\"minor\"><a:schemeClr val=\"tx1\"/></cs:fontRef><cs:spPr><a:noFill/><a:ln><a:noFill/></a:ln></cs:spPr></cs:wall></cs:chartStyle>'\r\n\t}\r\n\t\r\n\tfunction cbMakeChartDataExcel ( data ) {\r\n\t\t\r\n\t}\t\r\n\t\r\n\t// Prepare genobj for MS-Office:\r\n\tmsdoc.makemsdoc ( genobj, new_type, options, gen_private, type_info );\r\n\tgen_private.plugs.type.msoffice.makeOfficeGenerator ( 'ppt', 'presentation', {} );\r\n\r\n\tgen_private.features.page_name = 'slides'; // This document type must have pages.\r\n\r\n\tgen_private.plugs.type.msoffice.addInfoType ( 'dc:title', '', 'title', 'setDocTitle' );\r\n\r\n\tvar type_of_main_doc = 'slideshow';\r\n\tif ( new_type != 'ppsx' )\r\n\t{\r\n\t\ttype_of_main_doc = 'presentation';\r\n\t} // Endif.\r\n\r\n\tgen_private.type.msoffice.files_list.push (\r\n\t\t{\r\n\t\t\tname: '/ppt/slideMasters/slideMaster1.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/ppt/presProps.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.presProps+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/ppt/presentation.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.' + type_of_main_doc + '.main+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/ppt/slideLayouts/slideLayout1.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/ppt/tableStyles.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml',\r\n\t\t\tclear: 'type'\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: '/ppt/viewProps.xml',\r\n\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml',\r\n\t\t\tclear: 'type'\r\n\t\t}\r\n\t);\r\n\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\presProps.xml', 'buffer', null, cbMakePptxPresProps, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\tableStyles.xml', 'buffer', null, cbMakePptxStyles, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\viewProps.xml', 'buffer', null, cbMakePptxViewProps, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\presentation.xml', 'buffer', null, cbMakePptxPresentation, true );\r\n\t\r\n\t\r\n\t\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\slideLayouts\\\\slideLayout1.xml', 'buffer', null, cbMakePptxLayout, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\slideLayouts\\\\_rels\\\\slideLayout1.xml.rels', 'buffer', [\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster',\r\n\t\t\ttarget: '../slideMasters/slideMaster1.xml'\r\n\t\t}\r\n\t], gen_private.plugs.type.msoffice.cbMakeRels, true );\r\n\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\slideMasters\\\\slideMaster1.xml', 'buffer', null, cbMakePptxSlideMasters, true );\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\slideMasters\\\\_rels\\\\slideMaster1.xml.rels', 'buffer', [\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout',\r\n\t\t\ttarget: '../slideLayouts/slideLayout1.xml'\r\n\t\t},\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',\r\n\t\t\ttarget: '../theme/theme1.xml'\r\n\t\t}\r\n\t], gen_private.plugs.type.msoffice.cbMakeRels, true );\r\n\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'docProps\\\\app.xml', 'buffer', null, cbMakePptxApp, true );\r\n\r\n\tgen_private.type.msoffice.rels_app.push (\r\n\t\t{\r\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster',\r\n\t\t\ttarget: 'slideMasters/slideMaster1.xml',\r\n\t\t\tclear: 'type'\r\n\t\t}\r\n\t);\r\n\r\n\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\_rels\\\\presentation.xml.rels', 'buffer', gen_private.type.msoffice.rels_app, gen_private.plugs.type.msoffice.cbMakeRels, true );\r\n\r\n\t// ----- API for PowerPoint documents: -----\r\n\r\n\t///\r\n\t/// @brief Create a new slide.\r\n\t///\r\n\t/// This method creating a new slide inside the presentation.\r\n\t///\r\n\t/// @return The new slide object.\r\n\t///\r\n\tgenobj.makeNewSlide = function () {\r\n\t\tvar pageNumber = gen_private.pages.length;\r\n\t\tvar slideObj = { show: true }; // The slide object that the user will use.\r\n\r\n\t\tgen_private.pages[pageNumber] = {};\r\n\t\tgen_private.pages[pageNumber].slide = slideObj;\r\n\t\tgen_private.pages[pageNumber].data = [];\r\n\t\tgen_private.pages[pageNumber].rels = [\r\n\t\t\t{\r\n\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout',\r\n\t\t\t\ttarget: '../slideLayouts/slideLayout1.xml',\r\n\t\t\t\tclear: 'data'\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\tgen_private.type.msoffice.files_list.push (\r\n\t\t\t{\r\n\t\t\t\tname: '/ppt/slides/slide' + (pageNumber + 1) + '.xml',\r\n\t\t\t\ttype: 'application/vnd.openxmlformats-officedocument.presentationml.slide+xml',\r\n\t\t\t\tclear: 'data'\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tgen_private.type.msoffice.rels_app.push (\r\n\t\t\t{\r\n\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide',\r\n\t\t\t\ttarget: 'slides/slide' + (pageNumber + 1) + '.xml',\r\n\t\t\t\tclear: 'data'\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tslideObj.getPageNumber = function () { return pageNumber; };\r\n\r\n\t\tslideObj.name = 'Slide ' + (pageNumber + 1);\r\n\r\n\t\t///\r\n\t\t/// @brief ???.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] prgObj Paragraph object.\r\n\t\t///\r\n\t\tfunction addParagraphApiForBasicOpt ( prgObj ) {\r\n\t\t\tif ( !prgObj.api ) {\r\n\t\t\t\tprgObj.api = {};\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tprgObj.api.options = prgObj.options;\r\n\t\t}\r\n\r\n\t\t///\r\n\t\t/// @brief ???.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] prgObj Paragraph object.\r\n\t\t///\r\n\t\tfunction addParagraphApiForEffects ( prgObj ) {\r\n\t\t\tif ( !prgObj.api ) {\r\n\t\t\t\tprgObj.api = {};\r\n\t\t\t} // Endif.\r\n\r\n\t\t\t///\r\n\t\t\t/// @brief ???.\r\n\t\t\t///\r\n\t\t\t/// ???.\r\n\t\t\t///\r\n\t\t\t/// @param[in] inType ???.\r\n\t\t\t/// @param[in] inAlign ???.\r\n\t\t\t/// @param[in] inColor ???.\r\n\t\t\t/// @param[in] inTransparency ???.\r\n\t\t\t/// @param[in] inSize ???.\r\n\t\t\t/// @param[in] inBlur ???.\r\n\t\t\t/// @param[in] inAngle ???.\r\n\t\t\t/// @param[in] inDistance ???.\r\n\t\t\t///\r\n\t\t\tprgObj.api.setShadowEffect = function ( inType, inAlign, inColor, inTransparency, inSize, inBlur, inAngle, inDistance ) {\r\n\t\t\t\tif ( !prgObj.options.effects )\r\n\t\t\t\t\tprgObj.options.effects = [];\r\n\r\n\t\t\t\tvar newEffect = {\r\n\t\t\t\t\t'type': inType,\r\n\t\t\t\t\t'align': inAlign,\r\n\t\t\t\t\t'color': inColor,\r\n\t\t\t\t\t'transparency': inTransparency,\r\n\t\t\t\t\t'size': inSize,\r\n\t\t\t\t\t'blur': inBlur,\r\n\t\t\t\t\t'angle': inAngle,\r\n\t\t\t\t\t'distance': inDistance\r\n\t\t\t\t};\r\n\r\n\t\t\t\tprgObj.options.effects.push ( newEffect );\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t\r\n\r\n\t\t///\r\n\t\t/// @brief Generate the chart based on input data.\r\n\t\t/// @param[in] renderType should belong to: 'column', 'pie'\r\n\t\t/// @param[in] data a JSON object with follow the following format\r\n\t\t///     { \t\r\n\t\t///\t\t\ttitle: 'eSurvey chart',\r\n\t\t///\t\t\tdata:  [\r\n\t\t///\t\t\t\t{\r\n\t\t///\t\t\t\t\tname: 'Income',\r\n\t\t///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n\t\t///\t\t\t\t\tvalues: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n\t\t///\t\t\t\t},\r\n\t\t///\t\t\t\t{\r\n\t\t///\t\t\t\t\tname: 'Expense',\r\n\t\t///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n\t\t///\t\t\t\t\tvalues: [18.1, 22.8, 23.9, 25.1, 25]\r\n\t\t///\t\t\t\t}\r\n\t\t///\t\t\t]\r\n\t\t/// \t}\r\n\t\t/// @author vtloc\r\n\t\t/// @date 2014Jan09\r\n\t\tslideObj.addChart = function ( data, renderType ) {\r\n\t\t\tvar objNumber = gen_private.pages[pageNumber].data.length;\r\n\t\t\tGLOBAL_CHART_COUNT += 1;\r\n\t\t\t\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber] = {};\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].type = 'chart';\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].renderType = 'column';\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].title = data['title'];\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].data = data['data'];\r\n\t\t\tdata['renderType'] = renderType;\r\n\t\t\t\r\n\t\t\t// First, generate a temporatory excel file for storing the chart's data\r\n\t\t\tvar workbook = excelbuilder.createWorkbook('./', 'sample' + GLOBAL_CHART_COUNT + '.xlsx')\r\n\r\n\t\t\t// Create a new worksheet with 10 columns and 12 rows\r\n\t\t\t// number of columns: data['data'].length+1 -> equaly number of series\r\n\t\t\t// number of rows: data['data'][0].values.length+1 \r\n\t\t\tvar sheet1 = workbook.createSheet('Sheet1', data['data'].length+1, data['data'][0].values.length+1);\r\n\t\t\tvar headerrow = 1;\r\n\r\n\t\t\t// write header using serie name\r\n\t\t\tfor( var j=0; j < data['data'].length; j++ )\r\n\t\t\t{\r\n\t\t\t\tsheet1.set(j+2, headerrow, data['data'][j].name);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// write category column in the first column\r\n\t\t\tfor( var j=0; j < data['data'][0].labels.length; j++ )\r\n\t\t\t{\r\n\t\t\t\tsheet1.set(1, j+2, data['data'][0].labels[j]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// for each serie, write out values in its row\r\n\t\t\tfor (var i = 0; i < data['data'].length; i++)\r\n\t\t\t{\r\n\t\t\t\tfor( var j=0; j < data['data'][i].values.length; j++ )\r\n\t\t\t\t{\r\n\t\t\t\t\t// col i+2\r\n\t\t\t\t\t// row j+1\r\n\t\t\t\t\tsheet1.set(i+2, j+2, data['data'][i].values[j]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Fill some data\r\n\t\t\t// Save it\r\n\t\t\tvar localEmbeddingExcelFile = 'ppt\\\\embeddings\\\\Microsoft_Excel_Worksheet' + GLOBAL_CHART_COUNT + '.xlsx';\r\n\t\t\tvar tmpExcelFile = 'sample'+GLOBAL_CHART_COUNT+'.xlsx';\r\n\t\t\tworkbook.save(function(err){\r\n\t\t\t\tif (err) \r\n\t\t\t\t  workbook.cancel();\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t  console.log('congratulations, your workbook created');\r\n\t\t\t\t  \r\n\t\t\t\t  // will copy the tmpExcelFile into localEmbeddingExcelFile\r\n\t\t\t\t  gen_private.plugs.intAddAnyResourceToParse ( localEmbeddingExcelFile, 'file', tmpExcelFile, cbMakeChartDataExcel, false, true );\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\charts\\\\chart'+GLOBAL_CHART_COUNT+'.xml', 'buffer', data, cbMakeCharts, true );\r\n\t\t\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\charts\\\\colors'+GLOBAL_CHART_COUNT+'.xml', 'buffer', data, cbMakeChartColors, true );\r\n\t\t\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\charts\\\\style'+GLOBAL_CHART_COUNT+'.xml', 'buffer', data, cbMakeChartStyle, true );\r\n\t\t\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\charts\\\\_rels\\\\chart'+GLOBAL_CHART_COUNT+'.xml.rels', 'buffer', [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttype: 'http://schemas.microsoft.com/office/2011/relationships/chartStyle',\r\n\t\t\t\t\t\ttarget: 'style'+GLOBAL_CHART_COUNT+'.xml'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttype: 'http://schemas.microsoft.com/office/2011/relationships/chartColorStyle',\r\n\t\t\t\t\t\ttarget: 'colors'+GLOBAL_CHART_COUNT+'.xml'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package',\r\n\t\t\t\t\t\ttarget: '../embeddings/Microsoft_Excel_Worksheet'+GLOBAL_CHART_COUNT+'.xlsx'\r\n\t\t\t\t\t}\r\n\t\t\t\t], gen_private.plugs.type.msoffice.cbMakeRels, true );\r\n\t\t\tgen_private.type.msoffice.files_list.push (\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '/ppt/charts/chart'+GLOBAL_CHART_COUNT+'.xml',\r\n\t\t\t\t\ttype: 'application/vnd.openxmlformats-officedocument.drawingml.chart+xml',\r\n\t\t\t\t\tclear: 'type'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '/ppt/charts/style'+GLOBAL_CHART_COUNT+'.xml',\r\n\t\t\t\t\ttype: 'application/vnd.ms-office.chartstyle+xml',\r\n\t\t\t\t\tclear: 'type'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '/ppt/charts/colors'+GLOBAL_CHART_COUNT+'.xml',\r\n\t\t\t\t\ttype: 'application/vnd.ms-office.chartcolorstyle+xml',\r\n\t\t\t\t\tclear: 'type'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tname: '/ppt/embeddings/Microsoft_Excel_Worksheet'+GLOBAL_CHART_COUNT+'.xlsx',\r\n\t\t\t\t\ttype: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\r\n\t\t\t\t\text: 'xlsx',\r\n\t\t\t\t\tclear: 'type'\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\tgen_private.pages[pageNumber].rels.push (\r\n\t\t\t{\r\n\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart',\r\n\t\t\t\ttarget: '../charts/chart'+GLOBAL_CHART_COUNT+'.xml',\r\n\t\t\t\tclear: 'data'\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\t///\r\n\t\t/// @brief Generate the column chart based on input data.\r\n\t\t///\r\n\t\t/// @param[in] data a JSON object with follow the following format\r\n\t\t///     { \t\r\n\t\t///\t\t\ttitle: 'eSurvey chart',\r\n\t\t///\t\t\tdata:  [\r\n\t\t///\t\t\t\t{\r\n\t\t///\t\t\t\t\tname: 'Income',\r\n\t\t///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n\t\t///\t\t\t\t\tvalues: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n\t\t///\t\t\t\t},\r\n\t\t///\t\t\t\t{\r\n\t\t///\t\t\t\t\tname: 'Expense',\r\n\t\t///\t\t\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\r\n\t\t///\t\t\t\t\tvalues: [18.1, 22.8, 23.9, 25.1, 25]\r\n\t\t///\t\t\t\t}\r\n\t\t///\t\t\t]\r\n\t\t/// \t}\r\n\t\t///\r\n\t\tslideObj.addColumnChart = function ( data) {\r\n\t\t\tthis.addChart( data, 'column' );\r\n\t\t}\r\n\t\t\r\n\t\t///\r\n\t\t/// @brief Generate the pie chart based on input data.\r\n\t\t/// @author vtloc\r\n\t\t/// @date 2014Jan09\r\n\t\tslideObj.addPieChart = function ( data) {\r\n\t\t\tthis.addChart( data, 'pie');\r\n\t\t}\r\n    \r\n\t\t///\r\n\t\t/// @brief Generate the bar chart based on input data.\r\n\t\t/// @author vtloc\r\n\t\t/// @date 2014Jan09\r\n\t\tslideObj.addBarChart = function ( data) {\r\n\t\t\tthis.addChart( data, 'bar');\r\n\t\t}\r\n\t\t\r\n\t\t///\r\n\t\t/// @brief ???.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] text ???.\r\n\t\t/// @param[in] opt ???.\r\n\t\t/// @param[in] y_pos ???.\r\n\t\t/// @param[in] x_size ???.\r\n\t\t/// @param[in] y_size ???.\r\n\t\t/// @param[in] opt_b ???.\r\n\t\t///\r\n\t\tslideObj.addText = function ( text, opt, y_pos, x_size, y_size, opt_b ) {\r\n\t\t\tvar objNumber = gen_private.pages[pageNumber].data.length;\r\n\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber] = {};\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].type = 'text';\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].text = text;\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].options = typeof opt == 'object' ? opt : {};\r\n\r\n\t\t\tif ( typeof opt == 'string' ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.color = opt;\r\n\r\n\t\t\t} else if ( (typeof opt != 'object') && (typeof y_pos != 'undefined') ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.x = opt;\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.y = y_pos;\r\n\r\n\t\t\t\tif ( (typeof x_size != 'undefined') && (typeof y_size != 'undefined') ) {\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cx = x_size;\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cy = y_size;\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( typeof opt_b == 'object' ) {\r\n\t\t\t\tfor ( var attrname in opt_b ) { gen_private.pages[pageNumber].data[objNumber].options[attrname] = opt_b[attrname]; }\r\n\r\n\t\t\t} else if ( (typeof x_size == 'object') && (typeof y_size == 'undefined') ) {\r\n\t\t\t\tfor ( var attrname in x_size ) { gen_private.pages[pageNumber].data[objNumber].options[attrname] = x_size[attrname]; }\r\n\t\t\t} // Endif.\r\n\r\n\t\t\taddParagraphApiForBasicOpt ( gen_private.pages[pageNumber].data[objNumber] );\r\n\t\t\taddParagraphApiForEffects ( gen_private.pages[pageNumber].data[objNumber] );\r\n\t\t\treturn gen_private.pages[pageNumber].data[objNumber].api;\r\n\t\t};\r\n\r\n\t\t///\r\n\t\t/// @brief ???.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] shape ???.\r\n\t\t/// @param[in] opt ???.\r\n\t\t/// @param[in] y_pos ???.\r\n\t\t/// @param[in] x_size ???.\r\n\t\t/// @param[in] y_size ???.\r\n\t\t/// @param[in] opt_b ???.\r\n\t\t///\r\n\t\tslideObj.addShape = function ( shape, opt, y_pos, x_size, y_size, opt_b ) {\r\n\t\t\tvar objNumber = gen_private.pages[pageNumber].data.length;\r\n\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber] = {};\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].type = 'text';\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].options = typeof opt == 'object' ? opt : {};\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].options.shape = shape;\r\n\r\n\t\t\tif ( typeof opt == 'string' ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.color = opt;\r\n\r\n\t\t\t} else if ( (typeof opt != 'object') && (typeof y_pos != 'undefined') ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.x = opt;\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.y = y_pos;\r\n\r\n\t\t\t\tif ( (typeof x_size != 'undefined') && (typeof y_size != 'undefined') ) {\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cx = x_size;\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cy = y_size;\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( typeof opt_b == 'object' ) {\r\n\t\t\t\tfor ( var attrname in opt_b ) { gen_private.pages[pageNumber].data[objNumber].options[attrname] = opt_b[attrname]; }\r\n\r\n\t\t\t} else if ( (typeof x_size == 'object') && (typeof y_size == 'undefined') ) {\r\n\t\t\t\tfor ( var attrname in x_size ) { gen_private.pages[pageNumber].data[objNumber].options[attrname] = x_size[attrname]; }\r\n\t\t\t} // Endif.\r\n\r\n\t\t\taddParagraphApiForBasicOpt ( gen_private.pages[pageNumber].data[objNumber] );\r\n\t\t\taddParagraphApiForEffects ( gen_private.pages[pageNumber].data[objNumber] );\r\n\t\t\treturn gen_private.pages[pageNumber].data[objNumber].api;\r\n\t\t};\r\n\r\n\t\t///\r\n\t\t/// @brief ???.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] image_path ???.\r\n\t\t/// @param[in] opt ???.\r\n\t\t/// @param[in] y_pos ???.\r\n\t\t/// @param[in] x_size ???.\r\n\t\t/// @param[in] y_size ???.\r\n\t\t/// @param[in] image_format_type ???.\r\n\t\t///\r\n\t\tslideObj.addImage = function ( image_path, opt, y_pos, x_size, y_size, image_format_type ) {\r\n\t\t\tvar objNumber = gen_private.pages[pageNumber].data.length;\r\n\t\t\tvar image_type = (typeof image_format_type == 'string') ? image_format_type : 'png';\r\n\t\t\tvar defWidth, defHeight = 0;\r\n\r\n\t\t\tif ( typeof image_path == 'string' ) {\r\n\t\t\t\tvar ret_data = fast_image_size ( image_path );\r\n\t\t\t\tif ( ret_data.type == 'unknown' ) {\r\n\t\t\t\t\tvar image_ext = path.extname ( image_path );\r\n\r\n\t\t\t\t\tswitch ( image_ext ) {\r\n\t\t\t\t\t\tcase '.bmp':\r\n\t\t\t\t\t\t\timage_type = 'bmp';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '.gif':\r\n\t\t\t\t\t\t\timage_type = 'gif';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '.jpg':\r\n\t\t\t\t\t\tcase '.jpeg':\r\n\t\t\t\t\t\t\timage_type = 'jpeg';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '.emf':\r\n\t\t\t\t\t\t\timage_type = 'emf';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase '.tiff':\r\n\t\t\t\t\t\t\timage_type = 'tiff';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} // End of switch.\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif ( ret_data.width ) {\r\n\t\t\t\t\t\tdefWidth = ret_data.width;\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\tif ( ret_data.height ) {\r\n\t\t\t\t\t\tdefHeight = ret_data.height;\r\n\t\t\t\t\t} // Endif.\r\n\r\n\t\t\t\t\timage_type = ret_data.type;\r\n\t\t\t\t\tif ( image_type == 'jpg' ) {\r\n\t\t\t\t\t\timage_type = 'jpeg';\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber] = {};\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].type = 'image';\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].image = image_path;\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].options = typeof opt == 'object' ? opt : {};\r\n\r\n\t\t\tif ( !gen_private.pages[pageNumber].data[objNumber].options.cx && defWidth ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cx = defWidth;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( !gen_private.pages[pageNumber].data[objNumber].options.cy && defHeight ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cy = defHeight;\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tvar image_id = gen_private.type.msoffice.src_files_list.indexOf ( image_path );\r\n\t\t\tvar image_rel_id = -1;\r\n\r\n\t\t\tif ( image_id >= 0 ) {\r\n\t\t\t\tfor ( var j = 0, total_size_j = gen_private.pages[pageNumber].rels.length; j < total_size_j; j++ ) {\r\n\t\t\t\t\tif ( gen_private.pages[pageNumber].rels[j].target == ('../media/image' + (image_id + 1) + '.' + image_type) ) {\r\n\t\t\t\t\t\timage_rel_id = j + 1;\r\n\t\t\t\t\t} // Endif.\r\n\t\t\t\t} // Endif.\r\n\t\t\t\r\n\t\t\t} else\r\n\t\t\t{\r\n\t\t\t\timage_id = gen_private.type.msoffice.src_files_list.length;\r\n\t\t\t\tgen_private.type.msoffice.src_files_list[image_id] = image_path;\r\n\t\t\t\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\media\\\\image' + (image_id + 1) + '.' + image_type, (typeof image_path == 'string') ? 'file' : 'stream', image_path, null, false );\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( image_rel_id == -1 ) {\r\n\t\t\t\timage_rel_id = gen_private.pages[pageNumber].rels.length + 1;\r\n\r\n\t\t\t\tgen_private.pages[pageNumber].rels.push (\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image',\r\n\t\t\t\t\t\ttarget: '../media/image' + (image_id + 1) + '.' + image_type,\r\n\t\t\t\t\t\tclear: 'data'\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].image_id = image_id;\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].rel_id = image_rel_id;\r\n\r\n\t\t\tif ( typeof opt == 'string' ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.color = opt;\r\n\r\n\t\t\t} else if ( (typeof opt != 'object') && (typeof y_pos != 'undefined') ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.x = opt;\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.y = y_pos;\r\n\r\n\t\t\t\tif ( (typeof x_size != 'undefined') && (typeof y_size != 'undefined') ) {\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cx = x_size;\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cy = y_size;\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\taddParagraphApiForBasicOpt ( gen_private.pages[pageNumber].data[objNumber] );\r\n\t\t\taddParagraphApiForEffects ( gen_private.pages[pageNumber].data[objNumber] );\r\n\t\t\treturn gen_private.pages[pageNumber].data[objNumber].api;\r\n\t\t};\r\n\r\n\t\t///\r\n\t\t/// @brief ???.\r\n\t\t///\r\n\t\t/// ???.\r\n\t\t///\r\n\t\t/// @param[in] text ???.\r\n\t\t/// @param[in] opt ???.\r\n\t\t/// @param[in] y_pos ???.\r\n\t\t/// @param[in] x_size ???.\r\n\t\t/// @param[in] y_size ???.\r\n\t\t/// @param[in] opt_b ???.\r\n\t\t///\r\n\t\tslideObj.addP = function ( text, opt, y_pos, x_size, y_size, opt_b ) {\r\n\t\t\tvar objNumber = gen_private.pages[pageNumber].data.length;\r\n\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber] = {};\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].type = 'p';\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].data = [];\r\n\t\t\tgen_private.pages[pageNumber].data[objNumber].options = typeof opt == 'object' ? opt : {};\r\n\r\n\t\t\tif ( typeof opt == 'string' ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.color = opt;\r\n\r\n\t\t\t} else if ( (typeof opt != 'object') && (typeof y_pos != 'undefined') ) {\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.x = opt;\r\n\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.y = y_pos;\r\n\r\n\t\t\t\tif ( (typeof x_size != 'undefined') && (typeof y_size != 'undefined') ) {\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cx = x_size;\r\n\t\t\t\t\tgen_private.pages[pageNumber].data[objNumber].options.cy = y_size;\r\n\t\t\t\t} // Endif.\r\n\t\t\t} // Endif.\r\n\r\n\t\t\tif ( typeof opt_b == 'object' ) {\r\n\t\t\t\tfor ( var attrname in opt_b ) { gen_private.pages[pageNumber].data[objNumber].options[attrname] = opt_b[attrname]; }\r\n\r\n\t\t\t} else if ( (typeof x_size == 'object') && (typeof y_size == 'undefined') ) {\r\n\t\t\t\tfor ( var attrname in x_size ) { gen_private.pages[pageNumber].data[objNumber].options[attrname] = x_size[attrname]; }\r\n\t\t\t} // Endif.\r\n\r\n\t\t\t// BMK_TODO:\r\n\r\n\t\t\treturn gen_private.pages[pageNumber].data[objNumber].data;\r\n\t\t};\r\n\r\n\t\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\slides\\\\slide' + (pageNumber + 1) + '.xml', 'buffer', gen_private.pages[pageNumber], cbMakePptxSlide, false );\r\n\t\tgen_private.plugs.intAddAnyResourceToParse ( 'ppt\\\\slides\\\\_rels\\\\slide' + (pageNumber + 1) + '.xml.rels', 'buffer', gen_private.pages[pageNumber].rels, gen_private.plugs.type.msoffice.cbMakeRels, false );\t\t\r\n\t\treturn slideObj;\r\n\t};\r\n}\r\n\r\nvar pptxSchema = {};\r\n\r\nbaseobj.plugins.registerDocType ( 'pptx', makePptx, pptxSchema, baseobj.docType.PRESENTATION, \"Microsoft PowerPoint Document\" );\r\nbaseobj.plugins.registerDocType ( 'ppsx', makePptx, pptxSchema, baseobj.docType.PRESENTATION, \"Microsoft PowerPoint Slideshow Document\" );\r\n\r\n","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/lib/openofficegen.js":"//\r\n// officegen: basic OpenOffice common code\r\n//\r\n// Please refer to README.md for this module's documentations.\r\n//\r\n// NOTE:\r\n// - Before changing this code please refer to the hacking the code section on README.md.\r\n//\r\n// Copyright (c) 2013 Ziv Barber;\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files (the\r\n// 'Software'), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\r\n// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\r\n// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\n\r\nvar baseobj = require(\"./basicgen.js\");\r\n\r\n///\r\n/// @brief Extend officegen object with OpenOffice support.\r\n///\r\n/// This method extending the given officegen object with the common OpenOffice code.\r\n///\r\n/// @param[in] genobj The object to extend.\r\n/// @param[in] new_type The type of object to create.\r\n/// @param[in] options The object's options.\r\n/// @param[in] gen_private Access to the internals of this object.\r\n/// @param[in] type_info Additional information about this type.\r\n///\r\nfunction makeoodoc ( genobj, new_type, options, gen_private, type_info ) {\r\n\t///\r\n\t/// @brief Get the string that opening every Office XML type.\r\n\t///\r\n\t/// Every OpenOffice XML resource will have this header at the begining of the file.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tgen_private.plugs.type.openoffice.makeOpenOfficeBasicXml = function ( data ) {\r\n\t\treturn '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\\n';\r\n\t}\r\n\r\n\t// Basic API for plugins:\r\n\r\n\tgen_private.plugs.type.openoffice = {};\r\n\r\n\t///\r\n\t/// @brief Create the mimetpe resource.\r\n\t///\r\n\t/// Every OpenOffice based document must have this resource.\r\n\t///\r\n\t/// @param[in] data Ignored by this callback function.\r\n\t/// @return Text string.\r\n\t///\r\n\tfunction makeOpenOfficeMimeType ( data ) {\r\n\t\treturn 'application/vnd.oasis.opendocument.' + gen_private.mixed.res_data.mimeType;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Generate the manifest XML resource.\r\n\t///\r\n\t/// Tbis function creating the manifest resource.\r\n\t///\r\n\t/// @param[in] data Array filled with all the resources information.\r\n\t/// @return Text string.\r\n\t///\r\n\tgen_private.plugs.type.openoffice.makeManifest = function ( data ) {\r\n\t\tvar outString = gen_private.plugs.type.openoffice.makeOpenOfficeBasicXml ( data );\r\n\t\toutString += '<manifest:manifest xmlns:manifest=\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\" manifest:version=\"1.2\">\\n';\r\n\r\n\t\t// Add all the rels records inside the data array:\r\n\t\tfor ( var i = 0, total_size = data.length; i < total_size; i++ ) {\r\n\t\t\tif ( typeof data[i] != 'undefined' ) {\r\n\t\t\t\toutString += ' <manifest:file-entry manifest:media-type=\"' + data[i].type + '\" manifest:full-path=\"' + data[i].target + '\"/>\\n';\r\n\t\t\t} // Endif.\r\n\t\t} // End of for loop.\r\n\r\n\t\toutString += '</manifest:manifest>\\n';\r\n\t\treturn outString;\r\n\t}\r\n\r\n\t///\r\n\t/// @brief Prepare the officegen object to OpenOffice documents.\r\n\t///\r\n\t/// Every plugin that implementing gemenrating OpenOffice document must call this method to initialize \r\n\t/// the common stuff.\r\n\t///\r\n\t/// @param[in] mimeType The mime type of this document.\r\n\t/// @param[in] ext_opt Optional settings (unused right now).\r\n\t///\r\n\tgen_private.plugs.type.openoffice.makeOfficeGenerator = function ( mimeType, ext_opt ) {\r\n\t\tgen_private.mixed.res_data.mimeType = mimeType;\r\n\t\tgen_private.mixed.files_list = [];\r\n\r\n\t\tgen_private.mixed.files_list.push (\r\n\t\t\t{\r\n\t\t\t\tname: 'content.xml',\r\n\t\t\t\ttype: 'text/xml'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'settings.xml',\r\n\t\t\t\ttype: 'text/xml'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'styles.xml',\r\n\t\t\t\ttype: 'text/xml'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'manifest.rdf',\r\n\t\t\t\ttype: 'application/rdf+xml'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tname: 'meta.xml',\r\n\t\t\t\ttype: 'text/xml'\r\n\t\t\t}\r\n\t\t);\r\n\r\n\t\tgen_private.plugs.intAddAnyResourceToParse ( 'mimetype', 'buffer', null, makeOpenOfficeMimeType, true );\r\n\t\tgen_private.plugs.intAddAnyResourceToParse ( 'META-INF\\\\manifest.xml', 'buffer', gen_private.mixed.rels_main, gen_private.plugs.type.openoffice.cbMakeRels, true );\r\n\t\t// gen_private.plugs.intAddAnyResourceToParse ( 'settings.xml', 'buffer', null, make???, true );\r\n\t\t// gen_private.plugs.intAddAnyResourceToParse ( 'styles.xml', 'buffer', null, make???, true );\r\n\t\t// gen_private.plugs.intAddAnyResourceToParse ( 'manifest.rdf', 'buffer', null, make???, true );\r\n\t\t// gen_private.plugs.intAddAnyResourceToParse ( 'meta.xml', 'buffer', null, make???, true );\r\n\t}\r\n}\r\n\r\nbaseobj.plugins.registerPrototype ( 'openoffice', makeoodoc, 'OpenOffice Document Prototype' );\r\n\r\nexports.makeoodoc = makeoodoc;\r\n\r\n","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/plugins/templates/types/genmymstype.js":"//\r\n// officegen: All the code to generate ??? files.\r\n//\r\n// Please refer to README.md for this module's documentations.\r\n//\r\n// NOTE:\r\n// - Before changing this code please refer to the hacking the code section on README.md.\r\n//\r\n// Copyright (c) 2013 ???;\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files (the\r\n// 'Software'), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\r\n// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\r\n// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\n\r\nvar baseobj = require(\"./basicgen.js\");\r\nvar msdoc = require(\"./msofficegen.js\");\r\n\r\n///\r\n/// @brief Extend officegen object with ??? support.\r\n///\r\n/// This method extending the given officegen object to create ??? document.\r\n///\r\n/// @param[in] genobj The object to extend.\r\n/// @param[in] new_type The type of object to create.\r\n/// @param[in] options The object's options.\r\n/// @param[in] gen_private Access to the internals of this object.\r\n/// @param[in] type_info Additional information about this type.\r\n///\r\nfunction makeMyType ( genobj, new_type, options, gen_private, type_info ) {\r\n\t// Prepare genobj for MS-Office:\r\n\tmsdoc.makemsdoc ( genobj, new_type, options, gen_private, type_info );\r\n\tgen_private.plugs.makeOfficeGenerator ( 'mytype', 'mytype', {} );\r\n\r\n\t// ----- API for ??? documents: -----\r\n}\r\n\r\nbaseobj.registerDocType ( 'mytype', makeMyType );\r\n\r\n","/home/travis/build/npmtest/node-npmtest-officegen-2/node_modules/officegen-2/plugins/templates/types/genmytype.js":"//\r\n// officegen: All the code to generate ??? files.\r\n//\r\n// Please refer to README.md for this module's documentations.\r\n//\r\n// NOTE:\r\n// - Before changing this code please refer to the hacking the code section on README.md.\r\n//\r\n// Copyright (c) 2013 ???;\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files (the\r\n// 'Software'), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n//\r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n//\r\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\n// IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\r\n// CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\r\n// TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\r\n// SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\n\r\nvar baseobj = require(\"officegen\");\r\n\r\n///\r\n/// @brief Extend officegen object with ??? support.\r\n///\r\n/// This method extending the given officegen object to create ??? document.\r\n///\r\n/// @param[in] genobj The object to extend.\r\n/// @param[in] new_type The type of object to create.\r\n/// @param[in] options The object's options.\r\n/// @param[in] gen_private Access to the internals of this object.\r\n/// @param[in] type_info Additional information about this type.\r\n///\r\nfunction makeMyType ( genobj, new_type, options, gen_private, type_info ) {\r\n\t// ----- API for ??? documents: -----\r\n}\r\n\r\nbaseobj.registerDocType ( 'mytype', makeMyType );\r\n\r\n"}